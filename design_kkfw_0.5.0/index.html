
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>KOIKI-FW Ê©üËÉΩË®≠Ë®à„ÉªÊßãÊàê„Ç¨„Ç§„Éâ - KOIKI-FW v0.5.0</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#koiki-fw-v050" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="KOIKI-FW v0.5.0" class="md-header__button md-logo" aria-label="KOIKI-FW v0.5.0" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            KOIKI-FW v0.5.0
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              KOIKI-FW Ê©üËÉΩË®≠Ë®à„ÉªÊßãÊàê„Ç¨„Ç§„Éâ
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="KOIKI-FW v0.5.0" class="md-nav__button md-logo" aria-label="KOIKI-FW v0.5.0" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    KOIKI-FW v0.5.0
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ê¶ÇË¶Å
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    KOIKI-FW Ê©üËÉΩË®≠Ë®à„ÉªÊßãÊàê„Ç¨„Ç§„Éâ
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    KOIKI-FW Ê©üËÉΩË®≠Ë®à„ÉªÊßãÊàê„Ç¨„Ç§„Éâ
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      ÁõÆÊ¨°
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#01" class="md-nav__link">
    <span class="md-ellipsis">
      01. „ÅØ„Åò„ÇÅ„Å´
    </span>
  </a>
  
    <nav class="md-nav" aria-label="01. „ÅØ„Åò„ÇÅ„Å´">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#02" class="md-nav__link">
    <span class="md-ellipsis">
      02. „Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£Ê¶ÇË¶Å
    </span>
  </a>
  
    <nav class="md-nav" aria-label="02. „Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£Ê¶ÇË¶Å">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 „Éó„É≠„Ç∏„Çß„ÇØ„ÉàÊßãÈÄ†„Å®„É¨„Ç§„É§„Éº
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 ‰æùÂ≠òÈñ¢‰øÇ„ÅÆÊµÅ„Çå
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#03" class="md-nav__link">
    <span class="md-ellipsis">
      03. „Éá„Ç£„É¨„ÇØ„Éà„É™ÊßãÊàê
    </span>
  </a>
  
    <nav class="md-nav" aria-label="03. „Éá„Ç£„É¨„ÇØ„Éà„É™ÊßãÊàê">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-libkoiki" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 libkoiki („Éï„É¨„Éº„É†„ÉØ„Éº„ÇØ„Ç≥„Ç¢)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-app" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 app („Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#04-configdi" class="md-nav__link">
    <span class="md-ellipsis">
      04. Ë®≠ÂÆöÔºàConfigÔºâ„Å®‰æùÂ≠òÊÄßÊ≥®ÂÖ•ÔºàDIÔºâ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="04. Ë®≠ÂÆöÔºàConfigÔºâ„Å®‰æùÂ≠òÊÄßÊ≥®ÂÖ•ÔºàDIÔºâ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#41-configpy" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 Ë®≠ÂÆöÁÆ°ÁêÜ (config.py)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-dependenciespy" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 ‰æùÂ≠òÊÄßÊ≥®ÂÖ• (dependencies.py)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#05" class="md-nav__link">
    <span class="md-ellipsis">
      05. „É¢„Éá„É´ &amp; „Çπ„Ç≠„Éº„ÉûÂ±§
    </span>
  </a>
  
    <nav class="md-nav" aria-label="05. „É¢„Éá„É´ &amp; „Çπ„Ç≠„Éº„ÉûÂ±§">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#51-sqlalchemy" class="md-nav__link">
    <span class="md-ellipsis">
      5.1 „Éá„Éº„Çø„Éô„Éº„Çπ„É¢„Éá„É´ (SQLAlchemy)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-api-pydantic" class="md-nav__link">
    <span class="md-ellipsis">
      5.2 API„Çπ„Ç≠„Éº„Éû (Pydantic)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#06" class="md-nav__link">
    <span class="md-ellipsis">
      06. „É™„Éù„Ç∏„Éà„É™Â±§
    </span>
  </a>
  
    <nav class="md-nav" aria-label="06. „É™„Éù„Ç∏„Éà„É™Â±§">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#61" class="md-nav__link">
    <span class="md-ellipsis">
      6.1 „Éô„Éº„Çπ„É™„Éù„Ç∏„Éà„É™
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62" class="md-nav__link">
    <span class="md-ellipsis">
      6.2 ÂÖ∑‰ΩìÁöÑ„Å™„É™„Éù„Ç∏„Éà„É™ÂÆüË£Ö
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#07" class="md-nav__link">
    <span class="md-ellipsis">
      07. „Çµ„Éº„Éì„ÇπÂ±§
    </span>
  </a>
  
    <nav class="md-nav" aria-label="07. „Çµ„Éº„Éì„ÇπÂ±§">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#71" class="md-nav__link">
    <span class="md-ellipsis">
      7.1 „Çµ„Éº„Éì„Çπ„ÇØ„É©„Çπ„ÅÆÂÆüË£Ö
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72" class="md-nav__link">
    <span class="md-ellipsis">
      7.2 „Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥ÁÆ°ÁêÜ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#08-jwt" class="md-nav__link">
    <span class="md-ellipsis">
      08. Ë™çË®º„ÉªË™çÂèØÔºàJWTÔºâ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="08. Ë™çË®º„ÉªË™çÂèØÔºàJWTÔºâ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#81-jwt" class="md-nav__link">
    <span class="md-ellipsis">
      8.1 JWTË™çË®º„ÅÆÂÆüË£Ö
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#82-api" class="md-nav__link">
    <span class="md-ellipsis">
      8.2 Ë™çË®ºAPI„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#83-rbac" class="md-nav__link">
    <span class="md-ellipsis">
      8.3 „É≠„Éº„É´„Éô„Éº„Çπ„Ç¢„ÇØ„Çª„ÇπÂà∂Âæ° (RBAC)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#09-celery-redis" class="md-nav__link">
    <span class="md-ellipsis">
      09. ÈùûÂêåÊúüÂá¶ÁêÜÔºàCelery &amp; RedisÔºâ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="09. ÈùûÂêåÊúüÂá¶ÁêÜÔºàCelery &amp; RedisÔºâ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#91-celery" class="md-nav__link">
    <span class="md-ellipsis">
      9.1 Celery„Å´„Çà„ÇãÈùûÂêåÊúü„Çø„Çπ„ÇØ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#92" class="md-nav__link">
    <span class="md-ellipsis">
      9.2 „Ç§„Éô„É≥„Éà„Ç∑„Çπ„ÉÜ„É† („Ç™„Éó„Ç∑„Éß„É≥)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#93-celery" class="md-nav__link">
    <span class="md-ellipsis">
      9.3 Celery„ÅÆÊú¨Áï™ÈÅãÁî®„Å´Èñ¢„Åô„ÇãËÄÉÊÖÆ‰∫ãÈ†Ö
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-app" class="md-nav__link">
    <span class="md-ellipsis">
      10. „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥ÂÆüË£Ö‰æã„Å®Ëµ∑ÂãïÊñπÊ≥ï (app/)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="10. „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥ÂÆüË£Ö‰æã„Å®Ëµ∑ÂãïÊñπÊ≥ï (app/)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#101-appmainpy" class="md-nav__link">
    <span class="md-ellipsis">
      10.1 app/main.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#102-approuterstodo_routerpy" class="md-nav__link">
    <span class="md-ellipsis">
      10.2 app/routers/todo_router.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#103-appservicestodo_servicepy" class="md-nav__link">
    <span class="md-ellipsis">
      10.3 app/services/todo_service.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#104-apprepositoriestodo_repositorypy" class="md-nav__link">
    <span class="md-ellipsis">
      10.4 app/repositories/todo_repository.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#105-appmodelstodo_modelpy" class="md-nav__link">
    <span class="md-ellipsis">
      10.5 app/models/todo_model.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#106-appschemastodo_schemapy" class="md-nav__link">
    <span class="md-ellipsis">
      10.6 app/schemas/todo_schema.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#107-appapidependenciespy" class="md-nav__link">
    <span class="md-ellipsis">
      10.7 app/api/dependencies.py („Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆ‰æùÂ≠òÊÄß)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#108-alembic" class="md-nav__link">
    <span class="md-ellipsis">
      10.8 „Éá„Éº„Çø„Éô„Éº„Çπ„Éû„Ç§„Ç∞„É¨„Éº„Ç∑„Éß„É≥ (Alembic)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#109" class="md-nav__link">
    <span class="md-ellipsis">
      10.9 Ëµ∑ÂãïÊñπÊ≥ï
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11" class="md-nav__link">
    <span class="md-ellipsis">
      11. „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞„Å®‰æãÂ§ñÂá¶ÁêÜ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="11. „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞„Å®‰æãÂ§ñÂá¶ÁêÜ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#111" class="md-nav__link">
    <span class="md-ellipsis">
      11.1 „Ç´„Çπ„Çø„É†‰æãÂ§ñ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#112" class="md-nav__link">
    <span class="md-ellipsis">
      11.2 „Ç∞„É≠„Éº„Éê„É´‰æãÂ§ñ„Éè„É≥„Éâ„É©„Éº
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12" class="md-nav__link">
    <span class="md-ellipsis">
      12. „É≠„ÇÆ„É≥„Ç∞„Å®„É¢„Éã„Çø„É™„É≥„Ç∞
    </span>
  </a>
  
    <nav class="md-nav" aria-label="12. „É≠„ÇÆ„É≥„Ç∞„Å®„É¢„Éã„Çø„É™„É≥„Ç∞">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨ („É≠„ÇÆ„É≥„Ç∞)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#121-structlog" class="md-nav__link">
    <span class="md-ellipsis">
      12.1 „É≠„ÇÆ„É≥„Ç∞Ë®≠ÂÆö (structlog)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#122" class="md-nav__link">
    <span class="md-ellipsis">
      12.2 Áõ£Êüª„É≠„Ç∞
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#123" class="md-nav__link">
    <span class="md-ellipsis">
      12.3 „Éü„Éâ„É´„Ç¶„Çß„Ç¢„Å´„Çà„Çã„É¢„Éã„Çø„É™„É≥„Ç∞ („É™„ÇØ„Ç®„Çπ„Éà„É≠„Ç∞)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨ („É¢„Éã„Çø„É™„É≥„Ç∞)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#124-prometheus" class="md-nav__link">
    <span class="md-ellipsis">
      12.4 Prometheus „É°„Éà„É™„ÇØ„Çπ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#13" class="md-nav__link">
    <span class="md-ellipsis">
      13. „Çª„Ç≠„É•„É™„ÉÜ„Ç£
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13. „Çª„Ç≠„É•„É™„ÉÜ„Ç£">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#v050" class="md-nav__link">
    <span class="md-ellipsis">
      üö® v0.5.0 „Çª„Ç≠„É•„É™„ÉÜ„Ç£„Ç¢„ÉÉ„Éó„Éá„Éº„Éà
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨ („Çª„Ç≠„É•„É™„ÉÜ„Ç£‰∏ÄËà¨)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#131-slowapi" class="md-nav__link">
    <span class="md-ellipsis">
      13.1 „É¨„Éº„Éà„É™„Éü„ÉÉ„Éà (slowapi)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#132" class="md-nav__link">
    <span class="md-ellipsis">
      13.2 „Çª„Ç≠„É•„É™„ÉÜ„Ç£„Éò„ÉÉ„ÉÄ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#133" class="md-nav__link">
    <span class="md-ellipsis">
      13.3 ÂÖ•Âäõ„Éê„É™„Éá„Éº„Ç∑„Éß„É≥
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨ („Éë„Çπ„ÉØ„Éº„Éâ„Çª„Ç≠„É•„É™„ÉÜ„Ç£)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#134" class="md-nav__link">
    <span class="md-ellipsis">
      13.4 „Éë„Çπ„ÉØ„Éº„Éâ„Éù„É™„Ç∑„Éº
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#14" class="md-nav__link">
    <span class="md-ellipsis">
      14. „ÉÜ„Çπ„ÉàÊà¶Áï•„Å®„ÉÜ„Çπ„ÉàÂÆüË£Ö
    </span>
  </a>
  
    <nav class="md-nav" aria-label="14. „ÉÜ„Çπ„ÉàÊà¶Áï•„Å®„ÉÜ„Çπ„ÉàÂÆüË£Ö">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨ („ÉÜ„Çπ„Éà„ÅÆÁ®ÆÈ°û)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#141-conftestpy" class="md-nav__link">
    <span class="md-ellipsis">
      14.1 „ÉÜ„Çπ„ÉàË®≠ÂÆö (conftest.py)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#142" class="md-nav__link">
    <span class="md-ellipsis">
      14.2 Âçò‰Ωì„ÉÜ„Çπ„Éà‰æã
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨ („É¢„ÉÉ„ÇØ)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#143" class="md-nav__link">
    <span class="md-ellipsis">
      14.3 Áµ±Âêà„ÉÜ„Çπ„Éà‰æã
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#15" class="md-nav__link">
    <span class="md-ellipsis">
      15. „É≠„Éº„É´„Å®Ê®©Èôê
    </span>
  </a>
  
    <nav class="md-nav" aria-label="15. „É≠„Éº„É´„Å®Ê®©Èôê">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#151" class="md-nav__link">
    <span class="md-ellipsis">
      15.1 „É≠„Éº„É´„ÉªÊ®©Èôê„É¢„Éá„É´
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#152" class="md-nav__link">
    <span class="md-ellipsis">
      15.2 Ê®©Èôê„ÉÅ„Çß„ÉÉ„ÇØ„ÅÆÂÆüË£Ö
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#16-uiux" class="md-nav__link">
    <span class="md-ellipsis">
      16. UI/UXÂÆüË£Ö„ÅÆÈÅ∏ÊäûËÇ¢
    </span>
  </a>
  
    <nav class="md-nav" aria-label="16. UI/UXÂÆüË£Ö„ÅÆÈÅ∏ÊäûËÇ¢">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#uiux" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨ (UI/UX)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#161-spa-react-nextjs-vuejs" class="md-nav__link">
    <span class="md-ellipsis">
      16.1 SPA (React, Next.js, Vue.js „Å™„Å©)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#162-jinja2" class="md-nav__link">
    <span class="md-ellipsis">
      16.2 „Çµ„Éº„Éê„Éº„Çµ„Ç§„Éâ„ÉÜ„É≥„Éó„É¨„Éº„Éà„Ç®„É≥„Ç∏„É≥ (Jinja2„Å™„Å©)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#163-streamlit" class="md-nav__link">
    <span class="md-ellipsis">
      16.3 Streamlit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#164" class="md-nav__link">
    <span class="md-ellipsis">
      16.4 „Éó„É≠„Ç∏„Çß„ÇØ„ÉàÊ®™Êñ≠„ÅÆÂÆüË£Ö„ÉªÈÅãÁî®‰∏ä„ÅÆÁïôÊÑèÁÇπ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#17-ci" class="md-nav__link">
    <span class="md-ellipsis">
      17. Á∂ôÁ∂öÁöÑ„Ç§„É≥„ÉÜ„Ç∞„É¨„Éº„Ç∑„Éß„É≥ (CI)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="17. Á∂ôÁ∂öÁöÑ„Ç§„É≥„ÉÜ„Ç∞„É¨„Éº„Ç∑„Éß„É≥ (CI)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cicd" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨ (CI/CD)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#171-github-actions-ci" class="md-nav__link">
    <span class="md-ellipsis">
      17.1 GitHub Actions „Å´„Çà„ÇãCI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#172-ci" class="md-nav__link">
    <span class="md-ellipsis">
      17.2 CI„Éë„Ç§„Éó„É©„Ç§„É≥„ÅÆÊßãÊàê
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#173" class="md-nav__link">
    <span class="md-ellipsis">
      17.3 „ÉÜ„Çπ„ÉàËá™ÂãïÂåñ„Å®„Ç´„Éê„É¨„ÉÉ„Ç∏
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#174-ci" class="md-nav__link">
    <span class="md-ellipsis">
      17.4 CIÁí∞Â¢É„ÅÆË®≠ÂÆö
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#18" class="md-nav__link">
    <span class="md-ellipsis">
      18. „Åæ„Å®„ÇÅ
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#19-ddd" class="md-nav__link">
    <span class="md-ellipsis">
      19. ‰ªäÂæå„ÅÆÊã°Âºµ„ÉªDDD„Å∏„ÅÆÂ∏ÉÁü≥
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#20" class="md-nav__link">
    <span class="md-ellipsis">
      20. „Éê„Éº„Ç∏„Éß„É≥Â±•Ê≠¥
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      „Åä„Çè„Çä„Å´
    </span>
  </a>
  
    <nav class="md-nav" aria-label="„Åä„Çè„Çä„Å´">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      „Éâ„Ç≠„É•„É°„É≥„Éà„Å®ÂÆüË£Ö„ÅÆÊï¥ÂêàÊÄß„ÅÆÈáçË¶ÅÊÄß
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ddd" class="md-nav__link">
    <span class="md-ellipsis">
      DDD„Éª„Éû„É´„ÉÅ„É¨„Ç§„É§Âåñ„Å∏„ÅÆ‰ªäÂæå„ÅÆÂ±ïÊúõ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      ÂèÇËÄÉ„É™„É≥„ÇØ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix-faq" class="md-nav__link">
    <span class="md-ellipsis">
      Appendix: „Ç≥„É≥„Éà„É™„Éì„É•„Éº„Ç∑„Éß„É≥„Å®FAQ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Appendix: „Ç≥„É≥„Éà„É™„Éì„É•„Éº„Ç∑„Éß„É≥„Å®FAQ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      „Ç≥„É≥„Éà„É™„Éì„É•„Éº„Ç∑„Éß„É≥„Ç¨„Ç§„Éâ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#faq" class="md-nav__link">
    <span class="md-ellipsis">
      FAQ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      ÁõÆÊ¨°
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#01" class="md-nav__link">
    <span class="md-ellipsis">
      01. „ÅØ„Åò„ÇÅ„Å´
    </span>
  </a>
  
    <nav class="md-nav" aria-label="01. „ÅØ„Åò„ÇÅ„Å´">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#02" class="md-nav__link">
    <span class="md-ellipsis">
      02. „Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£Ê¶ÇË¶Å
    </span>
  </a>
  
    <nav class="md-nav" aria-label="02. „Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£Ê¶ÇË¶Å">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 „Éó„É≠„Ç∏„Çß„ÇØ„ÉàÊßãÈÄ†„Å®„É¨„Ç§„É§„Éº
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 ‰æùÂ≠òÈñ¢‰øÇ„ÅÆÊµÅ„Çå
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#03" class="md-nav__link">
    <span class="md-ellipsis">
      03. „Éá„Ç£„É¨„ÇØ„Éà„É™ÊßãÊàê
    </span>
  </a>
  
    <nav class="md-nav" aria-label="03. „Éá„Ç£„É¨„ÇØ„Éà„É™ÊßãÊàê">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-libkoiki" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 libkoiki („Éï„É¨„Éº„É†„ÉØ„Éº„ÇØ„Ç≥„Ç¢)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-app" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 app („Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#04-configdi" class="md-nav__link">
    <span class="md-ellipsis">
      04. Ë®≠ÂÆöÔºàConfigÔºâ„Å®‰æùÂ≠òÊÄßÊ≥®ÂÖ•ÔºàDIÔºâ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="04. Ë®≠ÂÆöÔºàConfigÔºâ„Å®‰æùÂ≠òÊÄßÊ≥®ÂÖ•ÔºàDIÔºâ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#41-configpy" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 Ë®≠ÂÆöÁÆ°ÁêÜ (config.py)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-dependenciespy" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 ‰æùÂ≠òÊÄßÊ≥®ÂÖ• (dependencies.py)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#05" class="md-nav__link">
    <span class="md-ellipsis">
      05. „É¢„Éá„É´ &amp; „Çπ„Ç≠„Éº„ÉûÂ±§
    </span>
  </a>
  
    <nav class="md-nav" aria-label="05. „É¢„Éá„É´ &amp; „Çπ„Ç≠„Éº„ÉûÂ±§">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#51-sqlalchemy" class="md-nav__link">
    <span class="md-ellipsis">
      5.1 „Éá„Éº„Çø„Éô„Éº„Çπ„É¢„Éá„É´ (SQLAlchemy)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-api-pydantic" class="md-nav__link">
    <span class="md-ellipsis">
      5.2 API„Çπ„Ç≠„Éº„Éû (Pydantic)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#06" class="md-nav__link">
    <span class="md-ellipsis">
      06. „É™„Éù„Ç∏„Éà„É™Â±§
    </span>
  </a>
  
    <nav class="md-nav" aria-label="06. „É™„Éù„Ç∏„Éà„É™Â±§">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#61" class="md-nav__link">
    <span class="md-ellipsis">
      6.1 „Éô„Éº„Çπ„É™„Éù„Ç∏„Éà„É™
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62" class="md-nav__link">
    <span class="md-ellipsis">
      6.2 ÂÖ∑‰ΩìÁöÑ„Å™„É™„Éù„Ç∏„Éà„É™ÂÆüË£Ö
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#07" class="md-nav__link">
    <span class="md-ellipsis">
      07. „Çµ„Éº„Éì„ÇπÂ±§
    </span>
  </a>
  
    <nav class="md-nav" aria-label="07. „Çµ„Éº„Éì„ÇπÂ±§">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#71" class="md-nav__link">
    <span class="md-ellipsis">
      7.1 „Çµ„Éº„Éì„Çπ„ÇØ„É©„Çπ„ÅÆÂÆüË£Ö
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72" class="md-nav__link">
    <span class="md-ellipsis">
      7.2 „Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥ÁÆ°ÁêÜ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#08-jwt" class="md-nav__link">
    <span class="md-ellipsis">
      08. Ë™çË®º„ÉªË™çÂèØÔºàJWTÔºâ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="08. Ë™çË®º„ÉªË™çÂèØÔºàJWTÔºâ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#81-jwt" class="md-nav__link">
    <span class="md-ellipsis">
      8.1 JWTË™çË®º„ÅÆÂÆüË£Ö
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#82-api" class="md-nav__link">
    <span class="md-ellipsis">
      8.2 Ë™çË®ºAPI„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#83-rbac" class="md-nav__link">
    <span class="md-ellipsis">
      8.3 „É≠„Éº„É´„Éô„Éº„Çπ„Ç¢„ÇØ„Çª„ÇπÂà∂Âæ° (RBAC)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#09-celery-redis" class="md-nav__link">
    <span class="md-ellipsis">
      09. ÈùûÂêåÊúüÂá¶ÁêÜÔºàCelery &amp; RedisÔºâ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="09. ÈùûÂêåÊúüÂá¶ÁêÜÔºàCelery &amp; RedisÔºâ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#91-celery" class="md-nav__link">
    <span class="md-ellipsis">
      9.1 Celery„Å´„Çà„ÇãÈùûÂêåÊúü„Çø„Çπ„ÇØ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#92" class="md-nav__link">
    <span class="md-ellipsis">
      9.2 „Ç§„Éô„É≥„Éà„Ç∑„Çπ„ÉÜ„É† („Ç™„Éó„Ç∑„Éß„É≥)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#93-celery" class="md-nav__link">
    <span class="md-ellipsis">
      9.3 Celery„ÅÆÊú¨Áï™ÈÅãÁî®„Å´Èñ¢„Åô„ÇãËÄÉÊÖÆ‰∫ãÈ†Ö
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-app" class="md-nav__link">
    <span class="md-ellipsis">
      10. „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥ÂÆüË£Ö‰æã„Å®Ëµ∑ÂãïÊñπÊ≥ï (app/)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="10. „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥ÂÆüË£Ö‰æã„Å®Ëµ∑ÂãïÊñπÊ≥ï (app/)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#101-appmainpy" class="md-nav__link">
    <span class="md-ellipsis">
      10.1 app/main.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#102-approuterstodo_routerpy" class="md-nav__link">
    <span class="md-ellipsis">
      10.2 app/routers/todo_router.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#103-appservicestodo_servicepy" class="md-nav__link">
    <span class="md-ellipsis">
      10.3 app/services/todo_service.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#104-apprepositoriestodo_repositorypy" class="md-nav__link">
    <span class="md-ellipsis">
      10.4 app/repositories/todo_repository.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#105-appmodelstodo_modelpy" class="md-nav__link">
    <span class="md-ellipsis">
      10.5 app/models/todo_model.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#106-appschemastodo_schemapy" class="md-nav__link">
    <span class="md-ellipsis">
      10.6 app/schemas/todo_schema.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#107-appapidependenciespy" class="md-nav__link">
    <span class="md-ellipsis">
      10.7 app/api/dependencies.py („Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆ‰æùÂ≠òÊÄß)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#108-alembic" class="md-nav__link">
    <span class="md-ellipsis">
      10.8 „Éá„Éº„Çø„Éô„Éº„Çπ„Éû„Ç§„Ç∞„É¨„Éº„Ç∑„Éß„É≥ (Alembic)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#109" class="md-nav__link">
    <span class="md-ellipsis">
      10.9 Ëµ∑ÂãïÊñπÊ≥ï
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11" class="md-nav__link">
    <span class="md-ellipsis">
      11. „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞„Å®‰æãÂ§ñÂá¶ÁêÜ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="11. „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞„Å®‰æãÂ§ñÂá¶ÁêÜ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#111" class="md-nav__link">
    <span class="md-ellipsis">
      11.1 „Ç´„Çπ„Çø„É†‰æãÂ§ñ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#112" class="md-nav__link">
    <span class="md-ellipsis">
      11.2 „Ç∞„É≠„Éº„Éê„É´‰æãÂ§ñ„Éè„É≥„Éâ„É©„Éº
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12" class="md-nav__link">
    <span class="md-ellipsis">
      12. „É≠„ÇÆ„É≥„Ç∞„Å®„É¢„Éã„Çø„É™„É≥„Ç∞
    </span>
  </a>
  
    <nav class="md-nav" aria-label="12. „É≠„ÇÆ„É≥„Ç∞„Å®„É¢„Éã„Çø„É™„É≥„Ç∞">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨ („É≠„ÇÆ„É≥„Ç∞)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#121-structlog" class="md-nav__link">
    <span class="md-ellipsis">
      12.1 „É≠„ÇÆ„É≥„Ç∞Ë®≠ÂÆö (structlog)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#122" class="md-nav__link">
    <span class="md-ellipsis">
      12.2 Áõ£Êüª„É≠„Ç∞
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#123" class="md-nav__link">
    <span class="md-ellipsis">
      12.3 „Éü„Éâ„É´„Ç¶„Çß„Ç¢„Å´„Çà„Çã„É¢„Éã„Çø„É™„É≥„Ç∞ („É™„ÇØ„Ç®„Çπ„Éà„É≠„Ç∞)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨ („É¢„Éã„Çø„É™„É≥„Ç∞)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#124-prometheus" class="md-nav__link">
    <span class="md-ellipsis">
      12.4 Prometheus „É°„Éà„É™„ÇØ„Çπ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#13" class="md-nav__link">
    <span class="md-ellipsis">
      13. „Çª„Ç≠„É•„É™„ÉÜ„Ç£
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13. „Çª„Ç≠„É•„É™„ÉÜ„Ç£">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#v050" class="md-nav__link">
    <span class="md-ellipsis">
      üö® v0.5.0 „Çª„Ç≠„É•„É™„ÉÜ„Ç£„Ç¢„ÉÉ„Éó„Éá„Éº„Éà
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨ („Çª„Ç≠„É•„É™„ÉÜ„Ç£‰∏ÄËà¨)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#131-slowapi" class="md-nav__link">
    <span class="md-ellipsis">
      13.1 „É¨„Éº„Éà„É™„Éü„ÉÉ„Éà (slowapi)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#132" class="md-nav__link">
    <span class="md-ellipsis">
      13.2 „Çª„Ç≠„É•„É™„ÉÜ„Ç£„Éò„ÉÉ„ÉÄ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#133" class="md-nav__link">
    <span class="md-ellipsis">
      13.3 ÂÖ•Âäõ„Éê„É™„Éá„Éº„Ç∑„Éß„É≥
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨ („Éë„Çπ„ÉØ„Éº„Éâ„Çª„Ç≠„É•„É™„ÉÜ„Ç£)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#134" class="md-nav__link">
    <span class="md-ellipsis">
      13.4 „Éë„Çπ„ÉØ„Éº„Éâ„Éù„É™„Ç∑„Éº
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#14" class="md-nav__link">
    <span class="md-ellipsis">
      14. „ÉÜ„Çπ„ÉàÊà¶Áï•„Å®„ÉÜ„Çπ„ÉàÂÆüË£Ö
    </span>
  </a>
  
    <nav class="md-nav" aria-label="14. „ÉÜ„Çπ„ÉàÊà¶Áï•„Å®„ÉÜ„Çπ„ÉàÂÆüË£Ö">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨ („ÉÜ„Çπ„Éà„ÅÆÁ®ÆÈ°û)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#141-conftestpy" class="md-nav__link">
    <span class="md-ellipsis">
      14.1 „ÉÜ„Çπ„ÉàË®≠ÂÆö (conftest.py)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#142" class="md-nav__link">
    <span class="md-ellipsis">
      14.2 Âçò‰Ωì„ÉÜ„Çπ„Éà‰æã
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨ („É¢„ÉÉ„ÇØ)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#143" class="md-nav__link">
    <span class="md-ellipsis">
      14.3 Áµ±Âêà„ÉÜ„Çπ„Éà‰æã
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#15" class="md-nav__link">
    <span class="md-ellipsis">
      15. „É≠„Éº„É´„Å®Ê®©Èôê
    </span>
  </a>
  
    <nav class="md-nav" aria-label="15. „É≠„Éº„É´„Å®Ê®©Èôê">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#151" class="md-nav__link">
    <span class="md-ellipsis">
      15.1 „É≠„Éº„É´„ÉªÊ®©Èôê„É¢„Éá„É´
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#152" class="md-nav__link">
    <span class="md-ellipsis">
      15.2 Ê®©Èôê„ÉÅ„Çß„ÉÉ„ÇØ„ÅÆÂÆüË£Ö
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#16-uiux" class="md-nav__link">
    <span class="md-ellipsis">
      16. UI/UXÂÆüË£Ö„ÅÆÈÅ∏ÊäûËÇ¢
    </span>
  </a>
  
    <nav class="md-nav" aria-label="16. UI/UXÂÆüË£Ö„ÅÆÈÅ∏ÊäûËÇ¢">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#uiux" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨ (UI/UX)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#161-spa-react-nextjs-vuejs" class="md-nav__link">
    <span class="md-ellipsis">
      16.1 SPA (React, Next.js, Vue.js „Å™„Å©)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#162-jinja2" class="md-nav__link">
    <span class="md-ellipsis">
      16.2 „Çµ„Éº„Éê„Éº„Çµ„Ç§„Éâ„ÉÜ„É≥„Éó„É¨„Éº„Éà„Ç®„É≥„Ç∏„É≥ (Jinja2„Å™„Å©)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#163-streamlit" class="md-nav__link">
    <span class="md-ellipsis">
      16.3 Streamlit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#164" class="md-nav__link">
    <span class="md-ellipsis">
      16.4 „Éó„É≠„Ç∏„Çß„ÇØ„ÉàÊ®™Êñ≠„ÅÆÂÆüË£Ö„ÉªÈÅãÁî®‰∏ä„ÅÆÁïôÊÑèÁÇπ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#17-ci" class="md-nav__link">
    <span class="md-ellipsis">
      17. Á∂ôÁ∂öÁöÑ„Ç§„É≥„ÉÜ„Ç∞„É¨„Éº„Ç∑„Éß„É≥ (CI)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="17. Á∂ôÁ∂öÁöÑ„Ç§„É≥„ÉÜ„Ç∞„É¨„Éº„Ç∑„Éß„É≥ (CI)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cicd" class="md-nav__link">
    <span class="md-ellipsis">
      üî∞ Áî®Ë™ûËß£Ë™¨ (CI/CD)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#171-github-actions-ci" class="md-nav__link">
    <span class="md-ellipsis">
      17.1 GitHub Actions „Å´„Çà„ÇãCI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#172-ci" class="md-nav__link">
    <span class="md-ellipsis">
      17.2 CI„Éë„Ç§„Éó„É©„Ç§„É≥„ÅÆÊßãÊàê
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#173" class="md-nav__link">
    <span class="md-ellipsis">
      17.3 „ÉÜ„Çπ„ÉàËá™ÂãïÂåñ„Å®„Ç´„Éê„É¨„ÉÉ„Ç∏
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#174-ci" class="md-nav__link">
    <span class="md-ellipsis">
      17.4 CIÁí∞Â¢É„ÅÆË®≠ÂÆö
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#18" class="md-nav__link">
    <span class="md-ellipsis">
      18. „Åæ„Å®„ÇÅ
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#19-ddd" class="md-nav__link">
    <span class="md-ellipsis">
      19. ‰ªäÂæå„ÅÆÊã°Âºµ„ÉªDDD„Å∏„ÅÆÂ∏ÉÁü≥
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#20" class="md-nav__link">
    <span class="md-ellipsis">
      20. „Éê„Éº„Ç∏„Éß„É≥Â±•Ê≠¥
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      „Åä„Çè„Çä„Å´
    </span>
  </a>
  
    <nav class="md-nav" aria-label="„Åä„Çè„Çä„Å´">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      „Éâ„Ç≠„É•„É°„É≥„Éà„Å®ÂÆüË£Ö„ÅÆÊï¥ÂêàÊÄß„ÅÆÈáçË¶ÅÊÄß
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ddd" class="md-nav__link">
    <span class="md-ellipsis">
      DDD„Éª„Éû„É´„ÉÅ„É¨„Ç§„É§Âåñ„Å∏„ÅÆ‰ªäÂæå„ÅÆÂ±ïÊúõ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      ÂèÇËÄÉ„É™„É≥„ÇØ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix-faq" class="md-nav__link">
    <span class="md-ellipsis">
      Appendix: „Ç≥„É≥„Éà„É™„Éì„É•„Éº„Ç∑„Éß„É≥„Å®FAQ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Appendix: „Ç≥„É≥„Éà„É™„Éì„É•„Éº„Ç∑„Éß„É≥„Å®FAQ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      „Ç≥„É≥„Éà„É™„Éì„É•„Éº„Ç∑„Éß„É≥„Ç¨„Ç§„Éâ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#faq" class="md-nav__link">
    <span class="md-ellipsis">
      FAQ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="koiki-fw-v050">KOIKI-FW v0.5.0</h1>
<hr />
<p>Êú¨„Éâ„Ç≠„É•„É°„É≥„Éà„ÅØ„ÄÅ„Ç®„É≥„Çø„Éº„Éó„É©„Ç§„Ç∫Âêë„ÅëFastAPI„Éô„Éº„Çπ„ÅÆWeb„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥ÈñãÁô∫„Éï„É¨„Éº„É†„ÉØ„Éº„ÇØ„ÄåKOIKI-FW„Äç„ÅÆ„Éê„Éº„Ç∏„Éß„É≥ 0.5.0 „Å´ÂØæÂøú„Åó„ÅüÊ©üËÉΩË®≠Ë®à„ÉªÊßãÊàê„Ç¨„Ç§„Éâ„Åß„Åô„ÄÇ
„Åì„ÅÆ„Éê„Éº„Ç∏„Éß„É≥„Åß„ÅØ„ÄÅv0.3.1„ÅÆÂü∫Êú¨ÊßãÊàê„ÇíÁ∂≠ÊåÅ„Åó„Å™„Åå„Çâ„ÄÅÈáçË¶Å„Å™„Çª„Ç≠„É•„É™„ÉÜ„Ç£ËÑÜÂº±ÊÄß„ÅÆ‰øÆÊ≠£„Å®„Ç®„É≥„Çø„Éº„Éó„É©„Ç§„Ç∫Âêë„Åë‰æùÂ≠òÊÄßÁÆ°ÁêÜÊà¶Áï•„ÄÅÂåÖÊã¨ÁöÑ„Å™‰æùÂ≠òÈñ¢‰øÇ„ÅÆ„É¢„ÉÄ„Éä„Ç§„Çº„Éº„Ç∑„Éß„É≥„ÅåÂÆüÊñΩ„Åï„Çå„Åæ„Åó„Åü„ÄÇ</p>
<hr />
<h2 id="_1">ÁõÆÊ¨°</h2>
<ul>
<li><a href="#01-„ÅØ„Åò„ÇÅ„Å´">01. „ÅØ„Åò„ÇÅ„Å´</a><ul>
<li><a href="#01„ÅØ„Åò„ÇÅ„Å´-Áî®Ë™ûËß£Ë™¨">üî∞ Áî®Ë™ûËß£Ë™¨</a></li>
</ul>
</li>
<li><a href="#02-„Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£Ê¶ÇË¶Å">02. „Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£Ê¶ÇË¶Å</a><ul>
<li><a href="#21-„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÊßãÈÄ†„Å®„É¨„Ç§„É§„Éº">2.1 „Éó„É≠„Ç∏„Çß„ÇØ„ÉàÊßãÈÄ†„Å®„É¨„Ç§„É§„Éº</a></li>
<li><a href="#22-‰æùÂ≠òÈñ¢‰øÇ„ÅÆÊµÅ„Çå">2.2 ‰æùÂ≠òÈñ¢‰øÇ„ÅÆÊµÅ„Çå</a></li>
</ul>
</li>
<li><a href="#03-„Éá„Ç£„É¨„ÇØ„Éà„É™ÊßãÊàê">03. „Éá„Ç£„É¨„ÇØ„Éà„É™ÊßãÊàê</a><ul>
<li><a href="#31-libkoiki-„Éï„É¨„Éº„É†„ÉØ„Éº„ÇØ„Ç≥„Ç¢">3.1 libkoiki („Éï„É¨„Éº„É†„ÉØ„Éº„ÇØ„Ç≥„Ç¢)</a></li>
<li><a href="#32-app-„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ">3.2 app („Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ)</a></li>
</ul>
</li>
<li><a href="#04-Ë®≠ÂÆöconfig„Å®‰æùÂ≠òÊÄßÊ≥®ÂÖ•di">04. Ë®≠ÂÆöÔºàConfigÔºâ„Å®‰æùÂ≠òÊÄßÊ≥®ÂÖ•ÔºàDIÔºâ</a><ul>
<li><a href="#04Ë®≠ÂÆöconfig„Å®‰æùÂ≠òÊÄßÊ≥®ÂÖ•di-Áî®Ë™ûËß£Ë™¨">üî∞ Áî®Ë™ûËß£Ë™¨</a></li>
<li><a href="#41-Ë®≠ÂÆöÁÆ°ÁêÜ-configpy">4.1 Ë®≠ÂÆöÁÆ°ÁêÜ (config.py)</a></li>
<li><a href="#42-‰æùÂ≠òÊÄßÊ≥®ÂÖ•-dependenciespy">4.2 ‰æùÂ≠òÊÄßÊ≥®ÂÖ• (dependencies.py)</a></li>
</ul>
</li>
<li><a href="#05-„É¢„Éá„É´„Çπ„Ç≠„Éº„ÉûÂ±§">05. „É¢„Éá„É´ &amp; „Çπ„Ç≠„Éº„ÉûÂ±§</a><ul>
<li><a href="#05„É¢„Éá„É´„Çπ„Ç≠„Éº„ÉûÂ±§-Áî®Ë™ûËß£Ë™¨">üî∞ Áî®Ë™ûËß£Ë™¨</a></li>
<li><a href="#51-„Éá„Éº„Çø„Éô„Éº„Çπ„É¢„Éá„É´-sqlalchemy">5.1 „Éá„Éº„Çø„Éô„Éº„Çπ„É¢„Éá„É´ (SQLAlchemy)</a></li>
<li><a href="#52-api„Çπ„Ç≠„Éº„Éû-pydantic">5.2 API„Çπ„Ç≠„Éº„Éû (Pydantic)</a></li>
</ul>
</li>
<li><a href="#06-„É™„Éù„Ç∏„Éà„É™Â±§">06. „É™„Éù„Ç∏„Éà„É™Â±§</a><ul>
<li><a href="#06„É™„Éù„Ç∏„Éà„É™Â±§-Áî®Ë™ûËß£Ë™¨">üî∞ Áî®Ë™ûËß£Ë™¨</a></li>
<li><a href="#61-„Éô„Éº„Çπ„É™„Éù„Ç∏„Éà„É™">6.1 „Éô„Éº„Çπ„É™„Éù„Ç∏„Éà„É™</a></li>
<li><a href="#62-ÂÖ∑‰ΩìÁöÑ„Å™„É™„Éù„Ç∏„Éà„É™ÂÆüË£Ö">6.2 ÂÖ∑‰ΩìÁöÑ„Å™„É™„Éù„Ç∏„Éà„É™ÂÆüË£Ö</a></li>
</ul>
</li>
<li><a href="#07-„Çµ„Éº„Éì„ÇπÂ±§">07. „Çµ„Éº„Éì„ÇπÂ±§</a><ul>
<li><a href="#07„Çµ„Éº„Éì„ÇπÂ±§-Áî®Ë™ûËß£Ë™¨">üî∞ Áî®Ë™ûËß£Ë™¨</a></li>
<li><a href="#71-„Çµ„Éº„Éì„Çπ„ÇØ„É©„Çπ„ÅÆÂÆüË£Ö">7.1 „Çµ„Éº„Éì„Çπ„ÇØ„É©„Çπ„ÅÆÂÆüË£Ö</a></li>
<li><a href="#72-„Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥ÁÆ°ÁêÜ">7.2 „Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥ÁÆ°ÁêÜ</a></li>
</ul>
</li>
<li><a href="#08-Ë™çË®ºË™çÂèØjwt">08. Ë™çË®º„ÉªË™çÂèØÔºàJWTÔºâ</a><ul>
<li><a href="#08Ë™çË®ºË™çÂèØjwt-Áî®Ë™ûËß£Ë™¨">üî∞ Áî®Ë™ûËß£Ë™¨</a></li>
<li><a href="#81-jwtË™çË®º„ÅÆÂÆüË£Ö">8.1 JWTË™çË®º„ÅÆÂÆüË£Ö</a></li>
<li><a href="#82-Ë™çË®ºapi„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà">8.2 Ë™çË®ºAPI„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà</a></li>
<li><a href="#83-„É≠„Éº„É´„Éô„Éº„Çπ„Ç¢„ÇØ„Çª„ÇπÂà∂Âæ°-rbac">8.3 „É≠„Éº„É´„Éô„Éº„Çπ„Ç¢„ÇØ„Çª„ÇπÂà∂Âæ° (RBAC)</a></li>
</ul>
</li>
<li><a href="#09-ÈùûÂêåÊúüÂá¶ÁêÜceleryredis">09. ÈùûÂêåÊúüÂá¶ÁêÜÔºàCelery &amp; RedisÔºâ</a><ul>
<li><a href="#09ÈùûÂêåÊúüÂá¶ÁêÜceleryredis-Áî®Ë™ûËß£Ë™¨">üî∞ Áî®Ë™ûËß£Ë™¨</a></li>
<li><a href="#91-celery„Å´„Çà„ÇãÈùûÂêåÊúü„Çø„Çπ„ÇØ">9.1 Celery„Å´„Çà„ÇãÈùûÂêåÊúü„Çø„Çπ„ÇØ</a></li>
<li><a href="#92-„Ç§„Éô„É≥„Éà„Ç∑„Çπ„ÉÜ„É†-„Ç™„Éó„Ç∑„Éß„É≥">9.2 „Ç§„Éô„É≥„Éà„Ç∑„Çπ„ÉÜ„É† („Ç™„Éó„Ç∑„Éß„É≥)</a></li>
<li><a href="#93-celery„ÅÆÊú¨Áï™ÈÅãÁî®„Å´Èñ¢„Åô„ÇãËÄÉÊÖÆ‰∫ãÈ†Ö">9.3 Celery„ÅÆÊú¨Áï™ÈÅãÁî®„Å´Èñ¢„Åô„ÇãËÄÉÊÖÆ‰∫ãÈ†Ö</a></li>
</ul>
</li>
<li><a href="#10-„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥ÂÆüË£Ö‰æã„Å®Ëµ∑ÂãïÊñπÊ≥ï-app">10. „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥ÂÆüË£Ö‰æã„Å®Ëµ∑ÂãïÊñπÊ≥ï (app/)</a><ul>
<li><a href="#101-appmainpy">10.1 app/main.py</a></li>
<li><a href="#102-approuterstodo_routerpy">10.2 app/routers/todo_router.py</a></li>
<li><a href="#103-appservicestodo_servicepy">10.3 app/services/todo_service.py</a></li>
<li><a href="#104-apprepositoriestodo_repositorypy">10.4 app/repositories/todo_repository.py</a></li>
<li><a href="#105-appmodelstodo_modelpy">10.5 app/models/todo_model.py</a></li>
<li><a href="#106-appschemastodo_schemapy">10.6 app/schemas/todo_schema.py</a></li>
<li><a href="#107-appapidependenciespy-„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆ‰æùÂ≠òÊÄß">10.7 app/api/dependencies.py („Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆ‰æùÂ≠òÊÄß)</a></li>
<li><a href="#108-„Éá„Éº„Çø„Éô„Éº„Çπ„Éû„Ç§„Ç∞„É¨„Éº„Ç∑„Éß„É≥-alembic">10.8 „Éá„Éº„Çø„Éô„Éº„Çπ„Éû„Ç§„Ç∞„É¨„Éº„Ç∑„Éß„É≥ (Alembic)</a></li>
<li><a href="#109-Ëµ∑ÂãïÊñπÊ≥ï">10.9 Ëµ∑ÂãïÊñπÊ≥ï</a></li>
</ul>
</li>
<li><a href="#11-„Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞„Å®‰æãÂ§ñÂá¶ÁêÜ">11. „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞„Å®‰æãÂ§ñÂá¶ÁêÜ</a><ul>
<li><a href="#111-„Ç´„Çπ„Çø„É†‰æãÂ§ñ">11.1 „Ç´„Çπ„Çø„É†‰æãÂ§ñ</a></li>
<li><a href="#112-„Ç∞„É≠„Éº„Éê„É´‰æãÂ§ñ„Éè„É≥„Éâ„É©„Éº">11.2 „Ç∞„É≠„Éº„Éê„É´‰æãÂ§ñ„Éè„É≥„Éâ„É©„Éº</a></li>
</ul>
</li>
<li><a href="#12-„É≠„ÇÆ„É≥„Ç∞„Å®„É¢„Éã„Çø„É™„É≥„Ç∞">12. „É≠„ÇÆ„É≥„Ç∞„Å®„É¢„Éã„Çø„É™„É≥„Ç∞</a><ul>
<li><a href="#12„É≠„ÇÆ„É≥„Ç∞„Å®„É¢„Éã„Çø„É™„É≥„Ç∞-Áî®Ë™ûËß£Ë™¨-„É≠„ÇÆ„É≥„Ç∞">üî∞ Áî®Ë™ûËß£Ë™¨ („É≠„ÇÆ„É≥„Ç∞)</a></li>
<li><a href="#121-„É≠„ÇÆ„É≥„Ç∞Ë®≠ÂÆö-structlog">12.1 „É≠„ÇÆ„É≥„Ç∞Ë®≠ÂÆö (structlog)</a></li>
<li><a href="#122-Áõ£Êüª„É≠„Ç∞">12.2 Áõ£Êüª„É≠„Ç∞</a></li>
<li><a href="#123-„Éü„Éâ„É´„Ç¶„Çß„Ç¢„Å´„Çà„Çã„É¢„Éã„Çø„É™„É≥„Ç∞-„É™„ÇØ„Ç®„Çπ„Éà„É≠„Ç∞">12.3 „Éü„Éâ„É´„Ç¶„Çß„Ç¢„Å´„Çà„Çã„É¢„Éã„Çø„É™„É≥„Ç∞ („É™„ÇØ„Ç®„Çπ„Éà„É≠„Ç∞)</a></li>
<li><a href="#12„É≠„ÇÆ„É≥„Ç∞„Å®„É¢„Éã„Çø„É™„É≥„Ç∞-Áî®Ë™ûËß£Ë™¨-„É¢„Éã„Çø„É™„É≥„Ç∞">üî∞ Áî®Ë™ûËß£Ë™¨ („É¢„Éã„Çø„É™„É≥„Ç∞)</a></li>
<li><a href="#124-prometheus-„É°„Éà„É™„ÇØ„Çπ">12.4 Prometheus „É°„Éà„É™„ÇØ„Çπ</a></li>
</ul>
</li>
<li><a href="#13-„Çª„Ç≠„É•„É™„ÉÜ„Ç£">13. „Çª„Ç≠„É•„É™„ÉÜ„Ç£</a><ul>
<li><a href="#13„Çª„Ç≠„É•„É™„ÉÜ„Ç£-Áî®Ë™ûËß£Ë™¨-„Çª„Ç≠„É•„É™„ÉÜ„Ç£‰∏ÄËà¨">üî∞ Áî®Ë™ûËß£Ë™¨ („Çª„Ç≠„É•„É™„ÉÜ„Ç£‰∏ÄËà¨)</a></li>
<li><a href="#131-„É¨„Éº„Éà„É™„Éü„ÉÉ„Éà-slowapi">13.1 „É¨„Éº„Éà„É™„Éü„ÉÉ„Éà (slowapi)</a></li>
<li><a href="#132-„Çª„Ç≠„É•„É™„ÉÜ„Ç£„Éò„ÉÉ„ÉÄ">13.2 „Çª„Ç≠„É•„É™„ÉÜ„Ç£„Éò„ÉÉ„ÉÄ</a></li>
<li><a href="#133-ÂÖ•Âäõ„Éê„É™„Éá„Éº„Ç∑„Éß„É≥">13.3 ÂÖ•Âäõ„Éê„É™„Éá„Éº„Ç∑„Éß„É≥</a></li>
<li><a href="#13„Çª„Ç≠„É•„É™„ÉÜ„Ç£-Áî®Ë™ûËß£Ë™¨-„Éë„Çπ„ÉØ„Éº„Éâ„Çª„Ç≠„É•„É™„ÉÜ„Ç£">üî∞ Áî®Ë™ûËß£Ë™¨ („Éë„Çπ„ÉØ„Éº„Éâ„Çª„Ç≠„É•„É™„ÉÜ„Ç£)</a></li>
<li><a href="#134-„Éë„Çπ„ÉØ„Éº„Éâ„Éù„É™„Ç∑„Éº">13.4 „Éë„Çπ„ÉØ„Éº„Éâ„Éù„É™„Ç∑„Éº</a></li>
</ul>
</li>
<li><a href="#14-„ÉÜ„Çπ„ÉàÊà¶Áï•„Å®„ÉÜ„Çπ„ÉàÂÆüË£Ö">14. „ÉÜ„Çπ„ÉàÊà¶Áï•„Å®„ÉÜ„Çπ„ÉàÂÆüË£Ö</a><ul>
<li><a href="#14„ÉÜ„Çπ„ÉàÊà¶Áï•„Å®„ÉÜ„Çπ„ÉàÂÆüË£Ö-Áî®Ë™ûËß£Ë™¨-„ÉÜ„Çπ„Éà„ÅÆÁ®ÆÈ°û">üî∞ Áî®Ë™ûËß£Ë™¨ („ÉÜ„Çπ„Éà„ÅÆÁ®ÆÈ°û)</a></li>
<li><a href="#141-„ÉÜ„Çπ„ÉàË®≠ÂÆö-conftestpy">14.1 „ÉÜ„Çπ„ÉàË®≠ÂÆö (conftest.py)</a></li>
<li><a href="#142-Âçò‰Ωì„ÉÜ„Çπ„Éà‰æã">14.2 Âçò‰Ωì„ÉÜ„Çπ„Éà‰æã</a></li>
<li><a href="#14„ÉÜ„Çπ„ÉàÊà¶Áï•„Å®„ÉÜ„Çπ„ÉàÂÆüË£Ö-Áî®Ë™ûËß£Ë™¨-„É¢„ÉÉ„ÇØ">üî∞ Áî®Ë™ûËß£Ë™¨ („É¢„ÉÉ„ÇØ)</a></li>
<li><a href="#143-Áµ±Âêà„ÉÜ„Çπ„Éà‰æã">14.3 Áµ±Âêà„ÉÜ„Çπ„Éà‰æã</a></li>
</ul>
</li>
<li><a href="#15-„É≠„Éº„É´„Å®Ê®©Èôê">15. „É≠„Éº„É´„Å®Ê®©Èôê</a><ul>
<li><a href="#151-„É≠„Éº„É´Ê®©Èôê„É¢„Éá„É´">15.1 „É≠„Éº„É´„ÉªÊ®©Èôê„É¢„Éá„É´</a></li>
<li><a href="#152-Ê®©Èôê„ÉÅ„Çß„ÉÉ„ÇØ„ÅÆÂÆüË£Ö">15.2 Ê®©Èôê„ÉÅ„Çß„ÉÉ„ÇØ„ÅÆÂÆüË£Ö</a></li>
</ul>
</li>
<li><a href="#16-uiuxÂÆüË£Ö„ÅÆÈÅ∏ÊäûËÇ¢">16. UI/UXÂÆüË£Ö„ÅÆÈÅ∏ÊäûËÇ¢</a><ul>
<li><a href="#16uiuxÂÆüË£Ö„ÅÆÈÅ∏ÊäûËÇ¢-Áî®Ë™ûËß£Ë™¨-uiux">üî∞ Áî®Ë™ûËß£Ë™¨ (UI/UX)</a></li>
</ul>
</li>
<li><a href="#17-Á∂ôÁ∂öÁöÑ„Ç§„É≥„ÉÜ„Ç∞„É¨„Éº„Ç∑„Éß„É≥-ci">17. Á∂ôÁ∂öÁöÑ„Ç§„É≥„ÉÜ„Ç∞„É¨„Éº„Ç∑„Éß„É≥ (CI)</a><ul>
<li><a href="#17Á∂ôÁ∂öÁöÑ„Ç§„É≥„ÉÜ„Ç∞„É¨„Éº„Ç∑„Éß„É≥-ci-Áî®Ë™ûËß£Ë™¨-cicd">üî∞ Áî®Ë™ûËß£Ë™¨ (CI/CD)</a></li>
<li><a href="#171-github-actions-„Å´„Çà„Çãci">17.1 GitHub Actions „Å´„Çà„ÇãCI</a></li>
<li><a href="#172-ci„Éë„Ç§„Éó„É©„Ç§„É≥„ÅÆÊßãÊàê">17.2 CI„Éë„Ç§„Éó„É©„Ç§„É≥„ÅÆÊßãÊàê</a></li>
<li><a href="#173-„ÉÜ„Çπ„ÉàËá™ÂãïÂåñ„Å®„Ç´„Éê„É¨„ÉÉ„Ç∏">17.3 „ÉÜ„Çπ„ÉàËá™ÂãïÂåñ„Å®„Ç´„Éê„É¨„ÉÉ„Ç∏</a></li>
<li><a href="#174-ciÁí∞Â¢É„ÅÆË®≠ÂÆö">17.4 CIÁí∞Â¢É„ÅÆË®≠ÂÆö</a></li>
</ul>
</li>
<li><a href="#18-„Åæ„Å®„ÇÅ">18. „Åæ„Å®„ÇÅ</a></li>
<li><a href="#19-‰ªäÂæå„ÅÆÊã°Âºµddd„Å∏„ÅÆÂ∏ÉÁü≥">19. ‰ªäÂæå„ÅÆÊã°Âºµ„ÉªDDD„Å∏„ÅÆÂ∏ÉÁü≥</a></li>
<li><a href="#20-„Éê„Éº„Ç∏„Éß„É≥Â±•Ê≠¥">20. „Éê„Éº„Ç∏„Éß„É≥Â±•Ê≠¥</a></li>
<li><a href="#„Åä„Çè„Çä„Å´">„Åä„Çè„Çä„Å´</a></li>
</ul>
<h2 id="01">01. „ÅØ„Åò„ÇÅ„Å´</h2>
<p>KOIKI-FW „ÅØ„ÄÅFastAPI „Å´„Çà„ÇãÂ†ÖÁâ¢„Åã„Å§Êã°ÂºµÂèØËÉΩ„Å™ Web „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÇíÊßãÁØâ„Åô„Çã„Åü„ÇÅ„ÅÆ„Ç®„É≥„Çø„Éº„Éó„É©„Ç§„Ç∫Âêë„Åë„ÉÜ„É≥„Éó„É¨„Éº„Éà„Éï„É¨„Éº„É†„ÉØ„Éº„ÇØ„Åß„Åô„ÄÇ</p>
<p>Êú¨„Éï„É¨„Éº„É†„ÉØ„Éº„ÇØ„ÅØ‰ª•‰∏ã„ÅÆ„Çà„ÅÜ„Å™ÁõÆÁöÑ„ÅßË®≠Ë®à„Åï„Çå„Å¶„ÅÑ„Åæ„ÅôÔºö</p>
<ul>
<li>„Ç®„É≥„Ç∏„Éã„Ç¢„ÅåÊ•≠Âãô„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÇíËøÖÈÄü„Å´Á´ã„Å°‰∏ä„Åí„Çâ„Çå„Çã <strong>ÈñãÁô∫Âü∫Áõ§„ÅÆÊèê‰æõ</strong></li>
<li>„Ç§„É≥„Éï„É©„Å®„É≠„Ç∏„ÉÉ„ÇØ„ÇíÊòéÁ¢∫„Å´ÂàÜÈõ¢„Åó„ÄÅ<strong>‰øùÂÆàÊÄß„ÉªÂÜçÂà©Áî®ÊÄß„Éª„ÉÜ„Çπ„ÉàÂÆπÊòìÊÄß</strong> „ÇíÂÆüÁèæ</li>
<li>ÈùûÂêåÊúüÂá¶ÁêÜ„ÇÑJWTË™çË®º„Å™„Å©„ÄÅ<strong>ÂÆüÂãôË¶Å‰ª∂„Å´Âç≥„Åó„ÅüÊ©üËÉΩ„É¢„Ç∏„É•„Éº„É´„ÅÆÊ®ôÊ∫ñÊê≠Ëºâ</strong></li>
<li>Â∞ÜÊù•ÁöÑ„Å™ DDDÔºà„Éâ„É°„Ç§„É≥ÈßÜÂãïË®≠Ë®àÔºâÂ∞éÂÖ•„ÇíË¶ñÈáé„Å´ÂÖ•„Çå„Åü„ÄÅÊã°ÂºµÂèØËÉΩ„Å™ÊßãÈÄ†</li>
</ul>
<p>KOIKI-FW v0.5.0 „Åß„ÅØ„ÄÅ„Éï„É¨„Éº„É†„ÉØ„Éº„ÇØÊ©üËÉΩ„Çí <code>libkoiki/</code> „Å´ÊòéÁ¢∫„Å´ÂàÜÈõ¢„Åó„ÄÅÈñãÁô∫ËÄÖ„Åå <code>/app</code> ‰ª•‰∏ã„Å´„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Êú¨‰Ωì„ÇíÂÆüË£Ö„Åß„Åç„ÇãÊßãÊàê„ÇíÁ∂≠ÊåÅ„Åó„Å™„Åå„Çâ„ÄÅ„Ç®„É≥„Çø„Éº„Éó„É©„Ç§„Ç∫Âêë„Åë‰æùÂ≠òÊÄßÁÆ°ÁêÜÊà¶Áï•„ÇíÂ∞éÂÖ•„Åó„ÄÅÂåÖÊã¨ÁöÑ„Å™„Çª„Ç≠„É•„É™„ÉÜ„Ç£„Ç¢„ÉÉ„Éó„Éá„Éº„Éà„ÇíÂÆüÊñΩ„Åó„Åæ„Åó„Åü„ÄÇ</p>
<hr />
<h3 id="_2">üî∞ Áî®Ë™ûËß£Ë™¨</h3>
<ul>
<li><strong>FastAPI</strong>: Python„ÅÆ„É¢„ÉÄ„É≥„Å™Web„Éï„É¨„Éº„É†„ÉØ„Éº„ÇØ„ÄÇÈ´ò„ÅÑ„Éë„Éï„Ç©„Éº„Éû„É≥„Çπ„Å®ÈñãÁô∫ÂäπÁéá„ÅåÁâπÂæ¥„ÄÇ</li>
<li><strong>SQLAlchemy</strong>: Python„ÅÆORMÔºàObject-Relational MapperÔºâ„É©„Ç§„Éñ„É©„É™„ÄÇ„Éá„Éº„Çø„Éô„Éº„ÇπÊìç‰Ωú„ÇíPython„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Å®„Åó„Å¶Êâ±„Åà„Çã„ÄÇ</li>
<li><strong>Pydantic</strong>: Python„ÅÆ„Éá„Éº„Çø„Éê„É™„Éá„Éº„Ç∑„Éß„É≥„É©„Ç§„Éñ„É©„É™„ÄÇÂûã„Éí„É≥„Éà„Å´Âü∫„Å•„Åç„Éá„Éº„Çø„ÅÆÊ§úË®º„ÇÑ„Ç∑„É™„Ç¢„É©„Ç§„Ç∫„ÇíË°å„ÅÜ„ÄÇ</li>
<li><strong>JWT (JSON Web Token)</strong>: Web„ÅßÂÆâÂÖ®„Å´ÊÉÖÂ†±„Çí„ÇÑ„ÇäÂèñ„Çä„Åô„Çã„Åü„ÇÅ„ÅÆ„Ç≥„É≥„Éë„ÇØ„Éà„Å™„Éà„Éº„ÇØ„É≥ÂΩ¢Âºè„ÄÇË™çË®º„Å´„Çà„ÅèÁî®„ÅÑ„Çâ„Çå„Çã„ÄÇ</li>
<li><strong>Celery</strong>: Python„Åß‰∫∫Ê∞ó„ÅÆÈùûÂêåÊúü„Çø„Çπ„ÇØ„Ç≠„É•„Éº/„Ç∏„Éß„Éñ„Ç≠„É•„Éº„ÄÇÊôÇÈñì„ÅÆ„Åã„Åã„ÇãÂá¶ÁêÜ„Çí„Éê„ÉÉ„ÇØ„Ç∞„É©„Ç¶„É≥„Éâ„ÅßÂÆüË°å„Åô„Çã„ÅÆ„Å´‰Ωø„ÅÜ„ÄÇ</li>
<li><strong>ÈùûÂêåÊúüÂá¶ÁêÜ</strong>: Âá¶ÁêÜ„ÇíÂæÖ„Åü„Åö„Å´Ë£è„ÅßÂêåÊôÇ„Å´ÂÆüË°å„Åô„Çã‰ªïÁµÑ„Åø„ÄÇ‰æãÔºöCelery „Å™„Å©„ÅÆ„Éê„ÉÉ„ÇØ„Ç∞„É©„Ç¶„É≥„ÉâÂá¶ÁêÜ„ÄÇ</li>
<li><strong>Redis</strong>: „É°„ÉÉ„Çª„Éº„Ç∏„Ç≠„É•„Éº„Å®„Åó„Å¶„ÇÇ‰Ωø„Åà„ÇãÈ´òÈÄü„Å™„Ç§„É≥„É°„É¢„É™„Éá„Éº„Çø„Çπ„Éà„Ç¢„ÄÇ</li>
<li><strong>DDD („Éâ„É°„Ç§„É≥ÈßÜÂãïË®≠Ë®à)</strong>: „Éì„Ç∏„Éç„Çπ„ÅÆÈñ¢ÂøÉ‰∫ãÔºà„Éâ„É°„Ç§„É≥Ôºâ„Çí‰∏≠ÂøÉ„Å´„ÇΩ„Éï„Éà„Ç¶„Çß„Ç¢„ÇíË®≠Ë®à„Åô„Çã„Ç¢„Éó„É≠„Éº„ÉÅ„ÄÇ</li>
</ul>
<h2 id="02">02. „Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£Ê¶ÇË¶Å</h2>
<p>Êú¨„Éï„É¨„Éº„É†„ÉØ„Éº„ÇØ„ÅØ„ÄÅÈñ¢ÂøÉ‰∫ã„ÅÆÂàÜÈõ¢ (Separation of Concerns) „ÇíÈáçË¶ñ„Åó„Åü„É¨„Ç§„É§„Éº„Éâ„Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£„ÇíÊé°Áî®„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>
<h3 id="21">2.1 „Éó„É≠„Ç∏„Çß„ÇØ„ÉàÊßãÈÄ†„Å®„É¨„Ç§„É§„Éº</h3>
<ul>
<li><strong>API„É¨„Ç§„É§„Éº</strong> (<code>app/routers/</code>, <code>libkoiki/api/v1/endpoints/</code>):<ul>
<li>HTTP„É™„ÇØ„Ç®„Çπ„Éà„ÅÆÂèó‰ø°„ÄÅ„É´„Éº„ÉÜ„Ç£„É≥„Ç∞„ÄÅÂÖ•Âäõ„Éê„É™„Éá„Éº„Ç∑„Éß„É≥ÔºàPydantic „Çπ„Ç≠„Éº„ÉûÁµåÁî±Ôºâ„ÄÅ„É¨„Çπ„Éù„É≥„ÇπÊï¥ÂΩ¢„ÄÇ</li>
<li>‰æùÂ≠òÊÄßÊ≥®ÂÖ•„ÇíÂà©Áî®„Åó„Å¶„Çµ„Éº„Éì„ÇπÂ±§„ÇíÂëº„Å≥Âá∫„Åô„ÄÇ</li>
<li>Ë™çË®º„ÉªË™çÂèØ„ÄÅ„É¨„Éº„Éà„É™„Éü„ÉÉ„Éà„ÅÆÈÅ©Áî®„ÄÇ</li>
</ul>
</li>
<li><strong>„Çµ„Éº„Éì„Çπ„É¨„Ç§„É§„Éº</strong> (<code>app/services/</code>, <code>libkoiki/services/</code>):<ul>
<li>„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅÆ„Ç≥„Ç¢„Å®„Å™„Çã„Éì„Ç∏„Éç„Çπ„É≠„Ç∏„ÉÉ„ÇØ„ÇíÂÆüË£Ö„ÄÇ</li>
<li>Ë§áÊï∞„ÅÆ„É™„Éù„Ç∏„Éà„É™„ÇíÁµÑ„ÅøÂêà„Çè„Åõ„Å¶„É¶„Éº„Çπ„Ç±„Éº„Çπ„ÇíÂÆüÁèæ„ÄÇ</li>
<li>„Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥ÁÆ°ÁêÜ„ÅÆË≤¨Âãô„ÇíÊåÅ„Å§„ÄÇ</li>
<li>APIÂ±§„ÇÑ‰ªñ„ÅÆ„Çµ„Éº„Éì„Çπ„Åã„ÇâÂà©Áî®„Åï„Çå„Çã„ÄÇ</li>
</ul>
</li>
<li><strong>„É™„Éù„Ç∏„Éà„É™„É¨„Ç§„É§„Éº</strong> (<code>app/repositories/</code>, <code>libkoiki/repositories/</code>):<ul>
<li>„Éá„Éº„ÇøÊ∞∏Á∂öÂåñÂ±§Ôºà„Éá„Éº„Çø„Éô„Éº„ÇπÔºâ„Å∏„ÅÆ„Ç¢„ÇØ„Çª„Çπ„ÇíÊäΩË±°Âåñ„ÄÇ</li>
<li>SQLAlchemy „Çí‰ΩøÁî®„Åó„Åü CRUD Êìç‰Ωú„ÇÑ„Ç´„Çπ„Çø„É†„ÇØ„Ç®„É™„ÅÆÂÆüË£Ö„ÄÇ</li>
<li>„Çµ„Éº„Éì„ÇπÂ±§„Åã„ÇâÂà©Áî®„Åï„Çå„Çã„ÄÇ</li>
</ul>
</li>
<li><strong>„É¢„Éá„É´„É¨„Ç§„É§„Éº</strong> (<code>app/models/</code>, <code>libkoiki/models/</code>, <code>app/schemas/</code>, <code>libkoiki/schemas/</code>):<ul>
<li><code>models/</code>: SQLAlchemy „ÇíÁî®„ÅÑ„Åü„Éá„Éº„Çø„Éô„Éº„Çπ„ÉÜ„Éº„Éñ„É´ÂÆöÁæ© (ORM „É¢„Éá„É´)„ÄÇ</li>
<li><code>schemas/</code>: Pydantic „ÇíÁî®„ÅÑ„Åü API „ÅÆ„É™„ÇØ„Ç®„Çπ„Éà/„É¨„Çπ„Éù„É≥„Çπ„Éá„Éº„ÇøÊßãÈÄ†ÂÆöÁæ©„ÄÅ„Åä„Çà„Å≥„Éê„É™„Éá„Éº„Ç∑„Éß„É≥„É´„Éº„É´„ÄÇ</li>
</ul>
</li>
<li><strong>„Ç≥„Ç¢„Éª„Ç§„É≥„Éï„É©„Çπ„Éà„É©„ÇØ„ÉÅ„É£„É¨„Ç§„É§„Éº</strong> (<code>libkoiki/core/</code>, <code>libkoiki/db/</code>, <code>libkoiki/tasks/</code>):<ul>
<li>Ë®≠ÂÆö (<code>config.py</code>)„ÄÅ„Çª„Ç≠„É•„É™„ÉÜ„Ç£ (<code>core/security.py</code>)„ÄÅ„Ç´„Çπ„Çø„É†‰æãÂ§ñ (<code>exceptions.py</code>)„ÄÅ„Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥ÁÆ°ÁêÜ (<code>transaction.py</code>)„ÄÅ„É≠„ÇÆ„É≥„Ç∞ (<code>logging.py</code>)„ÄÅ„Éá„Éº„Çø„Éô„Éº„ÇπÊé•Á∂öÁÆ°ÁêÜ„Å™„Å©„ÄÇ</li>
</ul>
</li>
</ul>
<h3 id="22">2.2 ‰æùÂ≠òÈñ¢‰øÇ„ÅÆÊµÅ„Çå</h3>
<p>‰ª•‰∏ã„Å´„ÄÅ‰∏ªË¶Å„Ç≥„É≥„Éù„Éº„Éç„É≥„ÉàÈñì„ÅÆ‰æùÂ≠òÈñ¢‰øÇ„ÅÆÊµÅ„Çå„Çí„ÉÜ„Ç≠„Çπ„Éà„Éô„Éº„Çπ„ÅßÁ§∫„Åó„Åæ„Åô„ÄÇ</p>
<pre><code>[Client / External System]
  |
  (HTTP Request)
  V
[API Layer (FastAPI Routers in app/ or libkoiki/api/v1/endpoints/)]
  |  -------------------------------------------------------&gt; [Authentication/Authorization (libkoiki/core/security.py)]
  |  -------------------------------------------------------&gt; [Configuration (libkoiki/core/config.py)]
  |  -------------------------------------------------------&gt; [Logging (libkoiki/core/logging.py)]
  |  -------------------------------------------------------&gt; [Monitoring (libkoiki/core/monitoring.py)]
  |
  (Calls Service, Uses Schemas)
  V
[Service Layer (Business Logic in app/services/ or libkoiki/services/)]
  |  -------------------------------------------------------&gt; [Configuration]
  |  -------------------------------------------------------&gt; [Logging]
  |  ---- (May Publish Events) -----------------------------&gt; [Message Queue (Redis via libkoiki/events/ - Optional)]
  |  ---- (May Dispatch Tasks) -----------------------------&gt; [Task Queue (Celery via libkoiki/tasks/)]
  |
  (Uses Repository, Uses Schemas for internal data structure)
  V
[Repository Layer (Data Access in app/repositories/ or libkoiki/repositories/)]
  |  -------------------------------------------------------&gt; [Configuration]
  |  -------------------------------------------------------&gt; [Logging]
  |
  (Interacts with DB, Uses DB Models)
  V
[Database (e.g., PostgreSQL, managed by libkoiki/db/)]
  ^
  | (Celery Worker may access DB via Repository/Service)
  |
[Async Task Workers (Celery in libkoiki/tasks/)]
  |
  (Uses Message Broker)
  V
[Message Broker (e.g., Redis, for Celery and optionally Events)]

Associated Data Structures:
- DB Models (SQLAlchemy in app/models/, libkoiki/models/) - Used by Repository Layer
- Data Schemas (Pydantic in app/schemas/, libkoiki/schemas/) - Used by API and Service Layers
</code></pre>
<ul>
<li><strong>‰æùÂ≠ò„ÅÆÊñπÂêë</strong>: Áü¢Âç∞„ÅØ‰æùÂ≠ò„ÅÆÊñπÂêë„ÇíÁ§∫„Åó„Åæ„Åô„ÄÇ‰æã„Åà„Å∞„ÄÅAPI„É¨„Ç§„É§„Éº„ÅØ„Çµ„Éº„Éì„Çπ„É¨„Ç§„É§„Éº„Å´‰æùÂ≠ò„Åó„Åæ„Åô„Åå„ÄÅ„Çµ„Éº„Éì„Çπ„É¨„Ç§„É§„Éº„ÅØAPI„É¨„Ç§„É§„Éº„ÇíÁü•„Çä„Åæ„Åõ„Çì„ÄÇ</li>
<li><strong>‰æùÂ≠òÊÄßÊ≥®ÂÖ• (DI)</strong>: FastAPI „ÅÆ <code>Depends</code> Ê©üËÉΩ„Å´„Çà„Çä„ÄÅ‰∏ä‰Ωç„É¨„Ç§„É§„Éº„ÅØ‰∏ã‰Ωç„É¨„Ç§„É§„Éº„ÅÆÂÖ∑‰ΩìÁöÑ„Å™ÂÆüË£Ö„Åß„ÅØ„Å™„Åè„ÄÅÊäΩË±°Ôºà„Åæ„Åü„ÅØ‰æùÂ≠òÊÄßËß£Ê±∫Èñ¢Êï∞Ôºâ„Å´‰æùÂ≠ò„Åó„Åæ„Åô„ÄÇ</li>
<li><strong>„Ç≥„Ç¢Ê©üËÉΩ</strong>: Ë™çË®º„ÄÅË®≠ÂÆö„ÄÅ„É≠„ÇÆ„É≥„Ç∞„ÄÅ„É¢„Éã„Çø„É™„É≥„Ç∞„Å®„ÅÑ„Å£„ÅüÊ®™Êñ≠ÁöÑ„Å™Ê©üËÉΩ„ÅØ„ÄÅÂêÑ„É¨„Ç§„É§„Éº„Åã„ÇâÂøÖË¶Å„Å´Âøú„Åò„Å¶Âà©Áî®„Åï„Çå„Åæ„Åô„ÄÇ</li>
</ul>
<hr />
<h2 id="03">03. „Éá„Ç£„É¨„ÇØ„Éà„É™ÊßãÊàê</h2>
<p>Êú¨„Éï„É¨„Éº„É†„ÉØ„Éº„ÇØ„ÅØ‰ª•‰∏ã„ÅÆ2Â±§„Å´ÂàÜ„Åã„Çå„ÅüÊßãÊàê„ÇíÊé®Â•®„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>
<ul>
<li><code>libkoiki/</code>: ÂÖ±ÈÄöÁöÑ„Å™„Éï„É¨„Éº„É†„ÉØ„Éº„ÇØ„É≠„Ç∏„ÉÉ„ÇØÔºàDI/Ë™çË®º/ÈùûÂêåÊúü/DBÂá¶ÁêÜ„Å™„Å©„ÄÅÂÜçÂà©Áî®ÂèØËÉΩ„Å™„Ç≥„É≥„Éù„Éº„Éç„É≥„ÉàÔºâ</li>
<li><code>app/</code>: „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆ„É´„Éº„ÉÜ„Ç£„É≥„Ç∞„ÉªUI/APIÂÆöÁæ©„Éª„Éâ„É°„Ç§„É≥ÂÆüË£Ö</li>
</ul>
<pre><code>„Éó„É≠„Ç∏„Çß„ÇØ„Éà„É´„Éº„Éà/
‚îú‚îÄ‚îÄ app/                     # „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆ„Ç≥„Éº„Éâ
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ api/                 # „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆDI„Å™„Å©
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dependencies.py
‚îÇ   ‚îú‚îÄ‚îÄ models/              # „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆDB„É¢„Éá„É´
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ todo_model.py
‚îÇ   ‚îú‚îÄ‚îÄ repositories/        # „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆ„É™„Éù„Ç∏„Éà„É™
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ todo_repository.py
‚îÇ   ‚îú‚îÄ‚îÄ routers/             # „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆAPI„É´„Éº„Çø„Éº
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ todo_router.py
‚îÇ   ‚îú‚îÄ‚îÄ schemas/             # „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆPydantic„Çπ„Ç≠„Éº„Éû
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ todo_schema.py
‚îÇ   ‚îú‚îÄ‚îÄ services/            # „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆ„Çµ„Éº„Éì„Çπ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ todo_service.py
‚îÇ   ‚îî‚îÄ‚îÄ main.py              # „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅÆ„Ç®„É≥„Éà„É™„Éù„Ç§„É≥„Éà
‚îú‚îÄ‚îÄ libkoiki/                # „Éï„É¨„Éº„É†„ÉØ„Éº„ÇØ„Ç≥„Ç¢„É©„Ç§„Éñ„É©„É™
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ api/                 # APIÂÖ±ÈÄö„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ v1/              # API„Éê„Éº„Ç∏„Éß„É≥1
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ endpoints/   # „Ç®„É≥„Éâ„Éù„Ç§„É≥„ÉàÂÆüË£Ö
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ auth.py  # Ë™çË®º„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà
‚îÇ   ‚îú‚îÄ‚îÄ core/                # „Ç≥„Ç¢„É¶„Éº„ÉÜ„Ç£„É™„ÉÜ„Ç£
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py        # Ë®≠ÂÆöÁÆ°ÁêÜ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dependencies.py  # ÂÖ±ÈÄöDI
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ error_handlers.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ exceptions.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ logging.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ middleware.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ monitoring.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rate_limiter.py  # „É¨„Éº„Éà„É™„Éü„ÉÉ„Éà
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ security.py      # JWTË™çË®º
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ transaction.py   # „Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥ÁÆ°ÁêÜ
‚îÇ   ‚îú‚îÄ‚îÄ db/                  # „Éá„Éº„Çø„Éô„Éº„ÇπÈñ¢ÈÄ£
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.py          # SQLAlchemy Base „Å®ÂÖ±ÈÄö„É¢„Éá„É´
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ session.py       # DB„Çª„ÉÉ„Ç∑„Éß„É≥ÁÆ°ÁêÜ
‚îÇ   ‚îú‚îÄ‚îÄ models/              # ÂÖ±ÈÄöDB„É¢„Éá„É´ (User, Role, Permission„Å™„Å©)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ associations.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ permission.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ role.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ user.py
‚îÇ   ‚îú‚îÄ‚îÄ repositories/        # ÂÖ±ÈÄö„É™„Éù„Ç∏„Éà„É™ (BaseRepository, UserRepository„Å™„Å©)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ user_repository.py
‚îÇ   ‚îú‚îÄ‚îÄ schemas/             # ÂÖ±ÈÄöPydantic„Çπ„Ç≠„Éº„Éû (User, Token„Å™„Å©)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ token.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ user.py
‚îÇ   ‚îú‚îÄ‚îÄ services/            # ÂÖ±ÈÄö„Çµ„Éº„Éì„Çπ (UserService„Å™„Å©)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ user_service.py
‚îÇ   ‚îú‚îÄ‚îÄ tasks/               # Celery„Çø„Çπ„ÇØÈñ¢ÈÄ£
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ celery_app.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ example_task.py
‚îÇ   ‚îî‚îÄ‚îÄ pyproject.toml       # libkoiki„ÅÆ„Éë„ÉÉ„Ç±„Éº„Ç∏ÊÉÖÂ†±
‚îú‚îÄ‚îÄ alembic/                 # DB„Éû„Ç§„Ç∞„É¨„Éº„Ç∑„Éß„É≥„Çπ„ÇØ„É™„Éó„Éà
‚îú‚îÄ‚îÄ tests/                   # „ÉÜ„Çπ„Éà„Ç≥„Éº„Éâ (unit, integration)
‚îú‚îÄ‚îÄ .env.example             # Áí∞Â¢ÉÂ§âÊï∞„Çµ„É≥„Éó„É´
‚îú‚îÄ‚îÄ .github/                 # GitHub ActionsË®≠ÂÆö
‚îÇ   ‚îî‚îÄ‚îÄ workflows/
‚îÇ       ‚îî‚îÄ‚îÄ ci.yml           # CI„Éë„Ç§„Éó„É©„Ç§„É≥ÂÆöÁæ©
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ Dockerfile
‚îî‚îÄ‚îÄ README.md
</code></pre>
<h3 id="31-libkoiki">3.1 libkoiki („Éï„É¨„Éº„É†„ÉØ„Éº„ÇØ„Ç≥„Ç¢)</h3>
<p><code>libkoiki/</code> „ÅØ„ÄÅ„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Ê®™Êñ≠ÁöÑ„Å´Âà©Áî®„Åï„Çå„ÇãÂÖ±ÈÄöÊ©üËÉΩ„ÇÑÂü∫Áõ§ÈÉ®ÂìÅ„ÇíÈÖçÁΩÆ„Åó„Åæ„Åô„ÄÇ„Åì„ÅÆÈÉ®ÂàÜ„ÅØÁã¨Á´ã„Åó„Åü Python „É©„Ç§„Éñ„É©„É™„Å®„Åó„Å¶ÁÆ°ÁêÜ„Åï„Çå„ÄÅ‰ªñ„ÅÆ„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Åß„ÇÇÂÜçÂà©Áî®„Åß„Åç„Åæ„Åô„ÄÇ</p>
<ul>
<li><code>libkoiki/core/</code>: Ë®≠ÂÆö„ÄÅ„É≠„ÇÆ„É≥„Ç∞„ÄÅ„Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞„ÄÅ„Éü„Éâ„É´„Ç¶„Çß„Ç¢„ÄÅ„Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥ÁÆ°ÁêÜ„ÄÅË™çË®º„Å™„Å©„ÄÇ</li>
<li><code>libkoiki/db/</code>: SQLAlchemy„ÅÆ„Éô„Éº„ÇπË®≠ÂÆö„ÄÅDB„Çª„ÉÉ„Ç∑„Éß„É≥ÁÆ°ÁêÜ„ÄÇ</li>
<li><code>libkoiki/models/</code>: Ê±éÁî®ÁöÑ„Å™ User, Role, Permission „Å™„Å©„ÅÆDB„É¢„Éá„É´„ÄÇ</li>
<li><code>libkoiki/schemas/</code>: User, Token „Å™„Å©„ÅÆÊ±éÁî®ÁöÑ„Å™Pydantic„Çπ„Ç≠„Éº„Éû„ÄÇ</li>
<li><code>libkoiki/repositories/</code>: <code>BaseRepository</code> „ÇÑ <code>UserRepository</code> „Å™„Å©„ÅÆÊ±éÁî®„É™„Éù„Ç∏„Éà„É™„ÄÇ</li>
<li><code>libkoiki/services/</code>: <code>UserService</code> „Å™„Å©„ÅÆÊ±éÁî®„Çµ„Éº„Éì„Çπ„ÄÇ</li>
<li><code>libkoiki/api/v1/endpoints/</code>: Ë™çË®º„Å™„Å©„ÅÆÂÖ±ÈÄö„Ç®„É≥„Éâ„Éù„Ç§„É≥„ÉàÂÆüË£Ö„ÄÇ</li>
<li><code>libkoiki/tasks/</code>: Celery„ÅÆÂü∫Êú¨Ë®≠ÂÆö„ÇÑÂÖ±ÈÄö„Çø„Çπ„ÇØ„ÄÇ</li>
</ul>
<h3 id="32-app">3.2 app („Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ)</h3>
<p><code>app/</code> „ÅØ„ÄÅÁâπÂÆö„ÅÆ„Éì„Ç∏„Éç„Çπ„Éâ„É°„Ç§„É≥„Å´ÁâπÂåñ„Åó„Åü„Ç≥„Éº„Éâ„ÇíÈÖçÁΩÆ„Åó„Åæ„Åô„ÄÇ‰æã„Åà„Å∞„ÄÅToDoÁÆ°ÁêÜ„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Åß„ÅÇ„Çå„Å∞„ÄÅToDo„Å´Èñ¢„Åô„Çã„É¢„Éá„É´„ÄÅ„Çπ„Ç≠„Éº„Éû„ÄÅ„É™„Éù„Ç∏„Éà„É™„ÄÅ„Çµ„Éº„Éì„Çπ„ÄÅ„É´„Éº„Çø„Éº„Å™„Å©„ÇíÂÆüË£Ö„Åó„Åæ„Åô„ÄÇ</p>
<ul>
<li><code>app/main.py</code>: FastAPI„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Ç§„É≥„Çπ„Çø„É≥„Çπ„ÅÆÁîüÊàê„ÄÅ<code>libkoiki</code>„ÅÆÊ©üËÉΩ„ÅÆÁµÑ„ÅøËæº„Åø„ÄÅ<code>app/</code>Âõ∫Êúâ„É´„Éº„Çø„Éº„ÅÆÁôªÈå≤„Å™„Å©„ÄÇ</li>
<li><code>app/routers/</code>: „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆAPI„Ç®„É≥„Éâ„Éù„Ç§„É≥„ÉàÂÆöÁæ©„ÄÇ</li>
<li><code>app/services/</code>: „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆ„Éì„Ç∏„Éç„Çπ„É≠„Ç∏„ÉÉ„ÇØ„ÄÇ</li>
<li><code>app/repositories/</code>: „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆ„Éá„Éº„Çø„Ç¢„ÇØ„Çª„Çπ„É≠„Ç∏„ÉÉ„ÇØ„ÄÇ</li>
<li><code>app/models/</code>, <code>app/schemas/</code>: „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆ„Éá„Éº„ÇøÊßãÈÄ†ÂÆöÁæ©„ÄÇ</li>
</ul>
<p>„Åì„ÅÆÊßãÊàê„Å´„Çà„Çä„ÄÅ<code>libkoiki</code> „Çí pip install ÂèØËÉΩ„Å™„Éï„É¨„Éº„É†„ÉØ„Éº„ÇØ„Å®„Åó„Å¶Â§ñÈÉ®Êèê‰æõ„Åó„Å™„Åå„Çâ„ÄÅ
<code>app/</code> ÂÅ¥„Åß„ÅØÂÄãÂà•„ÅÆ„É¶„Éº„Çπ„Ç±„Éº„Çπ„ÇÑ„Éâ„É°„Ç§„É≥„Å´ÁâπÂåñ„Åó„ÅüÈñãÁô∫„ÇíÈÄ≤„ÇÅ„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ</p>
<hr />
<h2 id="04-configdi">04. Ë®≠ÂÆöÔºàConfigÔºâ„Å®‰æùÂ≠òÊÄßÊ≥®ÂÖ•ÔºàDIÔºâ</h2>
<p>„Åì„ÅÆÁ´†„Åß„ÅØ„ÄÅ„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÇíÊüîËªü„Å´ÊßãÊàê„Åô„Çã„ÄåË®≠ÂÆöÁÆ°ÁêÜ„Äç„Å®„ÄÅÂêÑÂá¶ÁêÜ„ÅßÂøÖË¶Å„Å™Ê©üËÉΩ„ÇíÁ∞°ÊΩî„Å´‰Ωø„Åà„Çã„Çà„ÅÜ„Å´„Åô„Çã„Äå‰æùÂ≠òÊÄßÊ≥®ÂÖ•ÔºàDIÔºâ„Äç„ÅÆ‰ªïÁµÑ„Åø„Å´„Å§„ÅÑ„Å¶Ë™¨Êòé„Åó„Åæ„Åô„ÄÇ</p>
<h3 id="_3">üî∞ Áî®Ë™ûËß£Ë™¨</h3>
<ul>
<li><strong>Ë®≠ÂÆöÔºàConfigÔºâ</strong>: „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÇíÂÆüË°å„Åô„ÇãÈöõ„Å´„ÄÅÊé•Á∂ö„Åô„Çã„Éá„Éº„Çø„Éô„Éº„Çπ„ÇÑÂ§ñÈÉ®„Çµ„Éº„Éì„Çπ„ÅÆÊÉÖÂ†±„Çí <code>.env</code> „Éï„Ç°„Ç§„É´„Å™„Å©„Åã„ÇâÂãïÁöÑ„Å´Ë™≠„ÅøËæº„ÇÅ„Çã„Çà„ÅÜ„Å´„Åô„Çã‰ªïÁµÑ„Åø„ÄÇ</li>
<li><strong>‰æùÂ≠òÊÄßÊ≥®ÂÖ•ÔºàDI: Dependency InjectionÔºâ</strong>: „ÅÇ„Çã„ÇØ„É©„Çπ„ÇÑÈñ¢Êï∞„ÅåÂøÖË¶Å„Å®„Åô„ÇãÊ©üËÉΩÔºà‰æãÔºöDBÊé•Á∂ö„ÇÑ„Çµ„Éº„Éì„ÇπÔºâ„Çí„ÄåÂ§ñ„Åã„ÇâÊ∏°„Åô„Äç„Åì„Å®„Åß„ÄÅÂÜçÂà©Áî®ÊÄß„Å®„ÉÜ„Çπ„Éà„ÅÆÂÆπÊòì„Åï„ÇíÈ´ò„ÇÅ„ÇãË®≠Ë®àÊâãÊ≥ï„ÄÇ</li>
</ul>
<h3 id="41-configpy">4.1 Ë®≠ÂÆöÁÆ°ÁêÜ (config.py)</h3>
<p>„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅÆË®≠ÂÆö„ÅØ <code>pydantic</code> „ÅÆ <code>BaseSettings</code> „Çí‰ΩøÁî®„Åó„Å¶ÁÆ°ÁêÜ„Åó„Åæ„Åô„ÄÇÁí∞Â¢ÉÂ§âÊï∞„ÇÑ <code>.env</code> „Éï„Ç°„Ç§„É´„Åã„ÇâÂÄ§„ÇíË™≠„ÅøËæº„Åø„ÄÅÂûãÊ§úË®º„ÇÇË°å„ÅÑ„Åæ„Åô„ÄÇ</p>
<p><strong><code>libkoiki/core/config.py</code> „ÅÆÂÆüË£Ö‰æã:</strong></p>
<pre><code class="language-python"># libkoiki/core/config.py
import os
from pydantic import BaseSettings, PostgresDsn, AnyHttpUrl, validator
from typing import Optional, Dict, Any, List, Union
from functools import lru_cache

class Settings(BaseSettings):
    # --- App ---
    APP_NAME: str = &quot;KOIKI-FW&quot;
    APP_ENV: str = &quot;development&quot; # ‰æã: development, staging, production
    DEBUG: bool = False
    SECRET_KEY: str # ‚òÖÊú¨Áï™„Åß„ÅØÂøÖ„ÅöÁí∞Â¢ÉÂ§âÊï∞„ÅßË®≠ÂÆö‚òÖ
    API_PREFIX: str = &quot;/api/v1&quot;

    # --- JWT ---
    ACCESS_TOKEN_EXPIRE_MINUTES: int = 60 * 24 # 1 day
    JWT_ALGORITHM: str = &quot;HS256&quot;
    JWT_SECRET: str # JWTÁΩ≤Âêç„Å´‰ΩøÁî®„Åô„ÇãÈçµ„ÄÇSECRET_KEY„Å®Âêå„ÅòÂÄ§„Çí‰Ωø„ÅÜ„Åì„Å®„ÅåÂ§ö„ÅÑ

    # --- Database ---
    POSTGRES_USER: str = &quot;user&quot;
    POSTGRES_PASSWORD: str = &quot;password&quot;
    POSTGRES_HOST: str = &quot;localhost&quot;
    POSTGRES_PORT: str = &quot;5432&quot;
    POSTGRES_DB: str = &quot;koiki_db&quot;
    DATABASE_URL: Optional[PostgresDsn] = None
    DB_ECHO: bool = False
    DB_POOL_SIZE: int = 10
    DB_MAX_OVERFLOW: int = 20

    @validator(&quot;DATABASE_URL&quot;, pre=True)
    def assemble_db_url(cls, v: Optional[str], values: Dict[str, Any]) -&gt; str:
        if isinstance(v, str):
            return v
        return str(PostgresDsn.build(
            scheme=&quot;postgresql+asyncpg&quot;, # ÈùûÂêåÊúü„Éâ„É©„Ç§„Éê
            user=values.get(&quot;POSTGRES_USER&quot;),
            password=values.get(&quot;POSTGRES_PASSWORD&quot;),
            host=values.get(&quot;POSTGRES_HOST&quot;),
            port=values.get(&quot;POSTGRES_PORT&quot;),
            path=f&quot;/{values.get('POSTGRES_DB') or ''}&quot;,
        ))

    # --- Redis ---
    REDIS_HOST: str = &quot;localhost&quot;
    REDIS_PORT: int = 6379
    REDIS_PASSWORD: Optional[str] = None
    REDIS_DB: int = 0
    REDIS_URL: Optional[str] = None

    @validator(&quot;REDIS_URL&quot;, pre=True)
    def assemble_redis_url(cls, v: Optional[str], values: Dict[str, Any]) -&gt; str:
        if isinstance(v, str): return v
        password_part = f&quot;:{values.get('REDIS_PASSWORD')}@&quot; if values.get('REDIS_PASSWORD') else &quot;&quot;
        return f&quot;redis://{password_part}{values.get('REDIS_HOST')}:{values.get('REDIS_PORT')}/{values.get('REDIS_DB')}&quot;

    # --- Celery ---
    CELERY_BROKER_URL: Optional[str] = None
    CELERY_RESULT_BACKEND: Optional[str] = None

    # --- CORS ---
    BACKEND_CORS_ORIGINS: List[str] = [&quot;http://localhost:3000&quot;, &quot;http://localhost:8080&quot;]

    @validator(&quot;BACKEND_CORS_ORIGINS&quot;, pre=True)
    def assemble_cors_origins(cls, v: Union[str, List[str]]) -&gt; List[str]:
        if isinstance(v, str) and not v.startswith(&quot;[&quot;):
            return [i.strip() for i in v.split(&quot;,&quot;)]
        elif isinstance(v, list):
            return v
        raise ValueError(v)

    # --- Rate Limiting (slowapi) ---
    RATE_LIMIT_ENABLED: bool = True
    RATE_LIMIT_DEFAULT: str = &quot;100/minute&quot;
    RATE_LIMIT_STRATEGY: str = &quot;fixed-window&quot;

    # --- Logging ---
    LOG_LEVEL: str = &quot;INFO&quot;

    class Config:
        env_file = os.getenv(&quot;ENV_FILE&quot;, &quot;.env&quot;) # Áí∞Â¢ÉÂ§âÊï∞ `ENV_FILE` „Åß .env „Éï„Ç°„Ç§„É´„ÇíÊåáÂÆöÂèØËÉΩ
        env_file_encoding = 'utf-8'
        case_sensitive = True
        # .env „Éï„Ç°„Ç§„É´„ÅåË¶ã„Å§„Åã„Çâ„Å™„Åè„Å¶„ÇÇ„Ç®„É©„Éº„Å´„Åó„Å™„ÅÑ
        # ÂøÖÈ†àÈ†ÖÁõÆ„ÅØ Settings „ÇØ„É©„Çπ„ÅÆ„Éï„Ç£„Éº„É´„ÉâÂÆöÁæ©„ÅßÂûã„Éí„É≥„Éà„ÅÆ„ÅøÔºà„Éá„Éï„Ç©„É´„ÉàÂÄ§„Å™„ÅóÔºâ„Å´„Åô„Çã„Åì„Å®„ÅßÂØæÂøú
        # ‰æã: SECRET_KEY: str („Éá„Éï„Ç©„É´„ÉàÂÄ§„Å™„Åó) -&gt; Áí∞Â¢ÉÂ§âÊï∞„Åæ„Åü„ÅØ.env„Å´„Å™„ÅÑ„Å®Ëµ∑ÂãïÊôÇ„Ç®„É©„Éº
        # env_ignore_missing = True # Python-dotenv v1.0.0+

@lru_cache() # Ë®≠ÂÆö„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Çí„Ç≠„É£„ÉÉ„Ç∑„É•„Åó„Å¶ÂÜçÂà©Áî®
def get_settings() -&gt; Settings:
    return Settings()

# „Ç∞„É≠„Éº„Éê„É´„Ç§„É≥„Çπ„Çø„É≥„Çπ„ÅÆ‰ΩúÊàê
settings = get_settings()
</code></pre>
<p><strong>Áí∞Â¢ÉË®≠ÂÆö„ÅÆÂÑ™ÂÖàÈ†Ü‰Ωç:</strong>
1. OSÁí∞Â¢ÉÂ§âÊï∞
2. <code>.env</code> „Éï„Ç°„Ç§„É´Ôºà<code>ENV_FILE</code>„ÅßÊåáÂÆö„Åï„Çå„Åü„ÇÇ„ÅÆ„ÄÅ„Åæ„Åü„ÅØ„Éá„Éï„Ç©„É´„Éà„ÅÆ <code>.env</code>Ôºâ
3. <code>Settings</code> „ÇØ„É©„Çπ„ÅÆ„Éï„Ç£„Éº„É´„Éâ„ÅßÂÆöÁæ©„Åï„Çå„Åü„Éá„Éï„Ç©„É´„ÉàÂÄ§</p>
<p><strong>„Ç∑„Éº„ÇØ„É¨„ÉÉ„ÉàÁÆ°ÁêÜ:</strong>
<code>SECRET_KEY</code> „ÇÑÊú¨Áï™DB„ÅÆ„Éë„Çπ„ÉØ„Éº„Éâ„Å™„Å©„ÅÆÊ©üÂØÜÊÉÖÂ†±„ÅØ„ÄÅ<code>.env</code> „Éï„Ç°„Ç§„É´„Å´Áõ¥Êé•Ë®òËø∞„Åõ„Åö„ÄÅHashiCorp Vault, AWS Secrets Manager „Å™„Å©„ÅÆ„Ç∑„Éº„ÇØ„É¨„ÉÉ„ÉàÁÆ°ÁêÜ„Çµ„Éº„Éì„Çπ„ÇÑ„ÄÅCI/CD„Éë„Ç§„Éó„É©„Ç§„É≥„ÅÆÁí∞Â¢ÉÂ§âÊï∞„Å®„Åó„Å¶ÁÆ°ÁêÜ„Åô„Çã„Åì„Å®„Çí„ÅäÂãß„ÇÅ„Åó„Åæ„Åô„ÄÇ</p>
<h3 id="42-dependenciespy">4.2 ‰æùÂ≠òÊÄßÊ≥®ÂÖ• (dependencies.py)</h3>
<p>FastAPI „ÅÆ <code>Depends</code> „ÇíÊ¥ªÁî®„Åó„ÄÅ„Ç≥„É≥„Éù„Éº„Éç„É≥„ÉàÈñì„ÅÆ‰æùÂ≠òÈñ¢‰øÇ„ÇíËß£Ê±∫„Åó„Åæ„Åô„ÄÇ„Åì„Çå„Å´„Çà„Çä„ÄÅ„Ç≥„Éº„Éâ„ÅÆÂÜçÂà©Áî®ÊÄß„ÇÑ„ÉÜ„Çπ„ÉàÂÆπÊòìÊÄß„ÅåÂêë‰∏ä„Åó„Åæ„Åô„ÄÇ</p>
<p><strong><code>libkoiki/core/dependencies.py</code> „ÅÆÂÆüË£Ö‰æã:</strong></p>
<pre><code class="language-python"># libkoiki/core/dependencies.py
from typing import Annotated
from fastapi import Depends
from sqlalchemy.ext.asyncio import AsyncSession

# session.py„Åã„ÇâÂÆüË£ÖÊ∏à„Åø„ÅÆget_dbÈñ¢Êï∞„Çí„Ç§„É≥„Éù„Éº„Éà
from libkoiki.db.session import get_db
from libkoiki.services.user_service import UserService
from libkoiki.repositories.user_repository import UserRepository

# „Éá„Éº„Çø„Éô„Éº„Çπ„Çª„ÉÉ„Ç∑„Éß„É≥„ÅÆ‰æùÂ≠òÊÄß„ÅØsession.py„Åã„ÇâÁõ¥Êé•„Ç§„É≥„Éù„Éº„Éà
DBSessionDep = Annotated[AsyncSession, Depends(get_db)]

# UserService „ÅÆ‰æùÂ≠òÊÄß
async def get_user_service(db: AsyncSession = Depends(get_db)) -&gt; UserService:
    &quot;&quot;&quot;
    UserService „Ç§„É≥„Çπ„Çø„É≥„Çπ„ÇíÊèê‰æõ
    &quot;&quot;&quot;
    repository = UserRepository()
    repository.set_session(db)
    return UserService(repository)

# ‰æùÂ≠òÊÄßÊ≥®ÂÖ•Áî®„ÅÆ„Çø„Ç§„Éó„Ç®„Ç§„É™„Ç¢„Çπ
UserServiceDep = Annotated[UserService, Depends(get_user_service)]

# Ë™çË®ºÈñ¢ÈÄ£„ÅÆ‰æùÂ≠òÊÄß„ÅØsecurity.py„ÅßÂÆöÁæ©„Åï„Çå„Å¶„ÅÑ„Åæ„Åô
</code></pre>
<p><strong><code>libkoiki/core/security.py</code> „ÅÆË™çË®ºÈñ¢ÈÄ£‰æùÂ≠òÊÄß:</strong></p>
<pre><code class="language-python"># libkoiki/core/security.py (‰∏ÄÈÉ®ÊäúÁ≤ã)
from fastapi import Depends, HTTPException, status
from fastapi.security import OAuth2PasswordBearer
from sqlalchemy.ext.asyncio import AsyncSession
from typing import Annotated

from libkoiki.core.config import settings
from libkoiki.db.session import get_db
from libkoiki.models.user import UserModel

# OAuth2„Çπ„Ç≠„Éº„É†
oauth2_scheme = OAuth2PasswordBearer(tokenUrl=f&quot;{settings.API_PREFIX}/auth/login&quot;)

# JWTË™çË®º„ÅßÁèæÂú®„ÅÆ„É¶„Éº„Ç∂„Éº„ÇíÂèñÂæó
async def get_current_user_from_token(
    token: Annotated[str, Depends(oauth2_scheme)],
    db: Annotated[AsyncSession, Depends(get_db)]
) -&gt; UserModel:
    # ÂÆüË£ÖË©≥Á¥∞„ÅØÁúÅÁï•Ôºà8.1 JWTË™çË®º„ÅÆÂÆüË£Ö„ÇíÂèÇÁÖßÔºâ
    ...

# Ë™çË®ºÊ∏à„Åø„É¶„Éº„Ç∂„Éº„ÅÆ„Åø„Ç¢„ÇØ„Çª„ÇπÂèØËÉΩ
async def get_current_active_user(
    current_user: Annotated[UserModel, Depends(get_current_user_from_token)]
) -&gt; UserModel:
    if not current_user.is_active:
        raise HTTPException(status_code=status.HTTP_400_BAD_REQUEST, detail=&quot;Inactive user&quot;)
    return current_user

# ÁÆ°ÁêÜËÄÖ„É¶„Éº„Ç∂„Éº„ÅÆ„Åø„Ç¢„ÇØ„Çª„ÇπÂèØËÉΩ
async def get_current_active_superuser(
    current_user: Annotated[UserModel, Depends(get_current_active_user)]
) -&gt; UserModel:
    if not current_user.is_superuser:
        raise HTTPException(
            status_code=status.HTTP_403_FORBIDDEN,
            detail=&quot;The user doesn't have enough privileges&quot;
        )
    return current_user

# ‰æùÂ≠òÊÄßÊ≥®ÂÖ•Áî®„ÅÆ„Çø„Ç§„Éó„Ç®„Ç§„É™„Ç¢„Çπ
CurrentUserDep = Annotated[UserModel, Depends(get_current_user_from_token)]
ActiveUserDep = Annotated[UserModel, Depends(get_current_active_user)]
SuperUserDep = Annotated[UserModel, Depends(get_current_active_superuser)]
</code></pre>
<p><strong><code>libkoiki/core/rate_limiter.py</code> „ÅÆ„É¨„Éº„Éà„É™„Éü„ÉÉ„ÉàË®≠ÂÆö:</strong></p>
<pre><code class="language-python"># libkoiki/core/rate_limiter.py
from slowapi import Limiter
from slowapi.util import get_remote_address
from libkoiki.core.config import settings

# „É¨„Éº„Éà„É™„Éü„ÉÉ„Çø„Éº„ÅÆ„Ç∞„É≠„Éº„Éê„É´„Ç§„É≥„Çπ„Çø„É≥„Çπ
limiter = Limiter(
    key_func=get_remote_address,
    default_limits=[settings.RATE_LIMIT_DEFAULT],
    enabled=settings.RATE_LIMIT_ENABLED,
    strategy=settings.RATE_LIMIT_STRATEGY
)

# „Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà„Åß„ÅÆ‰ΩøÁî®‰æã:
# @router.post(&quot;/&quot;)
# @limiter.limit(&quot;5/minute&quot;)
# async def create_item(...):
#    ...
</code></pre>
<p>FastAPI„ÅÆDI„Ç∑„Çπ„ÉÜ„É†„ÅØ„ÄÅ„Ç®„É≥„Éâ„Éù„Ç§„É≥„ÉàÈñ¢Êï∞„ÅÆ„Ç∑„Ç∞„Éç„ÉÅ„É£„Åß <code>Depends</code> „Çí‰ΩøÁî®„Åó„Å¶‰æùÂ≠òÊÄß„ÇíÂÆ£Ë®Ä„Åô„Çã„Å®„ÄÅFastAPI„Åå„Åù„ÅÆ‰æùÂ≠òÊÄßÔºàÈñ¢Êï∞„ÇÑ„ÇØ„É©„ÇπÔºâ„ÇíÂÆüË°å„Åæ„Åü„ÅØËß£Ê±∫„Åó„ÄÅÁµêÊûú„Çí„Ç®„É≥„Éâ„Éù„Ç§„É≥„ÉàÈñ¢Êï∞„Å´Ê≥®ÂÖ•„Åó„Åæ„Åô„ÄÇ„Åì„Çå„Å´„Çà„Çä„ÄÅÂêÑ„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà„ÅÆÁñéÁµêÂêà„ÅåÂÆüÁèæ„Åó„ÄÅ„ÉÜ„Çπ„Éà„ÅÆÂÆπÊòìÊÄß„ÇÇÂêë‰∏ä„Åó„Åæ„Åô„ÄÇ</p>
<hr />
<h2 id="05">05. „É¢„Éá„É´ &amp; „Çπ„Ç≠„Éº„ÉûÂ±§</h2>
<p>„Åì„Åì„Åß„ÅØ„ÄÅ„Éá„Éº„Çø„Éô„Éº„Çπ„Å®„ÅÆ„ÇÑ„ÇäÂèñ„Çä„ÇíË°å„ÅÜ <strong>„É¢„Éá„É´ÔºàModelÔºâ</strong> „Å®„ÄÅ„ÇØ„É©„Ç§„Ç¢„É≥„Éà„Å®„ÅÆ„Éá„Éº„ÇøÈÄÅÂèó‰ø°„ÇíÂÆöÁæ©„Åô„Çã <strong>„Çπ„Ç≠„Éº„ÉûÔºàSchemaÔºâ</strong> „Å´„Å§„ÅÑ„Å¶Ë™¨Êòé„Åó„Åæ„Åô„ÄÇ</p>
<h3 id="_4">üî∞ Áî®Ë™ûËß£Ë™¨</h3>
<ul>
<li><strong>„É¢„Éá„É´ÔºàModelÔºâ</strong>: Python „ÅßÂÆöÁæ©„Åó„Åü„ÇØ„É©„Çπ„Å®„ÄÅ„Éá„Éº„Çø„Éô„Éº„Çπ„ÅÆ„ÉÜ„Éº„Éñ„É´ÊßãÈÄ†„Çí„Éû„ÉÉ„Éî„É≥„Ç∞„Åô„Çã‰ªïÁµÑ„Åø„Åß„ÅôÔºàORM: Object Relational MappingÔºâ„ÄÇFastAPI „Åß„ÅØ SQLAlchemy „Çí‰ΩøÁî®„Åó„Åæ„Åô„ÄÇ</li>
<li><strong>„Çπ„Ç≠„Éº„ÉûÔºàSchemaÔºâ</strong>: API „ÇíÈÄö„Åò„Å¶„ÇÑ„ÇäÂèñ„Çä„Åï„Çå„Çã„Éá„Éº„Çø„ÅÆÂΩ¢Âºè„ÇíÂÆöÁæ©„Åô„Çã„ÇÇ„ÅÆ„Åß„ÄÅ<code>pydantic</code> „É¢„Éá„É´„Çí‰Ωø„Å£„Å¶Âûã„ÉÅ„Çß„ÉÉ„ÇØ„Éª„Éê„É™„Éá„Éº„Ç∑„Éß„É≥„ÅåË°å„Åà„Åæ„Åô„ÄÇ</li>
</ul>
<p>„É¢„Éá„É´„ÅØ„Äå‰øùÂ≠òÂΩ¢Âºè„Äç„ÄÅ„Çπ„Ç≠„Éº„Éû„ÅØ„ÄåÈÄö‰ø°ÂΩ¢Âºè„Äç„Å®Êçâ„Åà„Çã„Å®ÁêÜËß£„Åó„ÇÑ„Åô„ÅÑ„Åß„Åô„ÄÇ</p>
<h3 id="51-sqlalchemy">5.1 „Éá„Éº„Çø„Éô„Éº„Çπ„É¢„Éá„É´ (SQLAlchemy)</h3>
<p>SQLAlchemy„ÅÆDeclarative System„Çí‰ΩøÁî®„Åó„Å¶DB„ÉÜ„Éº„Éñ„É´„ÇíPython„ÇØ„É©„Çπ„Å®„Åó„Å¶ÂÆöÁæ©„Åó„Åæ„Åô„ÄÇ
ÂÖ±ÈÄö„Ç´„É©„É†Ôºàid, created_at, updated_atÔºâ„ÇíÊåÅ„Å§„Éô„Éº„Çπ„É¢„Éá„É´„ÇíÂÆöÁæ©„Åô„Çã„Å®‰æøÂà©„Åß„Åô„ÄÇ</p>
<p><strong><code>libkoiki/db/base.py</code> (ÂÖ±ÈÄö„Éô„Éº„Çπ„É¢„Éá„É´):</strong></p>
<pre><code class="language-python"># libkoiki/db/base.py
from sqlalchemy.orm import declarative_base, declared_attr
from sqlalchemy import Column, Integer, DateTime, func
from typing import Any

class CustomBase:
    @declared_attr
    def __tablename__(cls) -&gt; str:
        import re
        return re.sub(r'(?&lt;!^)(?=[A-Z])', '_', cls.__name__).lower().replace(&quot;_model&quot;, &quot;&quot;)

    id: Any = Column(Integer, primary_key=True, index=True)
    created_at: Any = Column(DateTime(timezone=True), server_default=func.now())
    updated_at: Any = Column(DateTime(timezone=True), server_default=func.now(), onupdate=func.now())

Base = declarative_base(cls=CustomBase)
</code></pre>
<p><strong><code>libkoiki/models/user.py</code> (UserModel‰æã):</strong></p>
<pre><code class="language-python"># libkoiki/models/user.py
from sqlalchemy import Column, String, Boolean, Integer, ForeignKey
from sqlalchemy.orm import relationship
from libkoiki.db.base import Base
# from libkoiki.models.associations import user_roles # Â§öÂØæÂ§öÈñ¢ÈÄ£„ÉÜ„Éº„Éñ„É´

class UserModel(Base):
    # __tablename__ = &quot;users&quot; # CustomBase„ÅßËá™ÂãïË®≠ÂÆö„Åï„Çå„Çã„ÅÆ„Åß‰∏çË¶Å„Å™Â†¥Âêà„ÇÇ„ÅÇ„Çã

    email = Column(String, unique=True, index=True, nullable=False)
    hashed_password = Column(String, nullable=False)
    full_name = Column(String, index=True, nullable=True)
    is_active = Column(Boolean, default=True)
    is_superuser = Column(Boolean, default=False)

    # roles = relationship(&quot;RoleModel&quot;, secondary=user_roles, back_populates=&quot;users&quot;)
    # todos = relationship(&quot;TodoModel&quot;, back_populates=&quot;owner&quot;) # „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„É¢„Éá„É´„Å®„ÅÆÈñ¢ÈÄ£
</code></pre>
<p>(RoleModel, PermissionModel, associations.py „Å™„Å©„ÇÇÂêåÊßò„Å´ <code>libkoiki/models/</code> „Å´ÂÆöÁæ©)</p>
<p>„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆ„É¢„Éá„É´ (‰æã: <code>TodoModel</code>) „ÅØ <code>app/models/</code> „Å´ÈÖçÁΩÆ„Åó„Åæ„Åô (Ë©≥Á¥∞„ÅØ <a href="#10-„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥ÂÆüË£Ö‰æã„Å®Ëµ∑ÂãïÊñπÊ≥ï-app">10. „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥ÂÆüË£Ö‰æã„Å®Ëµ∑ÂãïÊñπÊ≥ï (app/)</a> „ÇíÂèÇÁÖß)„ÄÇ</p>
<h3 id="52-api-pydantic">5.2 API„Çπ„Ç≠„Éº„Éû (Pydantic)</h3>
<p>Pydantic„É¢„Éá„É´„Çí‰ΩøÁî®„Åó„Å¶API„ÅÆ„É™„ÇØ„Ç®„Çπ„Éà/„É¨„Çπ„Éù„É≥„Çπ„ÅÆ„Éá„Éº„ÇøÊßãÈÄ†„Å®„Éê„É™„Éá„Éº„Ç∑„Éß„É≥„É´„Éº„É´„ÇíÂÆöÁæ©„Åó„Åæ„Åô„ÄÇ</p>
<p><strong><code>libkoiki/schemas/user.py</code> (User„Çπ„Ç≠„Éº„Éû‰æã):</strong></p>
<pre><code class="language-python"># libkoiki/schemas/user.py
from pydantic import BaseModel, EmailStr, Field
from typing import Optional, List
from datetime import datetime

# --- Base Schemas ---
class UserBase(BaseModel):
    email: EmailStr
    full_name: Optional[str] = None
    is_active: bool = True

# --- Request Schemas ---
class UserCreate(UserBase):
    password: str = Field(..., min_length=8) # „Éë„Çπ„ÉØ„Éº„Éâ„Éù„É™„Ç∑„Éº„ÅØ„Çµ„Éº„Éì„ÇπÂ±§„Åß„ÇÇÊ§úË®º

class UserUpdate(BaseModel):
    email: Optional[EmailStr] = None
    full_name: Optional[str] = None
    is_active: Optional[bool] = None
    password: Optional[str] = Field(None, min_length=8)

# --- Response Schemas ---
class RoleResponseSimple(BaseModel): # UserResponseÂÜÖ„Åß‰ΩøÁî®
     id: int
     name: str
     class Config:
         orm_mode = True

class UserResponse(UserBase):
    id: int
    is_superuser: bool
    created_at: datetime
    updated_at: datetime
    # roles: List[RoleResponseSimple] = [] # RBAC„ÇíÊúâÂäπ„Å´„Åô„ÇãÂ†¥Âêà

    class Config:
        orm_mode = True # SQLAlchemy„É¢„Éá„É´„Åã„ÇâPydantic„É¢„Éá„É´„Å∏„ÅÆÂ§âÊèõ„ÇíË®±ÂèØ
</code></pre>
<p><strong><code>libkoiki/schemas/token.py</code> (Ë™çË®º„Éà„Éº„ÇØ„É≥„Çπ„Ç≠„Éº„Éû):</strong></p>
<pre><code class="language-python"># libkoiki/schemas/token.py
from pydantic import BaseModel
from typing import Optional
from datetime import datetime

class Token(BaseModel):
    &quot;&quot;&quot;
    OAuth2ÂΩ¢Âºè„ÅÆ„Éà„Éº„ÇØ„É≥„É¨„Çπ„Éù„É≥„Çπ
    &quot;&quot;&quot;
    access_token: str
    token_type: str

class TokenPayload(BaseModel):
    &quot;&quot;&quot;
    JWT„Éà„Éº„ÇØ„É≥„ÅÆ„Éö„Ç§„É≠„Éº„Éâ
    &quot;&quot;&quot;
    sub: Optional[str] = None  # user_id (ÊñáÂ≠óÂàóÂûã„Åß‰øùÂ≠ò)
    exp: Optional[int] = None  # UNIX timestamp
</code></pre>
<p>„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆ„Çπ„Ç≠„Éº„Éû (‰æã: <code>TodoSchema</code>) „ÅØ <code>app/schemas/</code> „Å´ÈÖçÁΩÆ„Åó„Åæ„Åô„ÄÇ</p>
<hr />
<h2 id="06">06. „É™„Éù„Ç∏„Éà„É™Â±§</h2>
<p>„É™„Éù„Ç∏„Éà„É™ÔºàRepositoryÔºâÂ±§„ÅØ„ÄÅ„Éá„Éº„Çø„Éô„Éº„Çπ„Ç¢„ÇØ„Çª„Çπ„ÅÆË©≥Á¥∞„ÇíÈö†ËîΩ„Åó„ÄÅ„Çµ„Éº„Éì„ÇπÂ±§„Åã„Çâ„ÅØ„Äå„Éá„Éº„ÇøÂèñÂæó„Éª‰øùÂ≠ò„Äç„Å®„ÅÑ„ÅÜÊìç‰Ωú„Å®„Åó„Å¶Êâ±„Åà„Çã„Çà„ÅÜ„Å´„Åô„ÇãÂΩπÂâ≤„ÇíÊåÅ„Å°„Åæ„Åô„ÄÇ</p>
<h3 id="_5">üî∞ Áî®Ë™ûËß£Ë™¨</h3>
<ul>
<li><strong>„É™„Éù„Ç∏„Éà„É™„Éë„Çø„Éº„É≥</strong>: „Éá„Éº„Çø„Éô„Éº„Çπ„Å∏„ÅÆ„Ç¢„ÇØ„Çª„ÇπÂá¶ÁêÜ„ÇíÂ∞ÇÁî®„ÇØ„É©„Çπ„Å´Âàá„ÇäÂá∫„Åô„Åì„Å®„Åß„ÄÅ„Ç¢„Éó„É™„ÅÆ„Éì„Ç∏„Éç„Çπ„É≠„Ç∏„ÉÉ„ÇØ„ÇíÁ∞°ÊΩî„Åã„Å§„ÉÜ„Çπ„Éà„Åó„ÇÑ„Åô„Åè‰øù„Å§Ë®≠Ë®à„Éë„Çø„Éº„É≥„ÄÇ</li>
<li>„Åü„Å®„Åà„Å∞„ÄåTodo„ÇíËøΩÂä†„Åô„Çã„ÄçÂá¶ÁêÜ„ÅØ„ÄÅSQL „ÇíÁõ¥Êé•Êõ∏„Åè„ÅÆ„Åß„ÅØ„Å™„Åè„ÄÅ<code>TodoRepository.create()</code> „Å®„ÅÑ„ÅÜ„É°„ÇΩ„ÉÉ„Éâ„ÇíÈÄö„Åò„Å¶Âëº„Å≥Âá∫„Åó„Åæ„Åô„ÄÇ</li>
</ul>
<h3 id="61">6.1 „Éô„Éº„Çπ„É™„Éù„Ç∏„Éà„É™</h3>
<p>ÂÖ±ÈÄö„ÅÆCRUDÊìç‰Ωú„ÇíÊèê‰æõ„Åô„Çã„Ç∏„Çß„Éç„É™„ÉÉ„ÇØ„Å™„Éô„Éº„Çπ„É™„Éù„Ç∏„Éà„É™„ÇíÂÆöÁæ©„Åó„Åæ„Åô„ÄÇ</p>
<p><strong><code>libkoiki/repositories/base.py</code> „ÅÆÂÆüË£Ö‰æã:</strong></p>
<pre><code class="language-python"># libkoiki/repositories/base.py
from typing import Generic, TypeVar, Type, Optional, List, Dict, Any, Sequence, Union
from sqlalchemy.ext.asyncio import AsyncSession
from sqlalchemy.future import select
from sqlalchemy import delete as sql_delete, update as sql_update
from pydantic import BaseModel as PydanticBaseModel # SQLAlchemy„ÅÆBase„Å®Âå∫Âà•
from libkoiki.db.base import Base as DBBase # SQLAlchemy„ÅÆORM Base

ModelType = TypeVar(&quot;ModelType&quot;, bound=DBBase)
CreateSchemaType = TypeVar(&quot;CreateSchemaType&quot;, bound=PydanticBaseModel)
UpdateSchemaType = TypeVar(&quot;UpdateSchemaType&quot;, bound=PydanticBaseModel)

class BaseRepository(Generic[ModelType, CreateSchemaType, UpdateSchemaType]):
    def __init__(self, model: Type[ModelType]):
        self.model = model
        self._db: Optional[AsyncSession] = None

    def set_session(self, db: AsyncSession):
        self._db = db

    @property
    def db(self) -&gt; AsyncSession:
        if self._db is None:
            raise Exception(f&quot;DB session not set for repository {self.__class__.__name__}&quot;)
        return self._db

    async def get(self, id: Any) -&gt; Optional[ModelType]:
        result = await self.db.execute(select(self.model).where(self.model.id == id))
        return result.scalar_one_or_none()

    async def get_multi(self, *, skip: int = 0, limit: int = 100) -&gt; Sequence[ModelType]:
        result = await self.db.execute(
            select(self.model).offset(skip).limit(limit).order_by(self.model.id)
        )
        return result.scalars().all()

    async def create(self, obj_in: ModelType) -&gt; ModelType:
        self.db.add(obj_in)
        await self.db.flush()
        await self.db.refresh(obj_in)
        return obj_in

    async def update(
        self, db_obj: ModelType, obj_in: Union[UpdateSchemaType, Dict[str, Any]]
    ) -&gt; ModelType:
        if isinstance(obj_in, dict):
            update_data = obj_in
        else:
            update_data = obj_in.dict(exclude_unset=True)

        for field, value in update_data.items():
            if hasattr(db_obj, field):
                setattr(db_obj, field, value)
        self.db.add(db_obj)
        await self.db.flush()
        await self.db.refresh(db_obj)
        return db_obj

    async def delete(self, id: Any) -&gt; Optional[ModelType]:
        obj = await self.get(id)
        if obj:
            await self.db.delete(obj)
            await self.db.flush()
        return obj
</code></pre>
<p>„Åì„ÅÆ„Éô„Éº„Çπ„É™„Éù„Ç∏„Éà„É™„ÅØ„ÄÅ„Ç≥„É≥„Çπ„Éà„É©„ÇØ„Çø„ÅßÊìç‰ΩúÂØæË±°„ÅÆ„É¢„Éá„É´„ÇØ„É©„Çπ„ÇíÂèó„ÅëÂèñ„Çä„ÄÅ<code>set_session</code> „É°„ÇΩ„ÉÉ„Éâ„ÅßÈùûÂêåÊúüDB„Çª„ÉÉ„Ç∑„Éß„É≥„ÇíË®≠ÂÆö„Åó„Åæ„Åô„ÄÇ„Çµ„Éº„Éì„ÇπÂ±§„ÅÆ„Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥ÁÆ°ÁêÜ„Å®ÈÄ£Êê∫„Åô„Çã„Åü„ÇÅ„Å´„ÄÅÂ§ñÈÉ®„Åã„Çâ„Çª„ÉÉ„Ç∑„Éß„É≥„ÇíÊ≥®ÂÖ•„Åô„ÇãË®≠Ë®à„Å´„Å™„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>
<h3 id="62">6.2 ÂÖ∑‰ΩìÁöÑ„Å™„É™„Éù„Ç∏„Éà„É™ÂÆüË£Ö</h3>
<p>„Éô„Éº„Çπ„É™„Éù„Ç∏„Éà„É™„ÇíÁ∂ôÊâø„Åó„ÄÅ„É¢„Éá„É´Âõ∫Êúâ„ÅÆ„ÇØ„Ç®„É™„É°„ÇΩ„ÉÉ„Éâ„Å™„Å©„ÇíËøΩÂä†„Åó„Åæ„Åô„ÄÇ</p>
<p><strong><code>libkoiki/repositories/user_repository.py</code> „ÅÆÂÆüË£Ö‰æã:</strong></p>
<pre><code class="language-python"># libkoiki/repositories/user_repository.py
from typing import Optional
from sqlalchemy.future import select
from sqlalchemy.orm import selectinload

from libkoiki.models.user import UserModel
from libkoiki.models.role import RoleModel
from libkoiki.repositories.base import BaseRepository
from libkoiki.schemas.user import UserCreate, UserUpdate # Áõ¥Êé•„ÅØ‰Ωø„Çè„Å™„ÅÑ„Åì„Å®„ÅåÂ§ö„ÅÑ

class UserRepository(BaseRepository[UserModel, UserCreate, UserUpdate]):
    def __init__(self):
        super().__init__(UserModel)

    async def get_by_email(self, email: str) -&gt; Optional[UserModel]:
        result = await self.db.execute(
            select(UserModel).where(UserModel.email == email)
        )
        return result.scalar_one_or_none()

    # RBAC‰ΩøÁî®ÊôÇ„Å™„Å©„ÄÅ„É™„É¨„Éº„Ç∑„Éß„É≥„Çí„É≠„Éº„Éâ„Åô„Çã„É°„ÇΩ„ÉÉ„Éâ
    async def get_user_with_roles_permissions(self, user_id: int) -&gt; Optional[UserModel]:
        stmt = (
            select(UserModel)
            .options(
                selectinload(UserModel.roles).selectinload(RoleModel.permissions)
            )
            .where(UserModel.id == user_id)
        )
        result = await self.db.execute(stmt)
        return result.scalar_one_or_none()
</code></pre>
<p>„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆ„É™„Éù„Ç∏„Éà„É™ (‰æã: <code>TodoRepository</code>) „ÅØ <code>app/repositories/</code> „Å´ÈÖçÁΩÆ„Åó„Åæ„Åô„ÄÇ</p>
<hr />
<h2 id="07">07. „Çµ„Éº„Éì„ÇπÂ±§</h2>
<p>„Çµ„Éº„Éì„ÇπÂ±§„ÅØ„ÄÅ„Éì„Ç∏„Éç„Çπ„É≠„Ç∏„ÉÉ„ÇØÔºàÔºù„Äå„Å©„ÅÜÂá¶ÁêÜ„Åô„Åπ„Åç„Åã„Äç„Å®„ÅÑ„ÅÜ„É´„Éº„É´Ôºâ„Çí„Åæ„Å®„ÇÅ„ÇãÂ†¥ÊâÄ„Åß„Åô„ÄÇ</p>
<h3 id="_6">üî∞ Áî®Ë™ûËß£Ë™¨</h3>
<ul>
<li><strong>„Çµ„Éº„Éì„ÇπÔºàServiceÔºâ</strong>: „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅåÊèê‰æõ„Åô„ÇãÊ©üËÉΩ„Çí„Åæ„Å®„ÇÅ„Åü„ÇØ„É©„Çπ„ÇÑÈñ¢Êï∞Áæ§„Åß„Åô„ÄÇ„Ç≥„É≥„Éà„É≠„Éº„É©„ÉºÔºàAPIÂ±§Ôºâ„Å®„Éá„Éº„ÇøÂ±§Ôºà„É™„Éù„Ç∏„Éà„É™Ôºâ„Å®„ÅÆ‰ª≤‰ªãÂΩπ„ÇíÊûú„Åü„Åó„Åæ„Åô„ÄÇ</li>
<li>„Åü„Å®„Åà„Å∞„ÄåTodo „ÇíÊõ¥Êñ∞„Åô„Çã„ÄçÂá¶ÁêÜ„Åß„ÅØ„ÄÅ„Åæ„Åö„Éá„Éº„Çø„ÇíÂèñÂæó„Åó„ÄÅÂøÖË¶Å„Å™Â§âÊõ¥„ÇíÂä†„Åà„ÄÅÂÜç‰øùÂ≠ò„Åô„Çã„Å®„ÅÑ„ÅÜ‰∏ÄÈÄ£„ÅÆÊµÅ„Çå„Çí„Åì„ÅÆ„Çµ„Éº„Éì„ÇπÂ±§„ÅßÂá¶ÁêÜ„Åó„Åæ„Åô„ÄÇ</li>
</ul>
<p>„Åì„ÅÆÂ±§„ÇíË®≠„Åë„Çã„Åì„Å®„Åß„ÄÅAPI„É´„Éº„ÉÜ„Ç£„É≥„Ç∞„ÇÑUI„Åã„Çâ„ÅÆÂëº„Å≥Âá∫„Åó„ÅåÈùûÂ∏∏„Å´„Ç∑„É≥„Éó„É´„Å´„Å™„Çä„Åæ„Åô„ÄÇ</p>
<h3 id="71">7.1 „Çµ„Éº„Éì„Çπ„ÇØ„É©„Çπ„ÅÆÂÆüË£Ö</h3>
<p>„Çµ„Éº„Éì„Çπ„ÇØ„É©„Çπ„ÅØ„ÄÅ„Ç≥„É≥„Çπ„Éà„É©„ÇØ„Çø„ÅßÂøÖË¶Å„Å™„É™„Éù„Ç∏„Éà„É™„ÇÑ‰ªñ„ÅÆ„Çµ„Éº„Éì„Çπ„ÇíÂèó„ÅëÂèñ„ÇäÔºàDIÁµåÁî±Ôºâ„ÄÅ„Éì„Ç∏„Éç„Çπ„É≠„Ç∏„ÉÉ„ÇØ„ÇíÂÆüË°å„Åô„Çã„É°„ÇΩ„ÉÉ„Éâ„ÇíÊèê‰æõ„Åó„Åæ„Åô„ÄÇ</p>
<p><strong><code>libkoiki/services/user_service.py</code> „ÅÆÂÆüË£Ö‰æã:</strong></p>
<pre><code class="language-python"># libkoiki/services/user_service.py
from typing import Optional, List, Sequence
from sqlalchemy.ext.asyncio import AsyncSession
import structlog

from libkoiki.repositories.user_repository import UserRepository
from libkoiki.models.user import UserModel
from libkoiki.schemas.user import UserCreate, UserUpdate
from libkoiki.core.security import get_password_hash, verify_password, check_password_complexity
# from libkoiki.events.publisher import EventPublisher # „Ç§„Éô„É≥„Éà„Ç∑„Çπ„ÉÜ„É†„Çí‰Ωø„ÅÜÂ†¥Âêà
from libkoiki.core.exceptions import ValidationException, ResourceNotFoundException
from libkoiki.core.transaction import transactional # „Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥„Éá„Ç≥„É¨„Éº„Çø

logger = structlog.get_logger(__name__)

class UserService:
    def __init__(self, repository: UserRepository): # event_publisher: Optional[EventPublisher] = None):
        self.repository = repository
        # self.event_publisher = event_publisher

    async def get_user_by_id(self, user_id: int, db: AsyncSession) -&gt; Optional[UserModel]:
        self.repository.set_session(db)
        user = await self.repository.get(user_id)
        if not user:
            raise ResourceNotFoundException(resource_name=&quot;User&quot;, resource_id=user_id)
        return user

    async def get_user_by_email(self, email: str, db: AsyncSession) -&gt; Optional[UserModel]:
        self.repository.set_session(db)
        return await self.repository.get_by_email(email)

    async def get_users(self, db: AsyncSession, skip: int = 0, limit: int = 100) -&gt; Sequence[UserModel]:
        self.repository.set_session(db)
        return await self.repository.get_multi(skip=skip, limit=limit)

    @transactional # „Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥ÁÆ°ÁêÜ
    async def create_user(self, user_in: UserCreate, db: AsyncSession) -&gt; UserModel:
        self.repository.set_session(db)
        if await self.repository.get_by_email(user_in.email):
            raise ValidationException(&quot;„Åì„ÅÆ„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ„ÅØÊó¢„Å´‰ΩøÁî®„Åï„Çå„Å¶„ÅÑ„Åæ„Åô&quot;)

        if not check_password_complexity(user_in.password): # „Éë„Çπ„ÉØ„Éº„Éâ„Éù„É™„Ç∑„Éº„ÉÅ„Çß„ÉÉ„ÇØ
            raise ValidationException(
                &quot;„Éë„Çπ„ÉØ„Éº„Éâ„ÅØ8ÊñáÂ≠ó‰ª•‰∏ä„Åß„ÄÅÂ§ßÊñáÂ≠ó„ÄÅÂ∞èÊñáÂ≠ó„ÄÅÊï∞Â≠ó„ÄÅË®òÂè∑„ÇíÂêÑ1„Å§‰ª•‰∏äÂê´„ÇÅ„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ&quot;
            )

        hashed_password = get_password_hash(user_in.password)
        # Pydantic„É¢„Éá„É´„ÅÆ dict() „ÅØ‰æøÂà©„Å†„Åå„ÄÅDB„É¢„Éá„É´„Å´Áõ¥Êé•Ê∏°„Åõ„Çã„Éï„Ç£„Éº„É´„Éâ„ÅÆ„Åø„Å´„Åô„Çã
        user_model_data = user_in.dict(exclude={&quot;password&quot;}, exclude_unset=True)
        user_model_data[&quot;hashed_password&quot;] = hashed_password

        user = UserModel(**user_model_data)
        created_user = await self.repository.create(user)

        logger.info(&quot;User created successfully&quot;, user_id=created_user.id, email=created_user.email)
        # if self.event_publisher:
        #     await self.event_publisher.publish(&quot;user_created&quot;, {&quot;user_id&quot;: created_user.id, &quot;email&quot;: created_user.email})
        return created_user

    @transactional
    async def update_user(self, user_id: int, user_in: UserUpdate, db: AsyncSession) -&gt; UserModel:
        self.repository.set_session(db)
        user = await self.repository.get(user_id)
        if not user:
            raise ResourceNotFoundException(resource_name=&quot;User&quot;, resource_id=user_id)

        update_data = user_in.dict(exclude_unset=True)
        if &quot;password&quot; in update_data and update_data[&quot;password&quot;]:
            if not check_password_complexity(update_data[&quot;password&quot;]):
                 raise ValidationException(&quot;„Éë„Çπ„ÉØ„Éº„Éâ„ÅØ8ÊñáÂ≠ó‰ª•‰∏ä„Åß„ÄÅÂ§ßÊñáÂ≠ó„ÄÅÂ∞èÊñáÂ≠ó„ÄÅÊï∞Â≠ó„ÄÅË®òÂè∑„ÇíÂêÑ1„Å§‰ª•‰∏äÂê´„ÇÅ„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ&quot;)
            update_data[&quot;hashed_password&quot;] = get_password_hash(update_data[&quot;password&quot;])
            del update_data[&quot;password&quot;]
        elif &quot;password&quot; in update_data: # password„ÅåÁ©∫ÊñáÂ≠ó„ÇÑNone„ÅÆÂ†¥Âêà
             del update_data[&quot;password&quot;]

        if &quot;email&quot; in update_data and update_data[&quot;email&quot;] != user.email:
             existing_user = await self.repository.get_by_email(update_data[&quot;email&quot;])
             if existing_user and existing_user.id != user_id:
                 raise ValidationException(&quot;„Åì„ÅÆ„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ„ÅØÊó¢„Å´‰ΩøÁî®„Åï„Çå„Å¶„ÅÑ„Åæ„Åô&quot;)

        updated_user = await self.repository.update(user, update_data)
        logger.info(&quot;User updated&quot;, user_id=updated_user.id)
        # if self.event_publisher:
        # await self.event_publisher.publish(&quot;user_updated&quot;, {&quot;user_id&quot;: updated_user.id})
        return updated_user

    @transactional
    async def delete_user(self, user_id: int, db: AsyncSession) -&gt; Optional[UserModel]:
        self.repository.set_session(db)
        user = await self.repository.get(user_id)
        if not user:
            raise ResourceNotFoundException(resource_name=&quot;User&quot;, resource_id=user_id)
        # Áâ©ÁêÜÂâäÈô§„ÅãË´ñÁêÜÂâäÈô§„Åã„ÅØ„É™„Éù„Ç∏„Éà„É™Â±§„Åæ„Åü„ÅØ„Åì„Åì„ÅßÂà∂Âæ°
        deleted_user = await self.repository.delete(user_id) # delete„Åå„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÇíËøî„ÅôÂ†¥Âêà
        logger.info(&quot;User deleted&quot;, user_id=user_id)
        return deleted_user

    async def authenticate_user(self, email: str, password: str, db: AsyncSession) -&gt; Optional[UserModel]:
        self.repository.set_session(db)
        user = await self.repository.get_by_email(email)
        if not user:
            logger.warning(&quot;Authentication failed: user not found&quot;, email=email)
            return None
        if not verify_password(password, user.hashed_password):
            logger.warning(&quot;Authentication failed: invalid password&quot;, email=email)
            return None
        return user
</code></pre>
<h3 id="72">7.2 „Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥ÁÆ°ÁêÜ</h3>
<p>Ë§áÊï∞„ÅÆDBÊìç‰Ωú„Çí‰º¥„ÅÜ„Éì„Ç∏„Éç„Çπ„É≠„Ç∏„ÉÉ„ÇØ„Åß„ÅØ„ÄÅÂá¶ÁêÜ„ÅÆÂéüÂ≠êÊÄß„Çí‰øùË®º„Åô„Çã„Åü„ÇÅ„Å´„Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥ÁÆ°ÁêÜ„Åå‰∏çÂèØÊ¨†„Åß„Åô„ÄÇ
<code>@transactional</code> „Éá„Ç≥„É¨„Éº„Çø„Çí„Çµ„Éº„Éì„Çπ„É°„ÇΩ„ÉÉ„Éâ„Å´ÈÅ©Áî®„Åô„Çã„Åì„Å®„Åß„ÄÅ„É°„ÇΩ„ÉÉ„ÉâÂÖ®‰Ωì„Çí‰∏Ä„Å§„ÅÆ„Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥„Çπ„Ç≥„Éº„Éó„ÅßÂÆüË°å„Åó„Åæ„Åô„ÄÇ</p>
<p><strong><code>libkoiki/core/transaction.py</code> „ÅÆÂÆüË£Ö‰æã:</strong></p>
<pre><code class="language-python"># libkoiki/core/transaction.py
import functools
from typing import Callable, Any, Optional
from sqlalchemy.ext.asyncio import AsyncSession
import structlog

# from libkoiki.db.session import get_db_session # DB„Çª„ÉÉ„Ç∑„Éß„É≥ÂèñÂæóÈñ¢Êï∞„ÇíÁõ¥Êé•‰Ωø„Çè„Å™„ÅÑ
logger = structlog.get_logger(__name__)

def transactional(func: Callable) -&gt; Callable:
    @functools.wraps(func)
    async def wrapper(*args: Any, **kwargs: Any) -&gt; Any:
        # „Éá„Ç≥„É¨„Éº„Çø„ÅåÈÅ©Áî®„Åï„Çå„Åü„É°„ÇΩ„ÉÉ„Éâ„ÅÆÊúÄÂæå„ÅÆÂºïÊï∞„Åå AsyncSession „Åß„ÅÇ„Çã„Åì„Å®„ÇíÊúüÂæÖ
        # ‰æã: async def my_method(self, ..., db: AsyncSession):
        db: Optional[AsyncSession] = None
        # args„ÅÆÊúÄÂæå„ÅåAsyncSession„Åã„ÄÅkwargs„Å´db„Åå„ÅÇ„Çã„Åã„ÉÅ„Çß„ÉÉ„ÇØ
        if args and isinstance(args[-1], AsyncSession):
            db = args[-1]
        elif &quot;db&quot; in kwargs and isinstance(kwargs[&quot;db&quot;], AsyncSession):
            db = kwargs[&quot;db&quot;]

        if db is None:
            # ÈÄöÂ∏∏„ÄÅ„Çµ„Éº„Éì„Çπ„É°„ÇΩ„ÉÉ„Éâ„ÅØFastAPI„ÅÆDI„Åã„Çâdb„Çª„ÉÉ„Ç∑„Éß„É≥„ÇíÊ≥®ÂÖ•„Åï„Çå„Çã
            # „Åì„ÅÆ„Éá„Ç≥„É¨„Éº„Çø„ÅØ„Åù„ÅÆ„Çª„ÉÉ„Ç∑„Éß„É≥„Çí„Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥ÁÆ°ÁêÜ„Å´‰Ωø„ÅÜ
            raise ValueError(
                f&quot;Transactional method {func.__name__} must receive an AsyncSession &quot;
                &quot;instance as its last positional argument or as a 'db' keyword argument.&quot;
            )

        # Êó¢„Å´„Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥„ÅåÈñãÂßã„Åï„Çå„Å¶„ÅÑ„Çã„ÅãÁ¢∫Ë™ç („Éç„Çπ„Éà„Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥„ÅØ begin_nested() „ÅåÂøÖË¶Å)
        # „Åì„Åì„Åß„ÅØÂçòÁ¥î„Å™„Éà„ÉÉ„Éó„É¨„Éô„É´„Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥„ÇíÊÉ≥ÂÆö
        if db.in_transaction():
            # „Éç„Çπ„Éà„Åï„Çå„ÅüÂëº„Å≥Âá∫„Åó„ÅÆÂ†¥Âêà„ÄÅ‰Ωï„ÇÇ„Åó„Å™„ÅÑ„Åß„Åù„ÅÆ„Åæ„ÅæÂÆüË°å
            logger.debug(f&quot;Joining existing transaction for {func.__name__}&quot;)
            return await func(*args, **kwargs)

        # Êñ∞„Åó„ÅÑ„Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥„ÇíÈñãÂßã
        async with db.begin(): # begin() „ÅßËá™ÂãïÁöÑ„Å´ commit/rollback
            logger.debug(f&quot;Starting transaction for {func.__name__}&quot;)
            try:
                result = await func(*args, **kwargs)
                # await db.commit() # async with db.begin() „ÅåËá™Âãï„ÅßË°å„ÅÜ
                logger.debug(f&quot;Transaction for {func.__name__} will be committed.&quot;)
                return result
            except Exception as e:
                logger.error(f&quot;Transaction failed for {func.__name__}, will be rolled back. Error: {e}&quot;, exc_info=True)
                # await db.rollback() # async with db.begin() „ÅåËá™Âãï„ÅßË°å„ÅÜ
                raise
    return wrapper
</code></pre>
<p><strong>‰ΩøÁî®ÊñπÊ≥ï:</strong>
„Çµ„Éº„Éì„Çπ„É°„ÇΩ„ÉÉ„Éâ„ÅÆÊúÄÂæå„ÅÆÂºïÊï∞„Å®„Åó„Å¶ <code>db: AsyncSession</code> „ÇíÂèó„ÅëÂèñ„Çä„ÄÅ„Åù„ÅÆ„É°„ÇΩ„ÉÉ„Éâ„Å´ <code>@transactional</code> „Éá„Ç≥„É¨„Éº„Çø„Çí‰ªò„Åë„Åæ„Åô„ÄÇ
„É°„ÇΩ„ÉÉ„ÉâÂÜÖ„Åß„É™„Éù„Ç∏„Éà„É™„Çí‰ΩøÁî®„Åô„ÇãÈöõ„ÅØ„ÄÅ<code>repository.set_session(db)</code> „ÇíÂëº„Å≥Âá∫„Åó„Å¶ÁèæÂú®„ÅÆ„Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥„Çπ„Ç≥„Éº„Éó„ÅÆ„Çª„ÉÉ„Ç∑„Éß„É≥„Çí„É™„Éù„Ç∏„Éà„É™„Å´Ê∏°„Åó„Åæ„Åô„ÄÇ</p>
<hr />
<h2 id="08-jwt">08. Ë™çË®º„ÉªË™çÂèØÔºàJWTÔºâ</h2>
<p>„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÇíÂà©Áî®„Åô„Çã„É¶„Éº„Ç∂„Éº„Åå„ÄåË™∞„Åß„ÅÇ„Çã„Åã„Äç„ÇíÁ¢∫Ë™ç„Åó„ÄÅ„Åù„ÅÆ„É¶„Éº„Ç∂„Éº„Åå„Äå‰Ωï„Çí„Åó„Å¶„Çà„ÅÑ„Åã„Äç„ÇíÂà∂Âæ°„Åô„Çã„Åü„ÇÅ„ÅÆ‰ªïÁµÑ„Åø„Åå <strong>Ë™çË®º„ÉªË™çÂèØ</strong> „Åß„Åô„ÄÇ</p>
<h3 id="_7">üî∞ Áî®Ë™ûËß£Ë™¨</h3>
<ul>
<li><strong>JWTÔºàJSON Web TokenÔºâ</strong>: „É¶„Éº„Ç∂„Éº„ÅÆÊÉÖÂ†±„ÇíÊöóÂè∑Âåñ„Åó„Å¶‰øùÊåÅ„Åô„Çã„Éà„Éº„ÇØ„É≥ÂΩ¢Âºè„ÄÇ„Åì„Çå„ÇíAPI„É™„ÇØ„Ç®„Çπ„Éà„Å´Âê´„ÇÅ„Çã„Åì„Å®„Åß„ÄÅ„É¶„Éº„Ç∂„Éº„ÇíË≠òÂà•„Åß„Åç„Åæ„Åô„ÄÇ</li>
<li><strong>„Ç¢„ÇØ„Çª„Çπ„Éà„Éº„ÇØ„É≥</strong>: ‰∏ÄÂÆöÊôÇÈñìÊúâÂäπ„Å™„Äå„É≠„Ç∞„Ç§„É≥Ë®ºÊòéÊõ∏„Äç„ÅÆ„Çà„ÅÜ„Å™„ÇÇ„ÅÆ„Åß„Åô„ÄÇ„Éà„Éº„ÇØ„É≥„Åå„ÅÇ„ÇãÈñì„ÄÅ„É≠„Ç∞„Ç§„É≥Áä∂ÊÖã„Å®„Åó„Å¶API„Å´„Ç¢„ÇØ„Çª„Çπ„Åß„Åç„Åæ„Åô„ÄÇ</li>
<li><strong>RBAC (Role-Based Access Control)</strong>: „É≠„Éº„É´ÔºàÂΩπÂâ≤Ôºâ„Å´Âü∫„Å•„ÅÑ„Å¶„É¶„Éº„Ç∂„Éº„ÅÆÊ®©Èôê„ÇíÁÆ°ÁêÜ„Åô„Çã‰ªïÁµÑ„Åø„ÄÇ</li>
</ul>
<h3 id="81-jwt">8.1 JWTË™çË®º„ÅÆÂÆüË£Ö</h3>
<p><code>python-jose</code> „Å® <code>passlib[bcrypt]</code> „Çí‰ΩøÁî®„Åó„Å¶JWT„ÅÆÁîüÊàê„ÉªÊ§úË®º„Å®„Éë„Çπ„ÉØ„Éº„Éâ„Éè„ÉÉ„Ç∑„É•Âåñ„ÇíË°å„ÅÑ„Åæ„Åô„ÄÇ</p>
<p><strong><code>libkoiki/core/security.py</code> „ÅÆÂÆüË£Ö‰æã:</strong></p>
<pre><code class="language-python"># libkoiki/core/security.py
from datetime import datetime, timedelta, timezone
from typing import Any, Optional, Union, Annotated
from jose import JWTError, jwt
from passlib.context import CryptContext
from fastapi import Depends, HTTPException, status
from fastapi.security import OAuth2PasswordBearer
from pydantic import ValidationError
from sqlalchemy.ext.asyncio import AsyncSession
from sqlalchemy.orm import selectinload
import structlog

from libkoiki.core.config import settings
from libkoiki.schemas.token import TokenPayload
from libkoiki.repositories.user_repository import UserRepository
from libkoiki.db.session import get_db
from libkoiki.models.user import UserModel
from libkoiki.models.role import RoleModel
from libkoiki.models.permission import PermissionModel

logger = structlog.get_logger(__name__)

# „Éë„Çπ„ÉØ„Éº„Éâ„Éè„ÉÉ„Ç∑„É•Âåñ„ÅÆ„Åü„ÇÅ„ÅÆ„Ç≥„É≥„ÉÜ„Ç≠„Çπ„Éà
pwd_context = CryptContext(schemes=[&quot;bcrypt&quot;], deprecated=&quot;auto&quot;)

# OAuth2„ÅÆ„Éë„Çπ„ÉØ„Éº„Éâ„Éï„É≠„ÉºË®≠ÂÆö
oauth2_scheme = OAuth2PasswordBearer(tokenUrl=f&quot;{settings.API_PREFIX}/auth/login&quot;)

def create_access_token(subject: Union[str, Any], expires_delta: Optional[timedelta] = None) -&gt; str:
    &quot;&quot;&quot;
    „É¶„Éº„Ç∂„ÉºID„Å™„Å©„ÇísubjectÂºïÊï∞„Å´ÊåáÂÆö„Åó„Å¶JWT„Ç¢„ÇØ„Çª„Çπ„Éà„Éº„ÇØ„É≥„ÇíÁîüÊàê„Åó„Åæ„Åô„ÄÇ

    Args:
        subject: ÈÄöÂ∏∏„ÅØ„É¶„Éº„Ç∂„ÉºID
        expires_delta: „Ç™„Éó„Ç∑„Éß„É≥„ÅÆÊúâÂäπÊúüÈôê„ÄÇÊåáÂÆö„Åå„Å™„ÅÑÂ†¥Âêà„ÅØ„Éá„Éï„Ç©„É´„ÉàÂÄ§„Çí‰ΩøÁî®

    Returns:
        „Ç®„É≥„Ç≥„Éº„Éâ„Åï„Çå„ÅüJWT„Éà„Éº„ÇØ„É≥
    &quot;&quot;&quot;
    if expires_delta:
        expire = datetime.now(timezone.utc) + expires_delta
    else:
        expire = datetime.now(timezone.utc) + timedelta(minutes=settings.ACCESS_TOKEN_EXPIRE_MINUTES)

    to_encode = {&quot;exp&quot;: expire.timestamp(), &quot;sub&quot;: str(subject)}
    encoded_jwt = jwt.encode(to_encode, settings.JWT_SECRET, algorithm=settings.JWT_ALGORITHM)
    logger.debug(&quot;Access token created&quot;, subject=subject, expires_at=expire.isoformat())
    return encoded_jwt

def verify_password(plain_password: str, hashed_password: str) -&gt; bool:
    &quot;&quot;&quot;Âπ≥Êñá„Éë„Çπ„ÉØ„Éº„Éâ„Å®„Éè„ÉÉ„Ç∑„É•Âåñ„Éë„Çπ„ÉØ„Éº„Éâ„ÇíÊØîËºÉ„Åó„Å¶‰∏ÄËá¥„Åô„Çã„ÅãÊ§úË®º„Åó„Åæ„Åô&quot;&quot;&quot;
    return pwd_context.verify(plain_password, hashed_password)

def get_password_hash(password: str) -&gt; str:
    &quot;&quot;&quot;„Éë„Çπ„ÉØ„Éº„Éâ„Çí„Éè„ÉÉ„Ç∑„É•Âåñ„Åó„Åæ„Åô&quot;&quot;&quot;
    return pwd_context.hash(password)

# „Éë„Çπ„ÉØ„Éº„ÉâË§áÈõëÊÄß„ÉÅ„Çß„ÉÉ„ÇØ
import re
def check_password_complexity(password: str) -&gt; bool:
    &quot;&quot;&quot;„Éë„Çπ„ÉØ„Éº„Éâ„ÅåË§áÈõëÊÄßË¶Å‰ª∂„ÇíÊ∫Ä„Åü„Åó„Å¶„ÅÑ„Çã„ÅãÊ§úË®º„Åó„Åæ„Åô&quot;&quot;&quot;
    if len(password) &lt; 8: return False
    if not re.search(r&quot;[a-z]&quot;, password): return False
    if not re.search(r&quot;[A-Z]&quot;, password): return False
    if not re.search(r&quot;\d&quot;, password): return False
    if not re.search(r&quot;[!@#$%^&amp;*(),.?\&quot;:{}|&lt;&gt;]&quot;, password): return False
    return True

async def get_current_user_from_token(
    token: Annotated[str, Depends(oauth2_scheme)],
    db: Annotated[AsyncSession, Depends(get_db)]
) -&gt; UserModel:
    &quot;&quot;&quot;
    JWT„Éà„Éº„ÇØ„É≥„ÇíÊ§úË®º„Åó„ÄÅÂØæÂøú„Åô„Çã„É¶„Éº„Ç∂„ÉºÊÉÖÂ†±„ÇíDB„Åã„ÇâÂèñÂæó„Åó„Åæ„Åô„ÄÇ
    „É≠„Éº„É´„Å®Ê®©Èôê„ÇÇ Eager Loading „Åó„Åæ„Åô„ÄÇ
    DB„Çª„ÉÉ„Ç∑„Éß„É≥„ÅØÂëº„Å≥Âá∫„ÅóÂÖÉ (e.g., dependencies.py) „ÅßÊèê‰æõ„Åï„Çå„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ

    Args:
        token: Bearer „Éà„Éº„ÇØ„É≥
        db: DB„Çª„ÉÉ„Ç∑„Éß„É≥

    Returns:
        Ë™çË®ºÊ∏à„ÅøUserModel„Ç§„É≥„Çπ„Çø„É≥„Çπ

    Raises:
        HTTPException: „Éà„Éº„ÇØ„É≥„ÅåÁÑ°Âäπ„ÅãÊúüÈôêÂàá„Çå„ÅÆÂ†¥Âêà
    &quot;&quot;&quot;
    credentials_exception = HTTPException(
        status_code=status.HTTP_401_UNAUTHORIZED,
        detail=&quot;Could not validate credentials&quot;,
        headers={&quot;WWW-Authenticate&quot;: &quot;Bearer&quot;},
    )
    try:
        payload = jwt.decode(
            token, settings.JWT_SECRET, algorithms=[settings.JWT_ALGORITHM]
        )
        token_data = TokenPayload(**payload) # „Éö„Ç§„É≠„Éº„Éâ„Çí„Çπ„Ç≠„Éº„Éû„ÅßÊ§úË®º

        # ÊúâÂäπÊúüÈôê„ÉÅ„Çß„ÉÉ„ÇØ
        if token_data.exp is None or datetime.fromtimestamp(token_data.exp, timezone.utc) &lt; datetime.now(timezone.utc):
             logger.warning(&quot;Token expired&quot;, user_id=token_data.sub, exp=token_data.exp)
             raise credentials_exception

        # „Çµ„Éñ„Ç∏„Çß„ÇØ„Éà („É¶„Éº„Ç∂„ÉºID) „ÉÅ„Çß„ÉÉ„ÇØ
        if token_data.sub is None:
            logger.warning(&quot;Token subject (user ID) is missing&quot;)
            raise credentials_exception

        user_id = int(token_data.sub) # ID„ÇíÊï¥Êï∞„Å´Â§âÊèõ
        logger.debug(&quot;Token decoded successfully&quot;, user_id=user_id)

    except (JWTError, ValidationError) as e:
        logger.warning(f&quot;Token validation failed: {e}&quot;, token=token[:10]+&quot;...&quot;) # „Éà„Éº„ÇØ„É≥„ÅÆ‰∏ÄÈÉ®„Å†„Åë„É≠„Ç∞„Å´
        raise credentials_exception

    # „É™„Éù„Ç∏„Éà„É™„Çí‰Ωø„Å£„Å¶„É¶„Éº„Ç∂„Éº„Çí„É≠„Éº„É´„Å®Ê®©ÈôêÊÉÖÂ†±„ÇÇÂê´„ÇÅ„Å¶ÂèñÂæó
    user_repo = UserRepository()
    user_repo.set_session(db) # Ê∏°„Åï„Çå„Åü db „Çª„ÉÉ„Ç∑„Éß„É≥„Çí‰ΩøÁî®
    user = await user_repo.get_user_with_roles_permissions(user_id)

    if user is None:
        logger.warning(&quot;User specified in token not found in DB&quot;, user_id=user_id)
        raise credentials_exception

    return user

# Ë™çË®ºÊ∏à„Åø„É¶„Éº„Ç∂„Éº„ÅÆ„Åø„Ç¢„ÇØ„Çª„ÇπÂèØËÉΩ
async def get_current_active_user(
    current_user: Annotated[UserModel, Depends(get_current_user_from_token)]
) -&gt; UserModel:
    if not current_user.is_active:
        raise HTTPException(status_code=status.HTTP_400_BAD_REQUEST, detail=&quot;Inactive user&quot;)
    return current_user

# ÁÆ°ÁêÜËÄÖ„É¶„Éº„Ç∂„Éº„ÅÆ„Åø„Ç¢„ÇØ„Çª„ÇπÂèØËÉΩ
async def get_current_active_superuser(
    current_user: Annotated[UserModel, Depends(get_current_active_user)]
) -&gt; UserModel:
    if not current_user.is_superuser:
        raise HTTPException(
            status_code=status.HTTP_403_FORBIDDEN,
            detail=&quot;The user doesn't have enough privileges&quot;
        )
    return current_user

# ‰æùÂ≠òÊÄßÊ≥®ÂÖ•Áî®„ÅÆ„Çø„Ç§„Éó„Ç®„Ç§„É™„Ç¢„Çπ
CurrentUserDep = Annotated[UserModel, Depends(get_current_user_from_token)]
ActiveUserDep = Annotated[UserModel, Depends(get_current_active_user)]
SuperUserDep = Annotated[UserModel, Depends(get_current_active_superuser)]
</code></pre>
<h3 id="82-api">8.2 Ë™çË®ºAPI„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà</h3>
<p>„É¶„Éº„Ç∂„ÉºË™çË®º„Å®„Éà„Éº„ÇØ„É≥Áô∫Ë°å„ÇíË°å„ÅÜ <code>/auth/login</code> „Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà„ÄÇ</p>
<p><strong><code>libkoiki/api/v1/endpoints/auth.py</code> „ÅÆÂÆüË£Ö‰æã:</strong></p>
<pre><code class="language-python"># libkoiki/api/v1/endpoints/auth.py
from fastapi import APIRouter, Depends, HTTPException, status, Request
from fastapi.security import OAuth2PasswordRequestForm
from typing import Annotated
from datetime import timedelta
import structlog

from libkoiki.schemas.token import Token
from libkoiki.schemas.user import UserCreate, UserResponse
from libkoiki.core.dependencies import get_db
from libkoiki.services.user_service import UserService
from libkoiki.core.security import create_access_token
from libkoiki.core.exceptions import AuthenticationException, ValidationException
from libkoiki.core.rate_limiter import limiter  # Áõ¥Êé•limiter„Çí‰ΩøÁî®
from libkoiki.core.config import settings
from libkoiki.core.dependencies import UserServiceDep

logger = structlog.get_logger(__name__)

router = APIRouter()

# „É≠„Ç∞„Ç§„É≥„Ç®„É≥„Éâ„Éù„Ç§„É≥„ÉàÔºà„É¨„Éº„Éà„É™„Éü„ÉÉ„Éà‰ªò„ÅçÔºâ
@router.post(&quot;/login&quot;, response_model=Token)
@limiter.limit(&quot;10/minute&quot;)  # limiter„Çí‰ΩøÁî®„Åó„Åü„É¨„Éº„Éà„É™„Éü„ÉÉ„Éà
async def login_for_access_token(
    request: Request,  # „É¨„Éº„Éà„É™„Éü„ÉÉ„ÉàÁî®„ÅÆ„É™„ÇØ„Ç®„Çπ„ÉàÊÉÖÂ†±
    form_data: Annotated[OAuth2PasswordRequestForm, Depends()],
    db: Annotated[AsyncSession, Depends(get_db)],
    user_service: UserServiceDep,  # „Çµ„Éº„Éì„Çπ„ÇíÊ≥®ÂÖ•
):
    &quot;&quot;&quot;
    OAuth2‰∫íÊèõ„ÅÆ„Éà„Éº„ÇØ„É≥ÂèñÂæó„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà„ÄÇ
    „É¶„Éº„Ç∂„ÉºË™çË®º„ÇíË°å„ÅÑ„ÄÅ„Ç¢„ÇØ„Çª„Çπ„Éà„Éº„ÇØ„É≥„ÇíÁô∫Ë°å„Åó„Åæ„Åô„ÄÇ

    Args:
        form_data: „É¶„Éº„Ç∂„ÉºÂêç(„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ)„Å®„Éë„Çπ„ÉØ„Éº„Éâ
        db: DB„Çª„ÉÉ„Ç∑„Éß„É≥
        user_service: UserService

    Returns:
        Token: „Ç¢„ÇØ„Çª„Çπ„Éà„Éº„ÇØ„É≥„Å®„Éà„Éº„ÇØ„É≥„Çø„Ç§„Éó

    Raises:
        HTTPException: Ë™çË®ºÂ§±ÊïóÊôÇ„Åæ„Åü„ÅØ„É¶„Éº„Ç∂„Éº„ÅåÈùû„Ç¢„ÇØ„ÉÜ„Ç£„Éñ„Å™Â†¥Âêà
    &quot;&quot;&quot;
    user = await user_service.authenticate_user(
        email=form_data.username, password=form_data.password, db=db
    )
    if not user:
        logger.warning(&quot;Login failed: invalid credentials&quot;, username=form_data.username)
        raise HTTPException(
            status_code=status.HTTP_401_UNAUTHORIZED,
            detail=&quot;Incorrect email or password&quot;,
            headers={&quot;WWW-Authenticate&quot;: &quot;Bearer&quot;},
        )
    if not user.is_active:
        logger.warning(&quot;Login attempt with inactive account&quot;, username=form_data.username, user_id=user.id)
        raise HTTPException(status_code=status.HTTP_400_BAD_REQUEST, detail=&quot;Inactive user&quot;)

    # „Ç´„Çπ„Çø„É†ÊúâÂäπÊúüÈôê„ÅÆË®≠ÂÆö‰æã („Ç™„Éó„Ç∑„Éß„É≥)
    # access_token_expires = timedelta(minutes=settings.ACCESS_TOKEN_EXPIRE_MINUTES)
    # access_token = create_access_token(subject=user.id, expires_delta=access_token_expires)

    # „Éá„Éï„Ç©„É´„ÉàÊúâÂäπÊúüÈôê„Åß„Éà„Éº„ÇØ„É≥‰ΩúÊàê
    access_token = create_access_token(subject=user.id)
    logger.info(&quot;User logged in successfully&quot;, user_id=user.id, email=user.email)

    return {&quot;access_token&quot;: access_token, &quot;token_type&quot;: &quot;bearer&quot;}

# „É¶„Éº„Ç∂„ÉºÁôªÈå≤„Ç®„É≥„Éâ„Éù„Ç§„É≥„ÉàÔºà„Ç™„Éó„Ç∑„Éß„É≥Ôºâ
@router.post(&quot;/register&quot;, response_model=UserResponse, status_code=status.HTTP_201_CREATED)
@limiter.limit(&quot;5/minute&quot;)  # ÁôªÈå≤„ÅØ‰Ωé„ÇÅ„ÅÆ„É¨„Éº„ÉàÂà∂Èôê
async def register_user(
    request: Request,
    user_in: UserCreate,
    db: Annotated[AsyncSession, Depends(get_db)],
    user_service: UserServiceDep,
):
    &quot;&quot;&quot;
    Êñ∞Ë¶è„É¶„Éº„Ç∂„Éº„ÇíÁôªÈå≤„Åó„Åæ„Åô„ÄÇ
    &quot;&quot;&quot;
    try:
        user = await user_service.create_user(user_in=user_in, db=db)
        logger.info(&quot;New user registered&quot;, user_id=user.id, email=user.email)
        return user
    except ValidationException as e:
        logger.warning(&quot;User registration failed&quot;, error=str(e), email=user_in.email)
        raise HTTPException(
            status_code=status.HTTP_400_BAD_REQUEST,
            detail=str(e)
        )
</code></pre>
<h3 id="83-rbac">8.3 „É≠„Éº„É´„Éô„Éº„Çπ„Ç¢„ÇØ„Çª„ÇπÂà∂Âæ° (RBAC)</h3>
<p>„É¶„Éº„Ç∂„Éº„Å´„É≠„Éº„É´„ÇíÂâ≤„ÇäÂΩì„Å¶„ÄÅ„É≠„Éº„É´„Å´Ê®©Èôê„ÇíÁ¥ê‰ªò„Åë„Çã„Åì„Å®„Åß„Ç¢„ÇØ„Çª„ÇπÂà∂Âæ°„ÇíË°å„ÅÑ„Åæ„Åô„ÄÇ
Ë©≥Á¥∞„ÅØ <a href="#15-„É≠„Éº„É´„Å®Ê®©Èôê">15. „É≠„Éº„É´„Å®Ê®©Èôê</a> „ÇíÂèÇÁÖß„ÄÇ</p>
<hr />
<h2 id="09-celery-redis">09. ÈùûÂêåÊúüÂá¶ÁêÜÔºàCelery &amp; RedisÔºâ</h2>
<p>ÈùûÂêåÊúüÂá¶ÁêÜ„Å®„ÅØ„ÄÅ„Äå„É¶„Éº„Ç∂„Éº„ÅÆÂæÖ„Å°ÊôÇÈñì„ÇíÊ∏õ„Çâ„Åô„Äç„Åü„ÇÅ„Å´„ÄÅÈáç„ÅÑÂá¶ÁêÜ„ÇíË£è„ÅßË°å„ÅÜ‰ªïÁµÑ„Åø„Åß„Åô„ÄÇ</p>
<h3 id="_8">üî∞ Áî®Ë™ûËß£Ë™¨</h3>
<ul>
<li><strong>ÈùûÂêåÊúüÂá¶ÁêÜ</strong>: „É¶„Éº„Ç∂„Éº„ÅåÂæÖ„Åü„Åö„Å´Êìç‰Ωú„Åß„Åç„Çã„Çà„ÅÜ„Å´„ÄÅË£èÂÅ¥„ÅßÂà•„Çπ„É¨„ÉÉ„Éâ„ÇÑ„Éó„É≠„Çª„Çπ„ÅßÂá¶ÁêÜ„ÇíÂÆüË°å„Åô„Çã‰ªïÁµÑ„Åø„ÄÇWeb„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Åß„ÅØ„ÄÅ„É°„Éº„É´ÈÄÅ‰ø°„ÇÑ„É¨„Éù„Éº„ÉàÁîüÊàê„Å™„Å©„Å´‰ΩøÁî®„ÄÇ</li>
<li><strong>Celery</strong>: Python„ÅßÂÆöÁï™„ÅÆÈùûÂêåÊúü„Çø„Çπ„ÇØ„Ç≠„É•„Éº„É©„Ç§„Éñ„É©„É™„ÄÇ</li>
<li><strong>Redis</strong>: Celery„Å®ÈÄ£Êê∫„Åó„ÄÅ„Çø„Çπ„ÇØ„ÅÆÂæÖ„Å°Ë°åÂàó„ÇíÁÆ°ÁêÜ„Åô„ÇãÂΩπÂâ≤„ÇíÊãÖ„ÅÜÈ´òÈÄü„Å™„Ç§„É≥„É°„É¢„É™„Éá„Éº„Çø„Çπ„Éà„Ç¢„ÄÇ</li>
</ul>
<h3 id="91-celery">9.1 Celery„Å´„Çà„ÇãÈùûÂêåÊúü„Çø„Çπ„ÇØ</h3>
<p>ÊôÇÈñì„ÅÆ„Åã„Åã„ÇãÂá¶ÁêÜÔºà„É°„Éº„É´ÈÄÅ‰ø°„ÄÅ„É¨„Éù„Éº„ÉàÁîüÊàê„Å™„Å©Ôºâ„Çí„Éê„ÉÉ„ÇØ„Ç∞„É©„Ç¶„É≥„Éâ„ÅßÂÆüË°å„Åó„Åæ„Åô„ÄÇ</p>
<p><strong><code>libkoiki/tasks/celery_app.py</code>:</strong></p>
<pre><code class="language-python"># libkoiki/tasks/celery_app.py
from celery import Celery
from libkoiki.core.config import settings
import structlog

logger = structlog.get_logger(__name__)

celery_app = None
if settings.CELERY_BROKER_URL and settings.CELERY_RESULT_BACKEND:
    celery_app = Celery(
        &quot;worker&quot;, # Celery„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âêç
        broker=settings.CELERY_BROKER_URL,
        backend=settings.CELERY_RESULT_BACKEND,
    )
    # Autodiscover tasks from installed apps (libkoiki.tasks, app.tasks)
    # For this to work, tasks modules should be importable.
    # The list should contain paths to modules where tasks are defined.
    celery_app.autodiscover_tasks(lambda: ['libkoiki.tasks', 'app.tasks']) # appÂÅ¥„ÅÆ„Çø„Çπ„ÇØ„ÇÇÊé¢Á¥¢

    celery_app.conf.update(
        task_serializer=&quot;json&quot;,
        accept_content=[&quot;json&quot;],
        result_serializer=&quot;json&quot;,
        timezone=getattr(settings, 'TIMEZONE', &quot;UTC&quot;), # settings„Å´TIMEZONE„Åå„ÅÇ„Çå„Å∞‰ΩøÁî®
        enable_utc=True,
        worker_prefetch_multiplier=1,
        task_acks_late=True, # „É°„ÉÉ„Çª„Éº„Ç∏„ÅÆACK„Çí„Çø„Çπ„ÇØÂÆå‰∫ÜÂæå„Å´„Åô„Çã
    )

    logger.info(&quot;Celery application initialized successfully&quot;)
else:
    logger.warning(&quot;Celery broker or backend URL not configured. Celery tasks disabled.&quot;)

# @celery_app.on_after_configure.connect
# def setup_periodic_tasks(sender, **kwargs):
    # sender.add_periodic_task(10.0, some_task.s('hello'), name='add every 10')
</code></pre>
<p><strong><code>libkoiki/tasks/example_task.py</code> (ÂÖ±ÈÄö„Çø„Çπ„ÇØ‰æã):</strong></p>
<pre><code class="language-python"># libkoiki/tasks/example_task.py
from libkoiki.tasks.celery_app import celery_app # celery_app„Ç§„É≥„Çπ„Çø„É≥„Çπ„Çí„Ç§„É≥„Éù„Éº„Éà
import structlog

logger = structlog.get_logger(__name__)

if celery_app: # celery_app„ÅåNone„Åß„Å™„ÅÑ„Åì„Å®„ÇíÁ¢∫Ë™ç
    @celery_app.task(name=&quot;libkoiki.tasks.add&quot;) # „Çø„Çπ„ÇØÂêç„ÇíÊòéÁ§∫ÁöÑ„Å´ÊåáÂÆö„Åô„Çã„Å®ËâØ„ÅÑ
    def add(x: int, y: int) -&gt; int:
        logger.info(f&quot;Task 'add' called with x={x}, y={y}&quot;)
        return x + y

    @celery_app.task(name=&quot;libkoiki.tasks.send_email_example&quot;)
    def send_email_example(to_email: str, subject: str, body: str):
        logger.info(f&quot;Simulating email send to {to_email} with subject '{subject}'&quot;)
        # ÂÆüÈöõ„ÅÆ„É°„Éº„É´ÈÄÅ‰ø°„É≠„Ç∏„ÉÉ„ÇØ (‰æã: smtplib „ÇÑÂ§ñÈÉ®„É°„Éº„É´„Çµ„Éº„Éì„ÇπAPI)
        import time
        time.sleep(5) # „É°„Éº„É´ÈÄÅ‰ø°„Å´„Åã„Åã„ÇãÊôÇÈñì„Çí„Ç∑„Éü„É•„É¨„Éº„Éà
        logger.info(f&quot;Email to {to_email} sent successfully.&quot;)
        return {&quot;status&quot;: &quot;success&quot;, &quot;to_email&quot;: to_email}
else:
    # Celery„ÅåÁÑ°Âäπ„Å™Â†¥Âêà„ÅÆ„Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØ„ÇÑË≠¶Âëä
    def add(x: int, y: int) -&gt; int:
        logger.warning(&quot;Celery is not configured. Task 'add' is running synchronously.&quot;)
        return x + y
    def send_email_example(to_email: str, subject: str, body: str):
        logger.warning(&quot;Celery is not configured. Task 'send_email_example' is running synchronously.&quot;)
        # ÂêåÊúüÁöÑ„Å´ÂÆüË°å„Åô„ÇãÁ∞°ÊòìÁâà
        logger.info(f&quot;Simulating synchronous email send to {to_email}&quot;)
        return {&quot;status&quot;: &quot;success&quot;, &quot;to_email&quot;: to_email, &quot;mode&quot;: &quot;synchronous&quot;}
</code></pre>
<p>„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆ„Çø„Çπ„ÇØ„ÅØ <code>app/tasks/</code> „Å´ÈÖçÁΩÆ„Åó„Åæ„Åô„ÄÇ
<code>app/tasks/__init__.py</code> „Çí‰ΩúÊàê„Åó„ÄÅ<code>app.tasks.your_task_module</code> „ÅÆ„Çà„ÅÜ„Å´Celery„ÅåÊ§úÂá∫„Åß„Åç„Çã„Çà„ÅÜ„Å´„Åó„Åæ„Åô„ÄÇ</p>
<h3 id="92">9.2 „Ç§„Éô„É≥„Éà„Ç∑„Çπ„ÉÜ„É† („Ç™„Éó„Ç∑„Éß„É≥)</h3>
<p>Redis Pub/Sub „ÇíÂà©Áî®„Åó„Åü„Ç∑„É≥„Éó„É´„Å™„Ç§„Éô„É≥„ÉàÈßÜÂãï„Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£„ÇíÊßãÁØâ„Åô„Çã„Åì„Å®„ÇÇÂèØËÉΩ„Åß„Åô„ÄÇ
„Çµ„Éº„Éì„ÇπÂ±§„Åß„Éì„Ç∏„Éç„Çπ„Ç§„Éô„É≥„Éà„ÇíÁô∫Ë°å„Åó„ÄÅÂà•„ÅÆ„Ç≥„É≥„Éù„Éº„Éç„É≥„ÉàÔºà„Ç§„Éô„É≥„Éà„Éè„É≥„Éâ„É©Ôºâ„Åå„Åù„Çå„ÇíË≥ºË™≠„Åó„Å¶ÈùûÂêåÊúü„Å´Âá¶ÁêÜ„Åó„Åæ„Åô„ÄÇ
v0.3.0 „ÅÆ <code>libkoiki/events/</code> „Éá„Ç£„É¨„ÇØ„Éà„É™„ÅÆÂÆüË£Ö (EventPublisher, EventHandler) „Å™„Å©„ÇíÂèÇËÄÉ„Å´Â∞éÂÖ•„Åß„Åç„Åæ„Åô„ÄÇ</p>
<h3 id="93-celery">9.3 Celery„ÅÆÊú¨Áï™ÈÅãÁî®„Å´Èñ¢„Åô„ÇãËÄÉÊÖÆ‰∫ãÈ†Ö</h3>
<ul>
<li><strong>„É™„Éà„É©„Ç§Êà¶Áï•</strong>: „Çø„Çπ„ÇØÂ§±ÊïóÊôÇ„ÅÆËá™Âãï„É™„Éà„É©„Ç§Ôºà<code>autoretry_for</code>, <code>retry_kwargs</code>, <code>max_retries</code>„Å™„Å©Ôºâ„ÄÇ</li>
<li><strong>Áõ£Ë¶ñ</strong>: Flower„Å™„Å©„ÅÆ„ÉÑ„Éº„É´„Åß„Çø„Çπ„ÇØ„ÅÆÂÆüË°åÁä∂Ê≥Å„ÄÅ„Ç≠„É•„Éº„ÅÆÈï∑„Åï„ÇíÁõ£Ë¶ñ„ÄÇPrometheus„Å®ÈÄ£Êê∫„Åó„Å¶„É°„Éà„É™„ÇØ„ÇπÂèéÈõÜ„ÄÇ</li>
<li><strong>„ÉØ„Éº„Ç´ÁÆ°ÁêÜ</strong>: Supervisor„ÇÑSystemd„Åß„ÉØ„Éº„Ç´„Éó„É≠„Çª„Çπ„Çí„Éá„Éº„É¢„É≥Âåñ„Åó„ÄÅËá™ÂãïÂÜçËµ∑Âãï„ÇíË®≠ÂÆö„ÄÇË≤†Ëç∑„Å´Âøú„Åò„Åü„ÉØ„Éº„Ç´Êï∞„ÅÆË™øÊï¥Ôºà„Çπ„Ç±„Éº„É™„É≥„Ç∞Ôºâ„ÄÇ</li>
<li><strong>„Éá„ÉÉ„Éâ„É¨„Çø„Éº„Ç≠„É•„Éº</strong>: Âá¶ÁêÜ„Å´Â§±Êïó„ÅóÁ∂ö„Åë„Çã„Çø„Çπ„ÇØ„ÇíÈöîÈõ¢„Åô„Çã‰ªïÁµÑ„Åø„ÄÇ</li>
<li><strong>ÂÜ™Á≠âÊÄß</strong>: „Çø„Çπ„ÇØ„ÅåË§áÊï∞ÂõûÂÆüË°å„Åï„Çå„Å¶„ÇÇÂïèÈ°å„Å™„ÅÑ„Çà„ÅÜ„Å´Ë®≠Ë®àÔºàÁâπ„Å´„É™„Éà„É©„Ç§ÊôÇÔºâ„ÄÇ</li>
<li><strong>„Çø„Çπ„ÇØ„ÅÆÂàÜÂâ≤</strong>: Èï∑ÊôÇÈñìÂÆüË°å„Åï„Çå„Çã„Çø„Çπ„ÇØ„ÅØ„ÄÅÂ∞è„Åï„Å™„Çµ„Éñ„Çø„Çπ„ÇØ„Å´ÂàÜÂâ≤„Åô„Çã„Åì„Å®„ÇíÊ§úË®é„ÄÇ</li>
<li><strong>ÁµêÊûú„Éê„ÉÉ„ÇØ„Ç®„É≥„Éâ</strong>: ÁµêÊûú„Åå‰∏çË¶Å„Å™„Çø„Çπ„ÇØ„Åß„ÅØ„Éê„ÉÉ„ÇØ„Ç®„É≥„ÉâË®≠ÂÆö„ÇíÁúÅÁï•„Åó„Å¶„Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÂêë‰∏ä„ÄÇÂøÖË¶Å„Å™Â†¥Âêà„Åß„ÇÇ„ÄÅÁµêÊûú„ÅÆTTL„ÇíË®≠ÂÆö„Åó„Å¶Redis„ÅÆ„É°„É¢„É™‰ΩøÁî®Èáè„ÇíÊäë„Åà„Çã„ÄÇ</li>
</ul>
<hr />
<h2 id="10-app">10. „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥ÂÆüË£Ö‰æã„Å®Ëµ∑ÂãïÊñπÊ≥ï (app/)</h2>
<p>„Åì„ÅÆ„Çª„ÇØ„Ç∑„Éß„É≥„Åß„ÅØ„ÄÅ<code>libkoiki</code> „Éï„É¨„Éº„É†„ÉØ„Éº„ÇØ„ÇíÂà©Áî®„Åó„Å¶„ÄÅÂÖ∑‰ΩìÁöÑ„Å™„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥ (<code>app/</code> „Éá„Ç£„É¨„ÇØ„Éà„É™‰ª•‰∏ã) „Çí„Å©„ÅÆ„Çà„ÅÜ„Å´ÊßãÁØâ„Åô„Çã„Åã„ÅÆ‰æã„Å®„Åó„Å¶„ÄÅ„Ç∑„É≥„Éó„É´„Å™ToDoÁÆ°ÁêÜ„Ç¢„Éó„É™„ÇíÁ§∫„Åó„Åæ„Åô„ÄÇ</p>
<h3 id="101-appmainpy">10.1 app/main.py</h3>
<p>„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅÆ„Ç®„É≥„Éà„É™„Éù„Ç§„É≥„Éà„ÄÇFastAPI„Ç§„É≥„Çπ„Çø„É≥„Çπ„ÅÆÂàùÊúüÂåñ„ÄÅ„Éü„Éâ„É´„Ç¶„Çß„Ç¢„ÅÆË®≠ÂÆö„ÄÅ„É´„Éº„Çø„Éº„ÅÆÁôªÈå≤„Å™„Å©„ÇíË°å„ÅÑ„Åæ„Åô„ÄÇ</p>
<pre><code class="language-python"># app/main.py
from contextlib import asynccontextmanager
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
from slowapi import _rate_limit_exceeded_handler # slowapi „ÅÆ„Éá„Éï„Ç©„É´„Éà„Éè„É≥„Éâ„É©
from slowapi.errors import RateLimitExceeded
from slowapi.middleware import SlowAPIMiddleware
import redis.asyncio as aioredis # redis.asyncio „Çí„Ç§„É≥„Éù„Éº„Éà
import structlog

from libkoiki.core.config import settings
from libkoiki.core.logging import setup_logging, get_logger
from libkoiki.core.error_handlers import setup_exception_handlers
from libkoiki.db.session import connect_db, disconnect_db
from libkoiki.core.rate_limiter import limiter
# from libkoiki.core.monitoring import setup_monitoring # Prometheus‰Ωø„ÅÜÂ†¥Âêà
# from libkoiki.core.middleware import SecurityHeadersMiddleware, AuditLogMiddleware # ÂøÖË¶Å„Å™„Çâ

# „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆ„É´„Éº„Çø„Éº„Çí„Ç§„É≥„Éù„Éº„Éà
from app.routers import todo_router # ToDo„É´„Éº„Çø„Éº

logger = get_logger(__name__) # „É≠„Ç¨„Éº„ÇíÂèñÂæó

@asynccontextmanager
async def lifespan(app: FastAPI):
    # --- „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Ëµ∑ÂãïÊôÇ ---
    setup_logging(
        log_level_str=settings.LOG_LEVEL,
        app_env=settings.APP_ENV,
        debug=settings.DEBUG
    )
    logger.info(f&quot;Starting application: {settings.APP_NAME} in {settings.APP_ENV} mode&quot;)

    await connect_db() # DBÊé•Á∂öÁ¢∫Ë™ç

    # Redis„ÇØ„É©„Ç§„Ç¢„É≥„ÉàÂàùÊúüÂåñ („É¨„Éº„Éà„É™„Éü„ÉÉ„Éà„ÄÅ„Ç≠„É£„ÉÉ„Ç∑„É•„ÄÅPub/SubÁî®)
    if settings.REDIS_URL:
        try:
            # aioredis.from_url „ÅØ aioredis.Redis.from_url „Å´Â§âÊõ¥„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥Âêà„Åå„ÅÇ„Çã
            app.state.redis = aioredis.Redis.from_url(settings.REDIS_URL, encoding=&quot;utf-8&quot;, decode_responses=True)
            await app.state.redis.ping() # Êé•Á∂öÁ¢∫Ë™ç
            logger.info(&quot;Redis connection successful.&quot;)
        except Exception as e:
            logger.error(f&quot;Redis connection failed: {e}&quot;, exc_info=True)
            app.state.redis = None # Â§±Êïó„Åó„ÅüÂ†¥Âêà„ÅØNone„Å´Ë®≠ÂÆö
    else:
        app.state.redis = None
        logger.warning(&quot;Redis URL not configured. Redis client not initialized.&quot;)

    # „É¨„Éº„Éà„É™„Éü„ÉÉ„Çø„Éº„Çí„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Áä∂ÊÖã„Å´Ë®≠ÂÆö
    app.state.limiter = limiter
    app.add_exception_handler(RateLimitExceeded, _rate_limit_exceeded_handler) # slowapi„Éá„Éï„Ç©„É´„Éà„Éè„É≥„Éâ„É©
    # „Ç∞„É≠„Éº„Éê„É´„Å´„Éü„Éâ„É´„Ç¶„Çß„Ç¢„Å®„Åó„Å¶ÈÅ©Áî®„Åô„ÇãÂ†¥Âêà
    # app.add_middleware(SlowAPIMiddleware)
    logger.info(f&quot;Rate limiter initialized (Strategy: {limiter.strategy}).&quot;)

    # setup_monitoring(app) # Prometheus„É°„Éà„É™„ÇØ„ÇπË®≠ÂÆö (ÊúâÂäπ„Å´„Åô„ÇãÂ†¥Âêà)

    yield # „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥ÂÆüË°å

    # --- „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥ÁµÇ‰∫ÜÊôÇ ---
    if hasattr(app.state, 'redis') and app.state.redis:
        await app.state.redis.close()
        logger.info(&quot;Redis connection closed.&quot;)
    await disconnect_db()
    logger.info(&quot;Application shutdown.&quot;)

app = FastAPI(
    title=settings.APP_NAME,
    debug=settings.DEBUG,
    lifespan=lifespan # lifespan„Ç≥„É≥„ÉÜ„Ç≠„Çπ„Éà„Éû„Éç„Éº„Ç∏„É£„ÇíÁôªÈå≤
)

# „Ç∞„É≠„Éº„Éê„É´‰æãÂ§ñ„Éè„É≥„Éâ„É©„ÉºË®≠ÂÆö
setup_exception_handlers(app)

# „Éü„Éâ„É´„Ç¶„Çß„Ç¢Ë®≠ÂÆö
# from libkoiki.core.middleware import AuditLogMiddleware, SecurityHeadersMiddleware # „Ç§„É≥„Éù„Éº„Éà
# app.add_middleware(AuditLogMiddleware) # Áõ£Êüª„É≠„Ç∞ (DB„Ç¢„ÇØ„Çª„Çπ„Å´Ê≥®ÊÑè)
# app.add_middleware(SecurityHeadersMiddleware) # „Çª„Ç≠„É•„É™„ÉÜ„Ç£„Éò„ÉÉ„ÉÄ
if settings.BACKEND_CORS_ORIGINS:
    app.add_middleware(
        CORSMiddleware,
        allow_origins=[str(origin) for origin in settings.BACKEND_CORS_ORIGINS], # ÊñáÂ≠óÂàó„É™„Çπ„Éà„Å´
        allow_credentials=True,
        allow_methods=[&quot;*&quot;],
        allow_headers=[&quot;*&quot;],
    )

# API„É´„Éº„Çø„ÉºÁôªÈå≤
# Ë™çË®º„É´„Éº„Çø„Éº„ÅØ libkoiki „Å´Âê´„Åæ„Çå„Çã„ÇÇ„ÅÆ„Çí‰ΩøÁî®
from libkoiki.api.v1.endpoints import auth
app.include_router(auth.router, prefix=f&quot;{settings.API_PREFIX}/auth&quot;, tags=[&quot;Authentication&quot;]) 

# „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆ„É´„Éº„Çø„Éº
app.include_router(todo_router.router, prefix=f&quot;{settings.API_PREFIX}/todos&quot;, tags=[&quot;Todos&quot;]) 

@app.get(&quot;/health&quot;, tags=[&quot;Health Check&quot;])
async def health_check():
    return {&quot;status&quot;: &quot;ok&quot;, &quot;message&quot;: &quot;Application is healthy&quot;}

# Celery„Çí‰Ωø„ÅÜÂ†¥Âêà„ÄÅcelery_app„ÇíFastAPI„Ç§„É≥„Çπ„Çø„É≥„Çπ„Åã„ÇâÂèÇÁÖß„Åß„Åç„Çã„Çà„ÅÜ„Å´„Åô„Çã („Ç™„Éó„Ç∑„Éß„É≥)
from libkoiki.tasks.celery_app import celery_app
app.state.celery_app = celery_app

# if __name__ == &quot;__main__&quot;:
# import uvicorn
# uvicorn.run(app, host=&quot;0.0.0.0&quot;, port=8000)
</code></pre>
<h3 id="102-approuterstodo_routerpy">10.2 app/routers/todo_router.py</h3>
<p>ToDo API„ÅÆ„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà„ÇíÂÆöÁæ©„Åó„Åæ„Åô„ÄÇ<code>libkoiki</code> „ÅÆÂÖ±ÈÄö‰æùÂ≠òÊÄß„ÇÑ <code>app</code> Âõ∫Êúâ„ÅÆ‰æùÂ≠òÊÄß„Çí‰ΩøÁî®„Åó„Åæ„Åô„ÄÇ</p>
<pre><code class="language-python"># app/routers/todo_router.py
from fastapi import APIRouter, Depends, HTTPException, status
from typing import List, Annotated
import structlog

from libkoiki.core.dependencies import DBSessionDep
from libkoiki.core.security import ActiveUserDep # Ë™çË®ºÊ∏à„Åø„É¶„Éº„Ç∂„Éº
from libkoiki.models.user import UserModel # UserModel„Çí„Ç§„É≥„Éù„Éº„Éà

from app.schemas.todo_schema import TodoCreateSchema, TodoUpdateSchema, TodoResponseSchema
from app.services.todo_service import TodoService # „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆ„Çµ„Éº„Éì„Çπ
from app.api.dependencies import get_todo_service # „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆDI

logger = structlog.get_logger(__name__)
router = APIRouter()
TodoServiceDep = Annotated[TodoService, Depends(get_todo_service)]

@router.post(&quot;/&quot;, response_model=TodoResponseSchema, status_code=status.HTTP_201_CREATED)
async def create_todo_endpoint(
    todo_in: TodoCreateSchema,
    db: DBSessionDep,
    todo_service: TodoServiceDep,
    current_user: ActiveUserDep, # Ë™çË®ºÊ∏à„Åø„É¶„Éº„Ç∂„Éº„ÅÆ„Åø‰ΩúÊàêÂèØËÉΩ
):
    &quot;&quot;&quot;Êñ∞„Åó„ÅÑToDo„Çí‰ΩúÊàê„Åó„Åæ„Åô„ÄÇË™çË®º„ÅåÂøÖË¶Å„Åß„Åô„ÄÇ&quot;&quot;&quot;
    logger.info(&quot;Creating new todo&quot;, user_id=current_user.id)
    return await todo_service.create_todo(todo_data=todo_in, db=db, owner_id=current_user.id)

@router.get(&quot;/&quot;, response_model=List[TodoResponseSchema])
async def get_todos_endpoint(
    db: DBSessionDep,
    todo_service: TodoServiceDep,
    current_user: ActiveUserDep, # Ëá™ÂàÜ„ÅÆToDo„ÅÆ„ÅøÂèñÂæó
    skip: int = 0,
    limit: int = 100,
):
    &quot;&quot;&quot;Ë™çË®º„É¶„Éº„Ç∂„Éº„ÅÆToDo‰∏ÄË¶ß„ÇíÂèñÂæó„Åó„Åæ„Åô„ÄÇ&quot;&quot;&quot;
    logger.debug(&quot;Fetching todos for user&quot;, user_id=current_user.id, skip=skip, limit=limit)
    return await todo_service.get_todos_by_owner(owner_id=current_user.id, db=db, skip=skip, limit=limit)

@router.get(&quot;/{todo_id}&quot;, response_model=TodoResponseSchema)
async def get_todo_by_id_endpoint(
    todo_id: int,
    db: DBSessionDep,
    todo_service: TodoServiceDep,
    current_user: ActiveUserDep,
):
    &quot;&quot;&quot;ÊåáÂÆö„Åï„Çå„ÅüID„ÅÆToDo„ÇíÂèñÂæó„Åó„Åæ„Åô„ÄÇË™çË®º„É¶„Éº„Ç∂„Éº„ÅÆToDo„Åß„ÅÇ„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ&quot;&quot;&quot;
    todo = await todo_service.get_todo_by_id_and_owner(todo_id=todo_id, owner_id=current_user.id, db=db)
    if not todo:
        raise HTTPException(status_code=status.HTTP_404_NOT_FOUND, detail=&quot;Todo not found or not authorized&quot;)
    return todo

@router.put(&quot;/{todo_id}&quot;, response_model=TodoResponseSchema)
async def update_todo_endpoint(
    todo_id: int,
    todo_in: TodoUpdateSchema,
    db: DBSessionDep,
    todo_service: TodoServiceDep,
    current_user: ActiveUserDep,
):
    &quot;&quot;&quot;ÊåáÂÆö„Åï„Çå„ÅüID„ÅÆToDo„ÇíÊõ¥Êñ∞„Åó„Åæ„Åô„ÄÇË™çË®º„É¶„Éº„Ç∂„Éº„ÅÆToDo„Åß„ÅÇ„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ&quot;&quot;&quot;
    updated_todo = await todo_service.update_todo(
        todo_id=todo_id, todo_data=todo_in, db=db, owner_id=current_user.id
    )
    if not updated_todo:
        raise HTTPException(status_code=status.HTTP_404_NOT_FOUND, detail=&quot;Todo not found or not authorized&quot;)
    return updated_todo

@router.delete(&quot;/{todo_id}&quot;, status_code=status.HTTP_204_NO_CONTENT)
async def delete_todo_endpoint(
    todo_id: int,
    db: DBSessionDep,
    todo_service: TodoServiceDep,
    current_user: ActiveUserDep,
):
    &quot;&quot;&quot;ÊåáÂÆö„Åï„Çå„ÅüID„ÅÆToDo„ÇíÂâäÈô§„Åó„Åæ„Åô„ÄÇË™çË®º„É¶„Éº„Ç∂„Éº„ÅÆToDo„Åß„ÅÇ„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ&quot;&quot;&quot;
    deleted = await todo_service.delete_todo(todo_id=todo_id, db=db, owner_id=current_user.id)
    if not deleted:
        raise HTTPException(status_code=status.HTTP_404_NOT_FOUND, detail=&quot;Todo not found or not authorized&quot;)
    return None # No content
</code></pre>
<h3 id="103-appservicestodo_servicepy">10.3 app/services/todo_service.py</h3>
<p>ToDo„Å´Èñ¢ÈÄ£„Åô„Çã„Éì„Ç∏„Éç„Çπ„É≠„Ç∏„ÉÉ„ÇØ„ÇíÂÆüË£Ö„Åó„Åæ„Åô„ÄÇ<code>libkoiki</code>„ÅÆ„Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥„Éá„Ç≥„É¨„Éº„Çø„Å™„Å©„Çí‰ΩøÁî®„Åß„Åç„Åæ„Åô„ÄÇ</p>
<pre><code class="language-python"># app/services/todo_service.py
from typing import List, Optional, Sequence
from sqlalchemy.ext.asyncio import AsyncSession
import structlog

from libkoiki.core.transaction import transactional
from libkoiki.core.exceptions import ResourceNotFoundException, AuthorizationException # ‰ΩøÁî®„Åô„ÇãÂ†¥Âêà„ÅØ„Ç§„É≥„Éù„Éº„Éà
from app.repositories.todo_repository import TodoRepository
from app.models.todo_model import TodoModel
from app.schemas.todo_schema import TodoCreateSchema, TodoUpdateSchema

logger = structlog.get_logger(__name__)

class TodoService:
    def __init__(self, repository: TodoRepository):
        self.repository = repository

    @transactional
    async def create_todo(self, todo_data: TodoCreateSchema, db: AsyncSession, owner_id: int) -&gt; TodoModel:
        self.repository.set_session(db)
        # owner_id„ÇíTodoModel„ÅÆ„Ç≥„É≥„Çπ„Éà„É©„ÇØ„Çø„Å´Ê∏°„Åô
        todo = TodoModel(**todo_data.dict(), owner_id=owner_id)
        created_todo = await self.repository.create(todo)
        logger.info(&quot;Todo created&quot;, todo_id=created_todo.id, owner_id=owner_id)
        return created_todo

    async def get_todos_by_owner(
        self, owner_id: int, db: AsyncSession, skip: int = 0, limit: int = 100
    ) -&gt; Sequence[TodoModel]:
        self.repository.set_session(db)
        return await self.repository.get_multi_by_owner(owner_id=owner_id, skip=skip, limit=limit)

    async def get_todo_by_id_and_owner(
        self, todo_id: int, owner_id: int, db: AsyncSession
    ) -&gt; Optional[TodoModel]:
        self.repository.set_session(db)
        todo = await self.repository.get(todo_id)
        if not todo:
            logger.warning(&quot;Todo not found&quot;, todo_id=todo_id)
            return None # „É´„Éº„Çø„Éº„Åß404Âá¶ÁêÜ
        if todo.owner_id != owner_id:
            logger.warning(&quot;Todo access denied - ownership mismatch&quot;, todo_id=todo_id, requested_by=owner_id, owner_id=todo.owner_id)
            return None # „É´„Éº„Çø„Éº„Åß404„Åæ„Åü„ÅØ403Âá¶ÁêÜ
        return todo

    @transactional
    async def update_todo(
        self, todo_id: int, todo_data: TodoUpdateSchema, db: AsyncSession, owner_id: int
    ) -&gt; Optional[TodoModel]:
        self.repository.set_session(db)
        todo = await self.repository.get(todo_id) # „Åæ„ÅöÂèñÂæó
        if not todo:
            logger.warning(&quot;Todo not found for update&quot;, todo_id=todo_id)
            return None
        if todo.owner_id != owner_id: # ÊâÄÊúâËÄÖ„ÉÅ„Çß„ÉÉ„ÇØ
            logger.warning(&quot;Todo update denied - ownership mismatch&quot;, todo_id=todo_id, requested_by=owner_id, owner_id=todo.owner_id)
            return None # Not authorized

        update_data = todo_data.dict(exclude_unset=True)
        updated_todo = await self.repository.update(todo, update_data) # ÂèñÂæó„Åó„Åü„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÇíÊõ¥Êñ∞
        logger.info(&quot;Todo updated&quot;, todo_id=todo_id, owner_id=owner_id)
        return updated_todo

    @transactional
    async def delete_todo(self, todo_id: int, db: AsyncSession, owner_id: int) -&gt; bool:
        self.repository.set_session(db)
        todo = await self.repository.get(todo_id) # „Åæ„ÅöÂèñÂæó
        if not todo:
            logger.warning(&quot;Todo not found for deletion&quot;, todo_id=todo_id)
            return False
        if todo.owner_id != owner_id: # ÊâÄÊúâËÄÖ„ÉÅ„Çß„ÉÉ„ÇØ
            logger.warning(&quot;Todo deletion denied - ownership mismatch&quot;, todo_id=todo_id, requested_by=owner_id, owner_id=todo.owner_id)
            return False # Not authorized

        await self.repository.delete(todo_id) # ID„ÅßÂâäÈô§ (delete„É°„ÇΩ„ÉÉ„Éâ„ÅÆÂÆüË£Ö„Å´„Çà„Çã)
        logger.info(&quot;Todo deleted&quot;, todo_id=todo_id, owner_id=owner_id)
        return True
</code></pre>
<h3 id="104-apprepositoriestodo_repositorypy">10.4 app/repositories/todo_repository.py</h3>
<p>ToDo„É¢„Éá„É´Âõ∫Êúâ„ÅÆ„Éá„Éº„Çø„Ç¢„ÇØ„Çª„ÇπÂá¶ÁêÜ„ÇíÂÆüË£Ö„Åó„Åæ„Åô„ÄÇ<code>libkoiki</code>„ÅÆ<code>BaseRepository</code>„ÇíÁ∂ôÊâø„Åß„Åç„Åæ„Åô„ÄÇ</p>
<pre><code class="language-python"># app/repositories/todo_repository.py
from typing import Optional, Sequence
from sqlalchemy.future import select

from libkoiki.repositories.base import BaseRepository
from app.models.todo_model import TodoModel
from app.schemas.todo_schema import TodoCreateSchema, TodoUpdateSchema # „Çπ„Ç≠„Éº„Éû„ÅØÁõ¥Êé•‰Ωø„Çè„Å™„ÅÑ„Åì„Å®„ÅåÂ§ö„ÅÑ

class TodoRepository(BaseRepository[TodoModel, TodoCreateSchema, TodoUpdateSchema]):
    def __init__(self):
        super().__init__(TodoModel) # Êìç‰ΩúÂØæË±°„ÅÆ„É¢„Éá„É´„ÇíÊ∏°„Åô

    async def get_multi_by_owner(
        self, owner_id: int, skip: int = 0, limit: int = 100
    ) -&gt; Sequence[TodoModel]:
        &quot;&quot;&quot;ÊåáÂÆö„Åï„Çå„Åüowner_id„ÇíÊåÅ„Å§ToDo„ÇíË§áÊï∞ÂèñÂæó„Åó„Åæ„Åô„ÄÇ&quot;&quot;&quot;
        result = await self.db.execute(
            select(self.model) # self.model (TodoModel) „Çí‰ΩøÁî®
            .where(self.model.owner_id == owner_id)
            .offset(skip)
            .limit(limit)
            .order_by(self.model.id) # ‰æã: ID„Åß„ÇΩ„Éº„Éà
        )
        return result.scalars().all()
</code></pre>
<h3 id="105-appmodelstodo_modelpy">10.5 app/models/todo_model.py</h3>
<p>ToDo„ÅÆ„Éá„Éº„Çø„Éô„Éº„Çπ„É¢„Éá„É´„ÇíÂÆöÁæ©„Åó„Åæ„Åô„ÄÇ<code>libkoiki</code>„ÅÆ<code>Base</code>„ÇíÁ∂ôÊâø„Åó„Åæ„Åô„ÄÇ</p>
<pre><code class="language-python"># app/models/todo_model.py
from sqlalchemy import Column, String, Boolean, Integer, ForeignKey
from sqlalchemy.orm import relationship

from libkoiki.db.base import Base # libkoiki„ÅÆBase„Çí„Ç§„É≥„Éù„Éº„Éà

class TodoModel(Base): # libkoiki„ÅÆBase„ÇíÁ∂ôÊâø
    # __tablename__ = &quot;todos&quot; # CustomBase„ÅßËá™ÂãïË®≠ÂÆö„Åï„Çå„Çã

    title = Column(String, nullable=False)
    description = Column(String, nullable=True)
    completed = Column(Boolean, default=False)

    # UserModel„ÅÆ‰∏ª„Ç≠„Éº„ÇíÂèÇÁÖß„Åô„ÇãÂ§ñÈÉ®„Ç≠„Éº
    owner_id = Column(Integer, ForeignKey(&quot;usermodel.id&quot;)) # &quot;usermodel&quot; „ÅØUserModel„ÅÆ„ÉÜ„Éº„Éñ„É´Âêç

    # UserModelÂÅ¥„Å´„ÇÇ„É™„É¨„Éº„Ç∑„Éß„É≥„Ç∑„ÉÉ„Éó„ÇíÂÆöÁæ©„Åô„ÇãÂøÖË¶Å„Åå„ÅÇ„Çã
    # owner = relationship(&quot;UserModel&quot;, back_populates=&quot;todos&quot;)
</code></pre>
<p><strong>Ê≥®ÊÑè:</strong> ÂèåÊñπÂêë„É™„É¨„Éº„Ç∑„Éß„É≥„Çí‰ΩøÁî®„Åô„ÇãÂ†¥Âêà„ÅØ„ÄÅ<code>libkoiki/models/user.py</code> „ÅÆ <code>UserModel</code> „Å´„ÇÇ <code>todos = relationship("TodoModel", back_populates="owner")</code> „ÅÆ„Çà„ÅÜ„Å™„É™„É¨„Éº„Ç∑„Éß„É≥ÂÆöÁæ©„ÅåÂøÖË¶Å„Åß„Åô„ÄÇ</p>
<h3 id="106-appschemastodo_schemapy">10.6 app/schemas/todo_schema.py</h3>
<p>ToDo„ÅÆPydantic„Çπ„Ç≠„Éº„Éû„ÇíÂÆöÁæ©„Åó„Åæ„Åô„ÄÇ</p>
<pre><code class="language-python"># app/schemas/todo_schema.py
from pydantic import BaseModel, Field
from typing import Optional
from datetime import datetime

class TodoBaseSchema(BaseModel):
    title: str = Field(..., min_length=1, max_length=100, description=&quot;ToDo„ÅÆ„Çø„Ç§„Éà„É´&quot;)
    description: Optional[str] = Field(None, max_length=500, description=&quot;ToDo„ÅÆË©≥Á¥∞Ë™¨Êòé&quot;)

class TodoCreateSchema(TodoBaseSchema):
    pass # Âü∫Êú¨ÁöÑ„Å´Base„Å®Âêå„Åò„Å†„Åå„ÄÅ‰ΩúÊàêÊôÇÁâπÊúâ„ÅÆ„Éï„Ç£„Éº„É´„Éâ„Åå„ÅÇ„Çå„Å∞ËøΩÂä†

class TodoUpdateSchema(BaseModel): # Êõ¥Êñ∞ÊôÇ„ÅØÂÖ®„Éï„Ç£„Éº„É´„Éâ„Ç™„Éó„Ç∑„Éß„Éä„É´„Åå‰∏ÄËà¨ÁöÑ
    title: Optional[str] = Field(None, min_length=1, max_length=100)
    description: Optional[str] = Field(None, max_length=500)
    completed: Optional[bool] = None

class TodoResponseSchema(TodoBaseSchema):
    id: int
    completed: bool
    owner_id: int # „Å©„ÅÆ„É¶„Éº„Ç∂„Éº„ÅÆToDo„Åã„ÇíÁ§∫„Åô
    created_at: datetime
    updated_at: datetime

    class Config:
        orm_mode = True # SQLAlchemy„É¢„Éá„É´„Ç§„É≥„Çπ„Çø„É≥„Çπ„Åã„Çâ„ÅÆÂ§âÊèõ„ÇíË®±ÂèØ
</code></pre>
<h3 id="107-appapidependenciespy">10.7 app/api/dependencies.py („Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆ‰æùÂ≠òÊÄß)</h3>
<p>„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆ‰æùÂ≠òÊÄßÔºàDIÔºâ„ÇíÂÆöÁæ©„Åó„Åæ„Åô„ÄÇ</p>
<pre><code class="language-python"># app/api/dependencies.py
from typing import Annotated
from fastapi import Depends
from sqlalchemy.ext.asyncio import AsyncSession

from libkoiki.core.dependencies import DBSessionDep
from app.services.todo_service import TodoService
from app.repositories.todo_repository import TodoRepository

def get_todo_repository() -&gt; TodoRepository:
    &quot;&quot;&quot;ToDo„É™„Éù„Ç∏„Éà„É™„ÅÆ„Ç§„É≥„Çπ„Çø„É≥„Çπ„ÇíËøî„Åô‰æùÂ≠òÊÄßÈñ¢Êï∞„ÄÇ&quot;&quot;&quot;
    return TodoRepository()

def get_todo_service(
    # „É™„Éù„Ç∏„Éà„É™„ÇíDI„ÅßÊ≥®ÂÖ•
    repo: Annotated[TodoRepository, Depends(get_todo_repository)],
    # DB„Çª„ÉÉ„Ç∑„Éß„É≥„ÅØ„Çµ„Éº„Éì„ÇπÂÜÖ„Åß„É™„Éù„Ç∏„Éà„É™„Å´Ë®≠ÂÆö„Åô„Çã„Åü„ÇÅ‰∏çË¶Å
) -&gt; TodoService:
    &quot;&quot;&quot;ToDo„Çµ„Éº„Éì„Çπ„ÅÆ„Ç§„É≥„Çπ„Çø„É≥„Çπ„ÇíËøî„Åô‰æùÂ≠òÊÄßÈñ¢Êï∞„ÄÇ&quot;&quot;&quot;
    return TodoService(repository=repo)
</code></pre>
<h3 id="108-alembic">10.8 „Éá„Éº„Çø„Éô„Éº„Çπ„Éû„Ç§„Ç∞„É¨„Éº„Ç∑„Éß„É≥ (Alembic)</h3>
<p>Alembic„Åå <code>app/models/</code> ÂÜÖ„ÅÆ„É¢„Éá„É´„ÇÇË™çË≠ò„Åß„Åç„Çã„Çà„ÅÜ„Å´Ë®≠ÂÆö„Åó„Åæ„Åô„ÄÇ</p>
<p><strong><code>alembic/env.py</code> „ÅÆ‰øÆÊ≠£ÁÆáÊâÄ:</strong>
<code>env.py</code> „ÅÆÂÜíÈ†≠„Åß„ÄÅ<code>libkoiki</code> „Å® <code>app</code> „ÅÆ‰∏°Êñπ„ÅÆ„É¢„Éá„É´„É¢„Ç∏„É•„Éº„É´„Çí„Ç§„É≥„Éù„Éº„Éà„Åô„Çã„Çà„ÅÜ„Å´„Åó„Åæ„Åô„ÄÇ</p>
<pre><code class="language-python"># alembic/env.py „ÅÆ‰∏äÈÉ® (sys.path„ÅÆË®≠ÂÆö„Å™„Å©„Åå„ÅÇ„ÇãÂ†¥Âêà„ÄÅ„Åù„ÅÆÁõ¥Âæå)
# ...
# „Éó„É≠„Ç∏„Çß„ÇØ„Éà„É´„Éº„Éà„ÇíPython„Éë„Çπ„Å´ËøΩÂä† (alembic„Ç≥„Éû„É≥„ÉâÂÆüË°åÊôÇ„ÅÆ„Ç´„É¨„É≥„Éà„Éá„Ç£„É¨„ÇØ„Éà„É™„Å´‰æùÂ≠ò„Åô„Çã„Åü„ÇÅ)
import os
import sys
sys.path.insert(0, os.path.realpath(os.path.join(os.path.dirname(__file__), &quot;..&quot;)))

# libkoiki „ÅÆ„É¢„Éá„É´„Çí„Ç§„É≥„Éù„Éº„Éà„Åó„Å¶Alembic„Å´Ë™çË≠ò„Åï„Åõ„Çã
import libkoiki.models.user # ‰æã
import libkoiki.models.role # ‰æã
import libkoiki.models.permission # ‰æã
import libkoiki.models.associations # ‰æã

# app „ÅÆ„É¢„Éá„É´„Çí„Ç§„É≥„Éù„Éº„Éà„Åó„Å¶Alembic„Å´Ë™çË≠ò„Åï„Åõ„Çã
import app.models.todo_model # ‰æã

# target_metadata „ÅÆË®≠ÂÆö
from libkoiki.db.base import Base # „Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÅßÂÖ±Êúâ„Åï„Çå„ÇãBase„Ç§„É≥„Çπ„Çø„É≥„Çπ
target_metadata = Base.metadata
# ...
</code></pre>
<p>Alembic„ÅåÊ≠£„Åó„ÅèÂãï‰Ωú„Åô„Çã„Åü„ÇÅ„Å´„ÅØ„ÄÅ<code>alembic.ini</code> „ÅÆ <code>sqlalchemy.url</code> „ÅåË®≠ÂÆö„Åï„Çå„Å¶„ÅÑ„Çã„Åì„Å®„ÄÅ„Åù„Åó„Å¶ <code>env.py</code> ÂÜÖ„Åß <code>target_metadata</code> „ÅåÂÖ®„Å¶„ÅÆ„ÉÜ„Éº„Éñ„É´„ÇíÂê´„ÇÄ„Çà„ÅÜ„Å´Ë®≠ÂÆö„Åï„Çå„Å¶„ÅÑ„Çã„Åì„Å®„ÅåÈáçË¶Å„Åß„Åô„ÄÇ
<code>libkoiki.db.base.Base</code> „Åå <code>app</code> ÂÅ¥„Åß„ÇÇÂÖ±ÈÄö„Åó„Å¶‰Ωø„Çè„Çå„Å¶„ÅÑ„Çå„Å∞„ÄÅ<code>target_metadata = Base.metadata</code> „ÅßÂïèÈ°å„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</p>
<p>„Éû„Ç§„Ç∞„É¨„Éº„Ç∑„Éß„É≥„Ç≥„Éû„É≥„Éâ:
- <code>alembic revision --autogenerate -m "create_todos_table"</code>
- <code>alembic upgrade head</code></p>
<h3 id="109">10.9 Ëµ∑ÂãïÊñπÊ≥ï</h3>
<pre><code class="language-bash"># ‰æùÂ≠òÈñ¢‰øÇ„Ç§„É≥„Çπ„Éà„Éº„É´ („Éó„É≠„Ç∏„Çß„ÇØ„Éà„É´„Éº„Éà„Åß)
# pip install -r requirements.txt („ÇÇ„Åó„ÅÇ„Çå„Å∞)
poetry install # poetry„Çí‰ΩøÁî®„Åô„ÇãÂ†¥Âêà
# pip install &quot;.[dev]&quot; (pyproject.toml„Å´dev‰æùÂ≠ò„Åå„ÅÇ„ÇãÂ†¥Âêà)

# .env„Éï„Ç°„Ç§„É´‰ΩúÊàê („Éó„É≠„Ç∏„Çß„ÇØ„Éà„É´„Éº„Éà„Å´.env.example„Çí„Ç≥„Éî„Éº„Åó„Å¶Á∑®ÈõÜ)
# SECRET_KEY „Å® JWT_SECRET „ÇíÂøÖ„ÅöË®≠ÂÆöÔºÅ
cp .env.example .env
nano .env # „Åæ„Åü„ÅØ‰ªªÊÑè„ÅÆ„Ç®„Éá„Ç£„Çø„ÅßÁ∑®ÈõÜ

# DB„Éû„Ç§„Ç∞„É¨„Éº„Ç∑„Éß„É≥ („Éá„Éº„Çø„Éô„Éº„Çπ„ÅåËµ∑Âãï„Åó„Å¶„ÅÑ„Çã„Åì„Å®)
alembic upgrade head

# FastAPI„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Ëµ∑Âãï („Éó„É≠„Ç∏„Çß„ÇØ„Éà„É´„Éº„Éà„Åã„Çâ)
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000

# Celery Worker Ëµ∑Âãï („Éó„É≠„Ç∏„Çß„ÇØ„Éà„É´„Éº„Éà„Åã„Çâ„ÄÅCeleryË®≠ÂÆö„ÅåÊúâÂäπ„Å™Â†¥Âêà)
# .env„Éï„Ç°„Ç§„É´„Åß CELERY_BROKER_URL „Å® CELERY_RESULT_BACKEND „ÇíË®≠ÂÆö„Åó„Å¶„Åä„Åè„Åì„Å®
celery -A libkoiki.tasks.celery_app worker --loglevel=info
</code></pre>
<p>Docker Compose „Çí‰ΩøÁî®„Åô„ÇãÂ†¥Âêà:</p>
<pre><code class="language-bash"># (docker-compose.yml „ÅåÈÅ©Âàá„Å´Ë®≠ÂÆö„Åï„Çå„Å¶„ÅÑ„ÇãÂâçÊèê)
docker-compose up --build
</code></pre>
<p><code>docker-compose.yml</code> „Åß„ÅØ„ÄÅFastAPI„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÄÅPostgreSQL„ÄÅRedis„ÄÅCelery„ÉØ„Éº„Ç´„ÇíÂêÑ„Çµ„Éº„Éì„Çπ„Å®„Åó„Å¶ÂÆöÁæ©„Åó„Åæ„Åô„ÄÇ</p>
<hr />
<h2 id="11">11. „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞„Å®‰æãÂ§ñÂá¶ÁêÜ</h2>
<p>„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥ÂÖ®‰Ωì„Åß‰∏ÄË≤´ÊÄß„ÅÆ„ÅÇ„Çã„Ç®„É©„Éº„É¨„Çπ„Éù„É≥„Çπ„ÇíÊèê‰æõ„Åó„ÄÅ„Éá„Éê„ÉÉ„Ç∞„ÇíÂÆπÊòì„Å´„Åô„Çã„Åü„ÇÅ„ÅÆ‰ªïÁµÑ„Åø„Åß„Åô„ÄÇ</p>
<h3 id="111">11.1 „Ç´„Çπ„Çø„É†‰æãÂ§ñ</h3>
<p>„Éì„Ç∏„Éç„Çπ„É≠„Ç∏„ÉÉ„ÇØÂõ∫Êúâ„ÅÆ„Ç®„É©„Éº„ÇíÁ§∫„Åô„Ç´„Çπ„Çø„É†‰æãÂ§ñ„ÄÇ</p>
<p><strong><code>libkoiki/core/exceptions.py</code> „ÅÆÂÆüË£Ö‰æã:</strong></p>
<pre><code class="language-python"># libkoiki/core/exceptions.py
from fastapi import HTTPException, status
from typing import Optional

class BaseAppException(HTTPException): # FastAPI„ÅÆHTTPException„ÇíÁ∂ôÊâø
    def __init__(self, status_code: int, detail: str, error_code: Optional[str] = None, headers: Optional[dict] = None):
        super().__init__(status_code=status_code, detail=detail, headers=headers)
        self.error_code = error_code if error_code else self.__class__.__name__.upper().replace(&quot;EXCEPTION&quot;, &quot;_ERROR&quot;)

class ResourceNotFoundException(BaseAppException):
    def __init__(self, resource_name: str, resource_id: any, detail: Optional[str] = None):
        detail_msg = detail or f&quot;{resource_name} with ID '{resource_id}' not found.&quot;
        super().__init__(status_code=status.HTTP_404_NOT_FOUND, detail=detail_msg, error_code=&quot;RESOURCE_NOT_FOUND&quot;)

class ValidationException(BaseAppException): # „Éì„Ç∏„Éç„Çπ„É´„Éº„É´ÈÅïÂèçÁî®
    def __init__(self, detail: str, error_code: Optional[str] = &quot;BUSINESS_VALIDATION_ERROR&quot;): # Pydantic„ÅÆ„Å®„ÅØÂå∫Âà•
        super().__init__(status_code=status.HTTP_400_BAD_REQUEST, detail=detail, error_code=error_code)

class AuthenticationException(BaseAppException):
    def __init__(self, detail: str = &quot;Authentication failed.&quot;, error_code: Optional[str] = &quot;AUTHENTICATION_FAILED&quot;):
        super().__init__(status_code=status.HTTP_401_UNAUTHORIZED, detail=detail, error_code=error_code, headers={&quot;WWW-Authenticate&quot;: &quot;Bearer&quot;})

class AuthorizationException(BaseAppException):
    def __init__(self, detail: str = &quot;Not authorized to perform this action.&quot;, error_code: Optional[str] = &quot;AUTHORIZATION_FAILED&quot;):
        super().__init__(status_code=status.HTTP_403_FORBIDDEN, detail=detail, error_code=error_code)

class ConflictException(BaseAppException): # ‰æã: ÈáçË§á‰ΩúÊàê„Åó„Çà„ÅÜ„Å®„Åó„ÅüÂ†¥Âêà„Å™„Å©
    def __init__(self, detail: str = &quot;Resource conflict.&quot;, error_code: Optional[str] = &quot;CONFLICT_ERROR&quot;):
        super().__init__(status_code=status.HTTP_409_CONFLICT, detail=detail, error_code=error_code)
</code></pre>
<h3 id="112">11.2 „Ç∞„É≠„Éº„Éê„É´‰æãÂ§ñ„Éè„É≥„Éâ„É©„Éº</h3>
<p>ÁâπÂÆö„ÅÆ‰æãÂ§ñ„ÇíË£úË∂≥„Åó„ÄÅÁµ±‰∏Ä„Åï„Çå„ÅüJSON„Ç®„É©„Éº„É¨„Çπ„Éù„É≥„Çπ„ÇíËøî„Åó„Åæ„Åô„ÄÇ</p>
<p><strong><code>libkoiki/core/error_handlers.py</code> „ÅÆÂÆüË£Ö‰æã:</strong></p>
<pre><code class="language-python"># libkoiki/core/error_handlers.py
from fastapi import FastAPI, Request, status
from fastapi.responses import JSONResponse
from fastapi.exceptions import RequestValidationError # Pydantic„ÅÆ„Éê„É™„Éá„Éº„Ç∑„Éß„É≥„Ç®„É©„Éº
from sqlalchemy.exc import SQLAlchemyError, IntegrityError, NoResultFound
from slowapi.errors import RateLimitExceeded # slowapi„ÅÆ‰æãÂ§ñ
import structlog

from libkoiki.core.exceptions import BaseAppException, ResourceNotFoundException, ValidationException as BusinessValidationException

logger = structlog.get_logger(__name__)

async def base_app_exception_handler(request: Request, exc: BaseAppException):
    &quot;&quot;&quot;„Ç´„Çπ„Çø„É†„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥‰æãÂ§ñ„ÅÆÊ±éÁî®„Éè„É≥„Éâ„É©&quot;&quot;&quot;
    error_code = getattr(exc, &quot;error_code&quot;, &quot;APPLICATION_ERROR&quot;) # error_code„Åå„ÅÇ„Çå„Å∞‰ΩøÁî®
    log_extra = {&quot;error_code&quot;: error_code, &quot;status_code&quot;: exc.status_code, &quot;path&quot;: str(request.url)}

    # „Ç®„É©„Éº„ÅÆÊ∑±ÂàªÂ∫¶„Å´Âøú„Åò„Å¶„É≠„Ç∞„É¨„Éô„É´„ÇíË™øÊï¥
    if exc.status_code == status.HTTP_404_NOT_FOUND:
        logger.info(f&quot;Application Exception (NotFound): {exc.detail}&quot;, extra=log_extra, exc_info=False)
    elif exc.status_code // 100 == 4: # 4xxÁ≥ª„Ç®„É©„Éº
        logger.warning(f&quot;Application Exception (ClientError): {exc.detail}&quot;, extra=log_extra, exc_info=False)
    else: # 5xxÁ≥ª„Ç®„É©„Éº„ÇÑ‰∫àÊúü„Åõ„Å¨„ÇÇ„ÅÆ
        logger.error(f&quot;Application Exception (ServerError): {exc.detail}&quot;, extra=log_extra, exc_info=True)

    return JSONResponse(
        status_code=exc.status_code,
        content={&quot;detail&quot;: exc.detail, &quot;error_code&quot;: error_code},
        headers=getattr(exc, &quot;headers&quot;, None), # „Éò„ÉÉ„ÉÄ„Éº„Åå„ÅÇ„Çå„Å∞‰ªò‰∏é
    )

async def pydantic_validation_exception_handler(request: Request, exc: RequestValidationError):
    &quot;&quot;&quot;FastAPI„ÅÆPydantic„Éê„É™„Éá„Éº„Ç∑„Éß„É≥„Ç®„É©„Éº„Éè„É≥„Éâ„É©&quot;&quot;&quot;
    logger.warning(f&quot;Pydantic Request Validation Error at {request.method} {request.url.path}: {exc.errors()}&quot;, extra={&quot;error_details&quot;: exc.errors(), &quot;path&quot;: str(request.url)})
    # „Ç®„É©„ÉºË©≥Á¥∞„ÇíÊï¥ÂΩ¢„Åó„Å¶Ëøî„Åô„Åì„Å®„ÇÇÂèØËÉΩ
    # errors = [{&quot;loc&quot;: e[&quot;loc&quot;], &quot;msg&quot;: e[&quot;msg&quot;], &quot;type&quot;: e[&quot;type&quot;]} for e in exc.errors()]
    return JSONResponse(
        status_code=status.HTTP_422_UNPROCESSABLE_ENTITY,
        content={&quot;detail&quot;: exc.errors(), &quot;error_code&quot;: &quot;PYDANTIC_VALIDATION_ERROR&quot;}, # FastAPI„Éá„Éï„Ç©„É´„Éà„Å´Ëøë„ÅÑÂΩ¢Âºè
    )

async def db_exception_handler(request: Request, exc: SQLAlchemyError):
    &quot;&quot;&quot;„Éá„Éº„Çø„Éô„Éº„ÇπÈñ¢ÈÄ£„Ç®„É©„Éº„ÅÆÊ±éÁî®„Éè„É≥„Éâ„É©&quot;&quot;&quot;
    error_code = &quot;DB_OPERATION_ERROR&quot;
    status_code = status.HTTP_500_INTERNAL_SERVER_ERROR
    detail = &quot;An unexpected database error occurred.&quot;

    if isinstance(exc, IntegrityError): # ‰∏ÄÊÑèÊÄßÂà∂Á¥ÑÈÅïÂèç„Å™„Å©
        status_code = status.HTTP_409_CONFLICT # 409 Conflict„ÅÆÊñπ„ÅåÈÅ©Âàá
        detail = &quot;Database integrity constraint violated. Resource might already exist or a foreign key constraint failed.&quot;
        error_code = &quot;DB_INTEGRITY_ERROR&quot;
        logger.warning(f&quot;Database Integrity Error: {exc}&quot;, exc_info=False, extra={&quot;error_code&quot;: error_code, &quot;path&quot;: str(request.url)})
    elif isinstance(exc, NoResultFound): # SQLAlchemy 2.0 „ÅÆ .one() „Å™„Å©„ÅßÁô∫Áîü
        status_code = status.HTTP_404_NOT_FOUND
        detail = &quot;The requested database record was not found.&quot;
        error_code = &quot;DB_NO_RESULT_FOUND&quot;
        logger.info(f&quot;Database NoResultFound Error: {exc}&quot;, exc_info=False, extra={&quot;error_code&quot;: error_code, &quot;path&quot;: str(request.url)})
    else: # „Åù„ÅÆ‰ªñ„ÅÆ SQLAlchemyError
        logger.error(f&quot;Unhandled Database Error: {exc}&quot;, exc_info=True, extra={&quot;error_code&quot;: error_code, &quot;path&quot;: str(request.url)})

    return JSONResponse(status_code=status_code, content={&quot;detail&quot;: detail, &quot;error_code&quot;: error_code})

async def generic_exception_handler(request: Request, exc: Exception):
    &quot;&quot;&quot;„Åù„ÅÆ‰ªñ„ÅÆ‰∫àÊúü„Åõ„Å¨„Ç®„É©„Éº„ÅÆ„Åü„ÇÅ„ÅÆÊúÄÁµÇÈò≤Ë°õ„É©„Ç§„É≥„Éè„É≥„Éâ„É©&quot;&quot;&quot;
    logger.error(f&quot;Unhandled Generic Exception at {request.method} {request.url.path}: {exc}&quot;, exc_info=True, extra={&quot;path&quot;: str(request.url)})
    return JSONResponse(
        status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
        content={&quot;detail&quot;: &quot;An unexpected internal server error occurred. Please try again later.&quot;, &quot;error_code&quot;: &quot;UNHANDLED_INTERNAL_SERVER_ERROR&quot;},
    )

def setup_exception_handlers(app: FastAPI):
    &quot;&quot;&quot;„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Å´‰∏ªË¶Å„Å™‰æãÂ§ñ„Éè„É≥„Éâ„É©„Éº„ÇíÁôªÈå≤„Åô„Çã&quot;&quot;&quot;
    app.add_exception_handler(BaseAppException, base_app_exception_handler) # „Ç´„Çπ„Çø„É†„Ç¢„Éó„É™‰æãÂ§ñ
    app.add_exception_handler(RequestValidationError, pydantic_validation_exception_handler) # Pydantic„Éê„É™„Éá„Éº„Ç∑„Éß„É≥„Ç®„É©„Éº
    app.add_exception_handler(SQLAlchemyError, db_exception_handler) # DB„Ç®„É©„Éº
    # RateLimitExceeded „ÅØ app.main „ÅÆ lifespan „Åß slowapi „ÅÆ _rate_limit_exceeded_handler „ÇíÁôªÈå≤
    app.add_exception_handler(Exception, generic_exception_handler) # ÊúÄ„ÇÇÊ±éÁî®ÁöÑ„Å™„Éè„É≥„Éâ„É©„ÇíÊúÄÂæå„Å´ÁôªÈå≤
    logger.info(&quot;Global exception handlers configured.&quot;)
</code></pre>
<p><code>app/main.py</code> „ÅÆ <code>FastAPI</code> „Ç§„É≥„Çπ„Çø„É≥„Çπ‰ΩúÊàêÂæå„Å´ <code>setup_exception_handlers(app)</code> „ÇíÂëº„Å≥Âá∫„Åó„Å¶ÁôªÈå≤„Åó„Åæ„Åô„ÄÇ</p>
<hr />
<h2 id="12">12. „É≠„ÇÆ„É≥„Ç∞„Å®„É¢„Éã„Çø„É™„É≥„Ç∞</h2>
<p>„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅÆÂãï‰ΩúÁä∂Ê≥Å„ÇíÊääÊè°„Åó„ÄÅÂïèÈ°åÁô∫ÁîüÊôÇ„ÅÆË™øÊüª„ÇíÂÆπÊòì„Å´„Åô„Çã„Åü„ÇÅ„ÅÆÊ©üËÉΩ„Åß„Åô„ÄÇ</p>
<h3 id="_9">üî∞ Áî®Ë™ûËß£Ë™¨ („É≠„ÇÆ„É≥„Ç∞)</h3>
<ul>
<li><strong>„É≠„ÇÆ„É≥„Ç∞</strong>: „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅÆÊåôÂãï„ÇíË®òÈå≤„Åô„Çã„Åì„Å®„Åß„ÄÅ‰∏çÂÖ∑Âêà„ÅÆË™øÊüª„ÇÑÈÅãÁî®Áõ£Ë¶ñ„Å´ÂΩπÁ´ã„Å°„Åæ„Åô„ÄÇ</li>
<li><strong>structlog</strong>: Python„ÅÆÊßãÈÄ†Âåñ„É≠„ÇÆ„É≥„Ç∞„É©„Ç§„Éñ„É©„É™„ÄÇJSONÂΩ¢Âºè„Å™„Å©„Åß„É≠„Ç∞„ÇíÂá∫Âäõ„Åó„ÄÅÊ©üÊ¢∞ÁöÑ„Å™Âá¶ÁêÜ„ÇíÂÆπÊòì„Å´„Åô„Çã„ÄÇ</li>
<li><strong>Áõ£Êüª„É≠„Ç∞</strong>: „Çª„Ç≠„É•„É™„ÉÜ„Ç£‰∏äÈáçË¶Å„Å™Êìç‰ΩúÔºàË™∞„Åå„ÄÅ„ÅÑ„Å§„ÄÅ‰Ωï„Çí„Åó„Åü„ÅãÔºâ„ÇíË®òÈå≤„Åô„Çã„É≠„Ç∞„ÄÇ</li>
</ul>
<h3 id="121-structlog">12.1 „É≠„ÇÆ„É≥„Ç∞Ë®≠ÂÆö (structlog)</h3>
<p><code>structlog</code> „Å®Ê®ôÊ∫ñ <code>logging</code> „ÇíÁµÑ„ÅøÂêà„Çè„Åõ„Å¶ÊßãÈÄ†Âåñ„É≠„Ç∞„ÇíÂá∫Âäõ„Åó„Åæ„Åô„ÄÇ</p>
<p><strong><code>libkoiki/core/logging.py</code> „ÅÆÂÆüË£Ö‰æã:</strong></p>
<pre><code class="language-python"># libkoiki/core/logging.py
import logging
import sys
import structlog
from structlog.types import Processor
from typing import Optional

def setup_logging(log_level_str: str = &quot;INFO&quot;, app_env: str = &quot;development&quot;, debug: bool = False):
    &quot;&quot;&quot;structlog „Çí‰ΩøÁî®„Åó„Å¶„É≠„ÇÆ„É≥„Ç∞„ÇíË®≠ÂÆö&quot;&quot;&quot;
    log_level = getattr(logging, log_level_str.upper(), logging.INFO)

    # structlog„ÅÆÂÖ±ÈÄö„Éó„É≠„Çª„ÉÉ„Çµ„ÉÅ„Çß„Éº„É≥
    shared_processors: list[Processor] = [
        structlog.contextvars.merge_contextvars, # contextvars„Åã„Çâ„ÅÆÊÉÖÂ†±„Çí„Éû„Éº„Ç∏ („É™„ÇØ„Ç®„Çπ„ÉàID„Å™„Å©)
        structlog.stdlib.add_logger_name,        # „É≠„Ç¨„ÉºÂêç (moduleÂêç) „ÇíËøΩÂä†
        structlog.stdlib.add_log_level,          # „É≠„Ç∞„É¨„Éô„É´ (INFO, ERROR„Å™„Å©) „ÇíËøΩÂä†
        structlog.stdlib.PositionalArgumentsFormatter(), # %sÂΩ¢Âºè„ÅÆ„Éï„Ç©„Éº„Éû„ÉÉ„Éà„Å´ÂØæÂøú
        structlog.processors.StackInfoRenderer(),      # „Çπ„Çø„ÉÉ„ÇØÊÉÖÂ†±„Çí„É¨„É≥„ÉÄ„É™„É≥„Ç∞ („Ç™„Éó„Ç∑„Éß„É≥)
        structlog.processors.format_exc_info,          # ‰æãÂ§ñÊÉÖÂ†±„ÇíÊï¥ÂΩ¢
        structlog.processors.TimeStamper(fmt=&quot;iso&quot;, utc=True), # ISOÂΩ¢Âºè„ÅÆ„Çø„Ç§„É†„Çπ„Çø„É≥„Éó (UTC)
    ]

    # Áí∞Â¢É„Å´Âøú„Åò„ÅüÊúÄÁµÇÁöÑ„Å™Âá∫Âäõ„Éï„Ç©„Éº„Éû„ÉÉ„Çø„ÇíÈÅ∏Êäû
    if app_env == &quot;development&quot; or debug:
        # ÈñãÁô∫Áí∞Â¢É: ‰∫∫Èñì„ÅåË™≠„Åø„ÇÑ„Åô„ÅÑ„Ç≥„É≥„ÇΩ„Éº„É´Âá∫Âäõ
        final_processor = structlog.dev.ConsoleRenderer()
    else:
        # Êú¨Áï™Áí∞Â¢É: JSONÂΩ¢Âºè„ÅßÂá∫Âäõ („É≠„Ç∞ÈõÜÁ¥Ñ„Ç∑„Çπ„ÉÜ„É†„Å®„ÅÆÈÄ£Êê∫„ÇíÊÉ≥ÂÆö)
        final_processor = structlog.processors.JSONRenderer()
        # „Ç≠„Éº„ÅÆÈ†ÜÁï™„ÇíÂõ∫ÂÆö„Åó„Åü„ÅÑÂ†¥Âêà„Å™„Å©
        # final_processor = structlog.processors.JSONRenderer(serializer=json.dumps, sort_keys=True)

    # structlog „Å®Ê®ôÊ∫ñ logging „ÇíÈÄ£Êê∫„Åï„Åõ„ÇãË®≠ÂÆö
    structlog.configure(
        processors=shared_processors + [
            structlog.stdlib.ProcessorFormatter.wrap_for_formatter, # Ê®ôÊ∫ñlogging„Éè„É≥„Éâ„É©Áî®„É©„ÉÉ„Éë„Éº
        ],
        logger_factory=structlog.stdlib.LoggerFactory(), # Ê®ôÊ∫ñlogging„ÅÆLogger„ÇíÁîüÊàê
        wrapper_class=structlog.stdlib.BoundLogger,    # Ê®ôÊ∫ñlogging„ÅÆLogger‰∫íÊèõ„ÅÆBoundLogger
        cache_logger_on_first_use=True,
    )

    # Ê®ôÊ∫ñlogging„ÅÆ„É´„Éº„Éà„É≠„Ç¨„ÉºË®≠ÂÆö
    # „Åì„Çå„Å´„Çà„Çä„ÄÅstructlogÁµåÁî±„Å†„Åë„Åß„Å™„Åè„ÄÅ‰ªñ„ÅÆ„É©„Ç§„Éñ„É©„É™(‰æã: SQLAlchemy)„Åã„Çâ„ÅÆ„É≠„Ç∞„ÇÇÂêå„ÅòÂΩ¢Âºè„ÅßÂá∫Âäõ„Åï„Çå„Çã
    formatter = structlog.stdlib.ProcessorFormatter(
        processor=final_processor, # ÊúÄÁµÇÁöÑ„Å™Âá∫ÂäõÂΩ¢Âºè
        foreign_pre_chain=shared_processors, # structlog‰ª•Â§ñ„ÅÆ„É≠„Ç∞„Å´ÈÅ©Áî®„Åô„Çã„Éó„É≠„Çª„ÉÉ„Çµ
    )

    handler = logging.StreamHandler(sys.stdout) # Ê®ôÊ∫ñÂá∫Âäõ„Å∏
    handler.setFormatter(formatter)

    root_logger = logging.getLogger()
    # Uvicorn„Å™„Å©„ÅåÊó¢„Å´ËøΩÂä†„Åó„Å¶„ÅÑ„Çã„Éè„É≥„Éâ„É©„Çí„ÇØ„É™„Ç¢„Åô„ÇãÂ†¥Âêà
    # for h in root_logger.handlers[:]:
    #     root_logger.removeHandler(h)
    root_logger.addHandler(handler)
    root_logger.setLevel(log_level) # „É´„Éº„Éà„É≠„Ç¨„Éº„ÅÆ„É≠„Ç∞„É¨„Éô„É´

    # ÁâπÂÆö„ÅÆ„É©„Ç§„Éñ„É©„É™„ÅÆ„É≠„Ç∞„É¨„Éô„É´„ÇíË™øÊï¥
    logging.getLogger(&quot;uvicorn.access&quot;).setLevel(logging.WARNING if not debug else logging.INFO)
    logging.getLogger(&quot;sqlalchemy.engine&quot;).setLevel(logging.WARNING if not debug else logging.INFO)

    logger = structlog.get_logger(&quot;logging_setup&quot;) # „Åì„ÅÆ„É¢„Ç∏„É•„Éº„É´Áî®„ÅÆ„É≠„Ç¨„Éº
    logger.info(&quot;Logging configured successfully.&quot;, log_level=log_level_str, app_env=app_env, debug_mode=debug)

def get_logger(name: Optional[str] = None) -&gt; structlog.stdlib.BoundLogger:
    &quot;&quot;&quot;structlog„É≠„Ç¨„Éº„ÇíÂèñÂæó„Åô„Çã„Éò„É´„Éë„ÉºÈñ¢Êï∞&quot;&quot;&quot;
    # __name__ „ÇíÊ∏°„Åô„Å®„ÄÅÂëº„Å≥Âá∫„ÅóÂÖÉ„ÅÆ„É¢„Ç∏„É•„Éº„É´Âêç„Åß„É≠„Ç¨„Éº„ÅåÂèñÂæó„Åï„Çå„Çã
    return structlog.get_logger(name if name else __name__)

# Áõ£Êüª„É≠„Ç∞Áî®„É≠„Ç¨„ÉºË®≠ÂÆö („Ç™„Éó„Ç∑„Éß„É≥„ÄÅÂøÖË¶Å„Å™„ÇâÂà•„ÅÆË®≠ÂÆöÈñ¢Êï∞„Çí‰ΩúÊàê)
# def setup_audit_logger():
#     audit_handler = logging.FileHandler(&quot;audit.log&quot;) # ‰æã: Áõ£Êüª„É≠„Ç∞Â∞ÇÁî®„Éï„Ç°„Ç§„É´
#     audit_formatter = structlog.stdlib.ProcessorFormatter(
#         processor=structlog.processors.JSONRenderer(), # Áõ£Êüª„É≠„Ç∞„ÅØJSONÂΩ¢ÂºèÊé®Â•®
#         foreign_pre_chain=shared_processors
#     )
#     audit_handler.setFormatter(audit_formatter)
#     audit_log_instance = logging.getLogger(&quot;audit&quot;) # &quot;audit&quot; „Å®„ÅÑ„ÅÜÂêçÂâç„ÅÆ„É≠„Ç¨„Éº
#     audit_log_instance.addHandler(audit_handler)
#     audit_log_instance.setLevel(logging.INFO)
#     audit_log_instance.propagate = False # „É´„Éº„Éà„É≠„Ç¨„Éº„Å´‰ºùÊí≠„Åï„Åõ„Å™„ÅÑ
#     return structlog.wrap_logger(audit_log_instance)
</code></pre>
<p><code>app/main.py</code> „ÅÆ <code>lifespan</code> ÂÜÖ„Åß <code>setup_logging(settings.LOG_LEVEL, settings.APP_ENV, settings.DEBUG)</code> „ÅÆ„Çà„ÅÜ„Å´Âëº„Å≥Âá∫„Åó„Åæ„Åô„ÄÇ</p>
<h3 id="122">12.2 Áõ£Êüª„É≠„Ç∞</h3>
<p>„Çª„Ç≠„É•„É™„ÉÜ„Ç£‰∏äÈáçË¶Å„Å™Êìç‰Ωú„ÇíË®òÈå≤„Åó„Åæ„Åô„ÄÇ„Éü„Éâ„É´„Ç¶„Çß„Ç¢„ÅßÂü∫Êú¨ÁöÑ„Å™ÊÉÖÂ†±„ÇíË®òÈå≤„Åó„ÄÅ„Çµ„Éº„Éì„ÇπÂ±§„ÅßË©≥Á¥∞ÊÉÖÂ†±„ÇíË£úË∂≥„Åß„Åç„Åæ„Åô„ÄÇ</p>
<p><strong><code>libkoiki/core/middleware.py</code> „Å´Áõ£Êüª„É≠„Ç∞„Éü„Éâ„É´„Ç¶„Çß„Ç¢„ÅÆ‰æã:</strong></p>
<pre><code class="language-python"># libkoiki/core/middleware.py (Á∂ö„Åç)
        # „É™„ÇØ„Ç®„Çπ„Éà/„É¨„Çπ„Éù„É≥„Çπ„Éú„Éá„Ç£„ÅÆ„É≠„Ç∞Ë®òÈå≤„ÅØ„Éá„Éº„ÇøÈáè„Å®Ê©üÂØÜÊÄß„Å´Ê≥®ÊÑè„Åó„Å¶ÈÅ∏ÊäûÁöÑ„Å´Ë°å„ÅÜ
        # if request.method in [&quot;POST&quot;, &quot;PUT&quot;, &quot;PATCH&quot;] and &quot;application/json&quot; in request.headers.get(&quot;content-type&quot;, &quot;&quot;):
        #     try:
        #         req_body_bytes = await request.body()
        #         # request.stream() „ÇíÊ∂àË≤ª„Åô„Çã„Å®ÂæåÁ∂öÂá¶ÁêÜ„ÅßË™≠„ÇÅ„Å™„Åè„Å™„Çã„Åü„ÇÅ„ÄÅÂÜçÂ∫¶„Çπ„Éà„É™„Éº„É†„ÇíÁîüÊàê„Åô„Çã
        #         request._stream = lambda: asyncio.BytesIO(req_body_bytes)
        #         if req_body_bytes: # Ê©üÂØÜÊÉÖÂ†±„ÅØ„Éû„Çπ„Ç≠„É≥„Ç∞Âá¶ÁêÜ„ÅåÂøÖË¶Å
        #             try:
        #                 req_json = json.loads(req_body_bytes.decode('utf-8'))
        #                 # „Éë„Çπ„ÉØ„Éº„Éâ„Å™„Å©„ÅÆÊ©üÂØÜÊÉÖÂ†±„Çí„Éû„Çπ„ÇØ
        #                 if 'password' in req_json:
        #                     req_json['password'] = '***MASKED***'
        #                 log_entry[&quot;request_body&quot;] = req_json
        #             except json.JSONDecodeError:
        #                 log_entry[&quot;request_body&quot;] = &quot;[Non-JSON body]&quot;
        #     except Exception as e:
        #         log_entry[&quot;request_body_error&quot;] = str(e)

        audit_logger.info(&quot;API request processed&quot;, **log_entry) # ÊßãÈÄ†Âåñ„É≠„Ç∞„Å®„Åó„Å¶Âá∫Âäõ
        return response
</code></pre>
<p><code>app/main.py</code> „Åß <code>app.add_middleware(AuditLogMiddleware)</code> „Å®„Åó„Å¶ÁôªÈå≤„ÄÇ</p>
<h3 id="123">12.3 „Éü„Éâ„É´„Ç¶„Çß„Ç¢„Å´„Çà„Çã„É¢„Éã„Çø„É™„É≥„Ç∞ („É™„ÇØ„Ç®„Çπ„Éà„É≠„Ç∞)</h3>
<p>HTTP„É™„ÇØ„Ç®„Çπ„Éà„ÅÆÂü∫Êú¨ÊÉÖÂ†±„Çí„É≠„Ç∞Âá∫Âäõ„Åó„Åæ„Åô„ÄÇ<code>structlog</code> „Çí‰ΩøÁî®„Åô„ÇãÂ†¥Âêà„ÄÅUvicorn„ÅÆ„Ç¢„ÇØ„Çª„Çπ„É≠„Ç∞„Çí <code>structlog</code> „ÅßÂá¶ÁêÜ„Åô„Çã„Çà„ÅÜ„Å´Ë®≠ÂÆö„Åô„ÇãÊñπ„Åå‰∏ÄËà¨ÁöÑ„Åß„Åô„ÄÇ
(<code>uvicorn.run(..., access_log=True)</code> „Å® <code>logging.getLogger("uvicorn.access").handlers = [...]</code>)
Uvicorn„ÅÆ„Ç¢„ÇØ„Çª„Çπ„É≠„Ç∞„ÅØ„Éá„Éï„Ç©„É´„Éà„Åß <code>INFO</code> „É¨„Éô„É´„ÅßÂá∫Âäõ„Åï„Çå„Çã„Åü„ÇÅ„ÄÅ<code>libkoiki/core/logging.py</code> „Åß <code>uvicorn.access</code> „É≠„Ç¨„Éº„ÅÆ„É¨„Éô„É´„ÇíË™øÊï¥„Åô„Çã„Åì„Å®„ÅßÂà∂Âæ°„Åß„Åç„Åæ„Åô„ÄÇ</p>
<h3 id="_10">üî∞ Áî®Ë™ûËß£Ë™¨ („É¢„Éã„Çø„É™„É≥„Ç∞)</h3>
<ul>
<li><strong>„É¢„Éã„Çø„É™„É≥„Ç∞</strong>: „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅÆÂãï‰ΩúÁä∂ÊÖãÔºàË≤†Ëç∑„ÄÅÂøúÁ≠îÊôÇÈñì„ÄÅÁï∞Â∏∏Áô∫Áîü„Å™„Å©Ôºâ„ÇíÂ∏∏ÊôÇË¶≥Ê∏¨„Åô„Çã„Åì„Å®„ÄÇ</li>
<li><strong>Prometheus</strong>: „Ç™„Éº„Éó„É≥„ÇΩ„Éº„Çπ„ÅÆÁõ£Ë¶ñ„ÉÑ„Éº„É´„ÄÇÊôÇÁ≥ªÂàó„Éá„Éº„Çø„ÇíÂèéÈõÜ„Éª‰øùÂ≠ò„Åó„ÄÅ„Ç¢„É©„Éº„Éà„ÇíÁô∫Ë°å„Åß„Åç„Çã„ÄÇ</li>
<li><strong>„É°„Éà„É™„ÇØ„Çπ</strong>: Áõ£Ë¶ñÂØæË±°„ÅÆÊï∞ÂÄ§„Éá„Éº„ÇøÔºà‰æã: „É™„ÇØ„Ç®„Çπ„ÉàÊï∞„ÄÅ„Ç®„É©„ÉºÁéá„ÄÅCPU‰ΩøÁî®ÁéáÔºâ„ÄÇ</li>
</ul>
<h3 id="124-prometheus">12.4 Prometheus „É°„Éà„É™„ÇØ„Çπ</h3>
<p><code>prometheus-fastapi-instrumentator</code> „Çí‰ΩøÁî®„Åó„Å¶PrometheusÂΩ¢Âºè„ÅÆ„É°„Éà„É™„ÇØ„Çπ„ÇíÂÖ¨Èñã„Åó„Åæ„Åô„ÄÇ</p>
<p><strong><code>libkoiki/core/monitoring.py</code> „ÅÆÂÆüË£Ö‰æã:</strong></p>
<pre><code class="language-python"># libkoiki/core/monitoring.py
from fastapi import FastAPI
from prometheus_fastapi_instrumentator import Instrumentator
import structlog

# „Ç´„Çπ„Çø„É†„É°„Éà„É™„ÇØ„Çπ„ÅÆ‰æã (ÂøÖË¶Å„Å´Âøú„Åò„Å¶ÂÆöÁæ©)
# from prometheus_client import Counter
# user_creations_total = Counter(
#     &quot;koiki_user_creations_total&quot;, # „É°„Éà„É™„ÇØ„ÇπÂêç („Éó„É¨„Éï„Ç£„ÉÉ„ÇØ„Çπ„Çí‰ªò„Åë„Çã„Å®ËâØ„ÅÑ)
#     &quot;Total number of users created through the API.&quot;
# )

logger = structlog.get_logger(__name__)

def setup_monitoring(app: FastAPI):
    &quot;&quot;&quot;FastAPI„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Å´Prometheus Instrumentator„ÇíË®≠ÂÆö„Åó„ÄÅ„É°„Éà„É™„ÇØ„Çπ„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà„ÇíÂÖ¨Èñã„Åô„Çã&quot;&quot;&quot;

    instrumentator = Instrumentator(
        should_group_status_codes=True,   # „Çπ„ÉÜ„Éº„Çø„Çπ„Ç≥„Éº„Éâ„Çí„Ç∞„É´„Éº„ÉóÂåñ (2xx, 3xx „Å™„Å©)
        should_instrument_requests_inprogress=True, # ÁèæÂú®Âá¶ÁêÜ‰∏≠„ÅÆ„É™„ÇØ„Ç®„Çπ„ÉàÊï∞„ÇíË®àÊ∏¨
        excluded_handlers=[&quot;/metrics&quot;, &quot;/health&quot;],  # /metrics „ÇÑ /health „Ç®„É≥„Éâ„Éù„Ç§„É≥„ÉàËá™‰Ωì„ÅØË®àÊ∏¨ÂØæË±°Â§ñ
        inprogress_name=&quot;fastapi_requests_inprogress&quot;, # Âá¶ÁêÜ‰∏≠„É™„ÇØ„Ç®„Çπ„ÉàÊï∞„ÅÆ„É°„Éà„É™„ÇØ„ÇπÂêç
        inprogress_labels=True, # Âá¶ÁêÜ‰∏≠„É™„ÇØ„Ç®„Çπ„Éà„Å´„É©„Éô„É´„Çí‰ªò‰∏é„Åô„Çã„Åã
    )

    # FastAPI„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Å´Instrumentator„ÇíÈÅ©Áî®„Åó„ÄÅ
    # /metrics „Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà„ÇíÂÖ¨Èñã„Åô„Çã
    instrumentator.instrument(app).expose(
        app, 
        include_in_schema=False, # OpenAPI„Çπ„Ç≠„Éº„Éû„Å´/metrics„ÇíÂê´„ÇÅ„Å™„ÅÑ
        should_gzip=True         # „É¨„Çπ„Éù„É≥„Çπ„ÇígzipÂúßÁ∏Æ„Åô„Çã„Åã
    )

    # Ê®ôÊ∫ñ„ÅßËøΩÂä†„Åï„Çå„Çã„É°„Éà„É™„ÇØ„Çπ„ÅÆ‰æã:
    # - fastapi_requests_total („Éè„É≥„Éâ„É©„ÄÅ„É°„ÇΩ„ÉÉ„Éâ„ÄÅ„Çπ„ÉÜ„Éº„Çø„Çπ„Ç≥„Éº„ÉâÂà•„É™„ÇØ„Ç®„Çπ„ÉàÁ∑èÊï∞)
    # - fastapi_requests_latency_seconds („É™„ÇØ„Ç®„Çπ„ÉàÂá¶ÁêÜÊôÇÈñì„ÅÆ„Éí„Çπ„Éà„Ç∞„É©„É†/„Çµ„Éû„É™)
    # - fastapi_request_size_bytes („É™„ÇØ„Ç®„Çπ„Éà„Éú„Éá„Ç£„Çµ„Ç§„Ç∫„ÅÆ„Éí„Çπ„Éà„Ç∞„É©„É†/„Çµ„Éû„É™)
    # - fastapi_response_size_bytes („É¨„Çπ„Éù„É≥„Çπ„Éú„Éá„Ç£„Çµ„Ç§„Ç∫„ÅÆ„Éí„Çπ„Éà„Ç∞„É©„É†/„Çµ„Éû„É™)
    # - fastapi_requests_inprogress (Âá¶ÁêÜ‰∏≠„É™„ÇØ„Ç®„Çπ„ÉàÊï∞)

    logger.info(&quot;Prometheus monitoring configured. Metrics available at /metrics&quot;)

# „Ç´„Çπ„Çø„É†„É°„Éà„É™„ÇØ„Çπ„Çí„Ç§„É≥„ÇØ„É™„É°„É≥„Éà„Åô„Çã‰æã („Çµ„Éº„Éì„ÇπÂ±§„Å™„Å©„Åß‰ΩøÁî®)
# def increment_user_creation_counter():
#     user_creations_total.inc()
</code></pre>
<p><code>app/main.py</code> „ÅÆ <code>lifespan</code> ÂÜÖ„Åß <code>setup_monitoring(app)</code> „ÇíÂëº„Å≥Âá∫„Åô„ÄÇ
„Åæ„Åü„ÄÅ„Ç´„Çπ„Çø„É†„É°„Éà„É™„ÇØ„Çπ„Çí‰ΩøÁî®„Åô„ÇãÂ†¥Âêà„ÅØ„ÄÅË©≤ÂΩì„Åô„ÇãÂá¶ÁêÜÁÆáÊâÄ„Åß <code>increment_user_creation_counter()</code> „ÅÆ„Çà„ÅÜ„Å™Èñ¢Êï∞„ÇíÂëº„Å≥Âá∫„Åó„Åæ„Åô„ÄÇ</p>
<hr />
<h2 id="13">13. „Çª„Ç≠„É•„É™„ÉÜ„Ç£</h2>
<p>Web „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Çí‰øùË≠∑„Åô„Çã„Åü„ÇÅ„ÅÆÂü∫Êú¨ÁöÑ„Å™„Çª„Ç≠„É•„É™„ÉÜ„Ç£Ê©üËÉΩ„Åß„Åô„ÄÇ</p>
<h3 id="v050">üö® v0.5.0 „Çª„Ç≠„É•„É™„ÉÜ„Ç£„Ç¢„ÉÉ„Éó„Éá„Éº„Éà</h3>
<p>KOIKI-FW v0.5.0„Åß„ÅØ„ÄÅÈáçË¶Å„Å™„Çª„Ç≠„É•„É™„ÉÜ„Ç£ËÑÜÂº±ÊÄß„ÅÆ‰øÆÊ≠£„ÅåÂÆüÊñΩ„Åï„Çå„Åæ„Åó„ÅüÔºö</p>
<p><strong>‰øÆÊ≠£„Åï„Çå„ÅüËÑÜÂº±ÊÄß:</strong>
- <strong>fastapi</strong>: 0.104.1 ‚Üí 0.115.13 (‰øÆÊ≠£: PYSEC-2024-38)
- <strong>python-jose</strong>: 3.3.0 ‚Üí 3.5.0 (‰øÆÊ≠£: PYSEC-2024-232, PYSEC-2024-233)<br />
- <strong>starlette</strong>: 0.27.0 ‚Üí 0.46.2 (‰øÆÊ≠£: GHSA-f96h-pmfr-66vw)</p>
<p><strong>„Åù„ÅÆ‰ªñ„ÅÆ„Çª„Ç≠„É•„É™„ÉÜ„Ç£Âº∑Âåñ:</strong>
- Python 3.13ÂØæÂøú„Å´„Çà„Çã„Çª„Ç≠„É•„É™„ÉÜ„Ç£Ê©üËÉΩ„ÅÆÂº∑Âåñ
- ‰æùÂ≠òÈñ¢‰øÇÂÖ®‰Ωì„ÅÆÊúÄÊñ∞Âåñ„Å´„Çà„Çã„Çª„Ç≠„É•„É™„ÉÜ„Ç£„É™„Çπ„ÇØ„ÅÆËªΩÊ∏õ
- „Ç®„É≥„Çø„Éº„Éó„É©„Ç§„Ç∫Âêë„Åë„Çª„Ç≠„É•„É™„ÉÜ„Ç£Áõ£Êüª„ÉÑ„Éº„É´ (pip-audit, bandit) „ÅÆÂ∞éÂÖ•</p>
<h3 id="_11">üî∞ Áî®Ë™ûËß£Ë™¨ („Çª„Ç≠„É•„É™„ÉÜ„Ç£‰∏ÄËà¨)</h3>
<ul>
<li><strong>„Çª„Ç≠„É•„É™„ÉÜ„Ç£</strong>: „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Çí‰∏çÊ≠£„Ç¢„ÇØ„Çª„Çπ„ÇÑ„Éá„Éº„ÇøÊºèÊ¥©„Åã„ÇâÂÆà„Çã„Åü„ÇÅ„ÅÆÊäÄË°ìÂÖ®Ëà¨„ÄÇ</li>
<li><strong>„É¨„Éº„Éà„É™„Éü„ÉÉ„Éà</strong>: ‰∏ÄÂÆöÊôÇÈñìÂÜÖ„Å´Ë®±ÂèØ„Åï„Çå„ÇãAPI„É™„ÇØ„Ç®„Çπ„ÉàÊï∞„ÇíÂà∂Èôê„Åó„ÄÅÁ∑èÂΩì„Åü„ÇäÊîªÊíÉ„ÇÑDoSÊîªÊíÉ„ÇíÈò≤„Åê„ÄÇ</li>
<li><strong>„Çª„Ç≠„É•„É™„ÉÜ„Ç£„Éò„ÉÉ„ÉÄ</strong>: „Éñ„É©„Ç¶„Ç∂„ÅÆ„Çª„Ç≠„É•„É™„ÉÜ„Ç£Ê©üËÉΩ„ÇíÊúâÂäπÂåñ„Åó„ÄÅXSS„ÇÑ„ÇØ„É™„ÉÉ„ÇØ„Ç∏„É£„ÉÉ„Ç≠„É≥„Ç∞„Å™„Å©„ÅÆÊîªÊíÉ„ÇíÁ∑©Âíå„Åô„ÇãHTTP„É¨„Çπ„Éù„É≥„Çπ„Éò„ÉÉ„ÉÄ„ÄÇ</li>
<li><strong>ÂÖ•Âäõ„Éê„É™„Éá„Éº„Ç∑„Éß„É≥</strong>: ‰∏çÊ≠£„Å™ÂÖ•Âäõ„Éá„Éº„Çø„Å´„Çà„ÇãËÑÜÂº±ÊÄß„ÇíÈò≤„Åê„Åü„ÇÅ„ÄÅÂÖ•ÂäõÂÄ§„ÇíÊ§úË®º„ÉªÁÑ°ÂÆ≥Âåñ„Åô„Çã„Åì„Å®„ÄÇ</li>
</ul>
<h3 id="131-slowapi">13.1 „É¨„Éº„Éà„É™„Éü„ÉÉ„Éà (slowapi)</h3>
<p><code>slowapi</code> „Çí‰ΩøÁî®„Åó„Å¶API„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà„Å∏„ÅÆ„É™„ÇØ„Ç®„Çπ„ÉàÊï∞„ÇíÂà∂Èôê„Åó„Åæ„Åô„ÄÇ</p>
<p><strong><code>libkoiki/core/rate_limiter.py</code> „ÅÆÂÆüË£Ö‰æã:</strong></p>
<pre><code class="language-python"># libkoiki/core/rate_limiter.py
from slowapi import Limiter
from slowapi.util import get_remote_address
from libkoiki.core.config import settings
import structlog

logger = structlog.get_logger(__name__)

# „É¨„Éº„Éà„É™„Éü„ÉÉ„Çø„Éº„ÅÆ„Ç∞„É≠„Éº„Éê„É´„Ç§„É≥„Çπ„Çø„É≥„Çπ
limiter = Limiter(
    key_func=get_remote_address,  # „ÇØ„É©„Ç§„Ç¢„É≥„ÉàIP„Åß„É¨„Éº„ÉàÂà∂Èôê
    default_limits=[settings.RATE_LIMIT_DEFAULT],  # „Éá„Éï„Ç©„É´„Éà„ÅÆÂà∂ÈôêÔºàË®≠ÂÆö„Åã„ÇâÔºâ
    enabled=settings.RATE_LIMIT_ENABLED,  # ÊúâÂäπ/ÁÑ°ÂäπË®≠ÂÆö
    strategy=settings.RATE_LIMIT_STRATEGY  # Âà∂ÈôêÊà¶Áï•Ôºà‰æã: fixed-windowÔºâ
)

logger.debug(
    &quot;Rate limiter initialized&quot;, 
    enabled=settings.RATE_LIMIT_ENABLED, 
    default_limits=settings.RATE_LIMIT_DEFAULT,
    strategy=settings.RATE_LIMIT_STRATEGY
)

# ‰ΩøÁî®‰æã:
# 1. „Ç∞„É≠„Éº„Éê„É´ÈÅ©Áî®Ôºàapp.add_middleware(SlowAPIMiddleware)Ôºâ
# 2. „Ç®„É≥„Éâ„Éù„Ç§„É≥„ÉàÂçò‰Ωç„ÅßÈÅ©Áî®:
#    @router.post(&quot;/&quot;)
#    @limiter.limit(&quot;5/minute&quot;)
#    async def create_item(...):
#        ...
</code></pre>
<h3 id="132">13.2 „Çª„Ç≠„É•„É™„ÉÜ„Ç£„Éò„ÉÉ„ÉÄ</h3>
<p>„Éü„Éâ„É´„Ç¶„Çß„Ç¢„Çí‰ΩøÁî®„Åó„Å¶HTTP„É¨„Çπ„Éù„É≥„Çπ„Å´„Çª„Ç≠„É•„É™„ÉÜ„Ç£Èñ¢ÈÄ£„Éò„ÉÉ„ÉÄ„ÇíËøΩÂä†„Åó„Åæ„Åô„ÄÇ</p>
<p><strong><code>libkoiki/core/middleware.py</code> „Å´ <code>SecurityHeadersMiddleware</code> „ÅÆ‰æã:</strong></p>
<pre><code class="language-python"># libkoiki/core/middleware.py
# (AuditLogMiddleware „Å®Âêå„Åò„Éï„Ç°„Ç§„É´ÂÜÖ„Åß„ÇÇËâØ„ÅÑ)
from starlette.middleware.base import BaseHTTPMiddleware, RequestResponseEndpoint
from starlette.requests import Request
from starlette.responses import Response
import structlog

logger = structlog.get_logger(__name__)

class SecurityHeadersMiddleware(BaseHTTPMiddleware):
    async def dispatch(self, request: Request, call_next: RequestResponseEndpoint) -&gt; Response:
        response = await call_next(request)

        # HTTPS„ÇíÂº∑Âà∂ (HSTS)
        response.headers[&quot;Strict-Transport-Security&quot;] = &quot;max-age=31536000; includeSubDomains&quot;

        # Content Type Sniffing Èò≤Ê≠¢
        response.headers[&quot;X-Content-Type-Options&quot;] = &quot;nosniff&quot;

        # „ÇØ„É™„ÉÉ„ÇØ„Ç∏„É£„ÉÉ„Ç≠„É≥„Ç∞Èò≤Ê≠¢
        response.headers[&quot;X-Frame-Options&quot;] = &quot;DENY&quot; # „Åæ„Åü„ÅØ &quot;SAMEORIGIN&quot;

        # „É™„Éï„Ç°„É©„Éù„É™„Ç∑„Éº („Éó„É©„Ç§„Éê„Ç∑„ÉºÂêë‰∏ä)
        response.headers[&quot;Referrer-Policy&quot;] = &quot;strict-origin-when-cross-origin&quot; # Êé®Â•®ÂÄ§„ÅÆ‰∏Ä„Å§

        # Content-Security-Policy (CSP) „ÅØ„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅÆ„Ç≥„É≥„ÉÜ„É≥„ÉÑ„Å´Âêà„Çè„Åõ„Å¶ÊÖéÈáç„Å´Ë®≠ÂÆö
        # ‰æã: „Ç§„É≥„É©„Ç§„É≥„Çπ„ÇØ„É™„Éó„Éà„ÇÑeval„ÇíÁ¶ÅÊ≠¢„Åó„ÄÅ„Çπ„ÇØ„É™„Éó„Éà„ÇÑ„Çπ„Çø„Ç§„É´„ÅØÂêå‰∏Ä„Ç™„É™„Ç∏„É≥„Åã„Çâ„ÅÆ„ÅøË®±ÂèØ
        # response.headers[&quot;Content-Security-Policy&quot;] = &quot;default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; object-src 'none'; frame-ancestors 'none';&quot;

        # Permissions-Policy (Êóß Feature-Policy) - „Éñ„É©„Ç¶„Ç∂Ê©üËÉΩ„Å∏„ÅÆ„Ç¢„ÇØ„Çª„ÇπÂà∂Âæ°
        # ‰æã: „Éû„Ç§„ÇØ„ÄÅ„Ç´„É°„É©„ÄÅ‰ΩçÁΩÆÊÉÖÂ†±„Å∏„ÅÆ„Ç¢„ÇØ„Çª„Çπ„Çí„Éá„Éï„Ç©„É´„Éà„ÅßÁÑ°ÂäπÂåñ
        # response.headers[&quot;Permissions-Policy&quot;] = &quot;geolocation=(), microphone=(), camera=()&quot;

        return response
</code></pre>
<p><code>app/main.py</code> „Åß <code>app.add_middleware(SecurityHeadersMiddleware)</code> „Å®„Åó„Å¶ÁôªÈå≤„ÄÇCSP„ÅÆË®≠ÂÆö„ÅØÁâπ„Å´Ê≥®ÊÑè„ÅåÂøÖË¶Å„Åß„ÄÅ„Éï„É≠„É≥„Éà„Ç®„É≥„Éâ„ÅÆÊßãÊàê„ÇÑ‰ΩøÁî®„Åô„ÇãÂ§ñÈÉ®„É™„ÇΩ„Éº„Çπ„Å´„Çà„Å£„Å¶ÈÅ©Âàá„Å´Ë™øÊï¥„Åô„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ</p>
<h3 id="133">13.3 ÂÖ•Âäõ„Éê„É™„Éá„Éº„Ç∑„Éß„É≥</h3>
<ul>
<li><strong>Pydantic</strong>: APIÂ±§„Åß„ÅÆÂûã„ÉÅ„Çß„ÉÉ„ÇØ„Å®ÂΩ¢ÂºèÊ§úË®ºÔºà„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ„ÄÅURL„ÄÅÊï∞ÂÄ§ÁØÑÂõ≤„Å™„Å©Ôºâ„ÄÇ„Çπ„Ç≠„Éº„ÉûÂÆöÁæ©„Åß <code>Field</code> „Çí‰Ωø„Å£„Å¶Ë©≥Á¥∞„Å™„Éê„É™„Éá„Éº„Ç∑„Éß„É≥„É´„Éº„É´ÔºàÊúÄÂ∞è/ÊúÄÂ§ßÈï∑„ÄÅÊ≠£Ë¶èË°®Áèæ„Éë„Çø„Éº„É≥„Å™„Å©Ôºâ„ÇíË®≠ÂÆö„Åß„Åç„Åæ„Åô„ÄÇ</li>
<li><strong>„Çµ„Éº„Éì„ÇπÂ±§</strong>: „Éì„Ç∏„Éç„Çπ„É´„Éº„É´„Å´Âü∫„Å•„ÅÑ„Åü„Çà„ÇäË§áÈõë„Å™Ê§úË®ºÔºà‰æã: Èñ¢ÈÄ£„Éá„Éº„Çø„ÅÆÂ≠òÂú®„ÉÅ„Çß„ÉÉ„ÇØ„ÄÅÁä∂ÊÖãÈÅ∑Áßª„ÅÆÂ¶•ÂΩìÊÄßÔºâ„ÄÇ„Ç´„Çπ„Çø„É†‰æãÂ§ñ (<code>ValidationException</code>) „Åß„Ç®„É©„Éº„ÇíÊòéÁ§∫ÁöÑ„Å´ÈÄöÁü•„Åó„Åæ„Åô„ÄÇ</li>
<li><strong>„Çµ„Éã„Çø„Ç§„Ç∫</strong>:<ul>
<li><strong>SQL„Ç§„É≥„Ç∏„Çß„ÇØ„Ç∑„Éß„É≥</strong>: SQLAlchemy„Å™„Å©„ÅÆORM„ÅØ„ÄÅ„Éë„É©„É°„Éº„ÇøÂåñ„ÇØ„Ç®„É™Ôºà„Éó„É™„Éö„Ç¢„Éâ„Çπ„ÉÜ„Éº„Éà„É°„É≥„ÉàÔºâ„ÇíÂÜÖÈÉ®„Åß‰ΩøÁî®„Åô„Çã„Åü„ÇÅ„ÄÅÈÅ©Âàá„Å´‰ΩøÁî®„Åï„Çå„Å¶„ÅÑ„Çå„Å∞Èò≤Âæ°„Åß„Åç„Åæ„Åô„ÄÇÁîü„ÅÆSQL„Çí‰Ωø„ÅÜÂ†¥Âêà„ÅØÂøÖ„Åö„Éë„É©„É°„Éº„ÇøÂåñ„Åó„Åæ„Åô„ÄÇ</li>
<li><strong>XSS („ÇØ„É≠„Çπ„Çµ„Ç§„Éà„Çπ„ÇØ„É™„Éó„ÉÜ„Ç£„É≥„Ç∞)</strong>:<ul>
<li>API„É¨„Çπ„Éù„É≥„Çπ„Å®„Åó„Å¶JSON„ÇíËøî„ÅôÂ†¥Âêà„ÅØ„ÄÅ„ÇØ„É©„Ç§„Ç¢„É≥„ÉàÂÅ¥Ôºà„Éï„É≠„É≥„Éà„Ç®„É≥„ÉâÔºâ„ÅåHTML„Å´„Éá„Éº„Çø„ÇíÂüã„ÇÅËæº„ÇÄÈöõ„ÅÆÂá¶ÁêÜ„ÅåÈáçË¶Å„Åß„Åô„ÄÇReact, Vue„Å™„Å©„ÅÆ„É¢„ÉÄ„É≥„Éï„É¨„Éº„É†„ÉØ„Éº„ÇØ„ÅØÂü∫Êú¨ÁöÑ„Å´ÂÆâÂÖ®„Å™ÊñπÊ≥ï„Åß„Éá„Éº„Çø„Çí„É¨„É≥„ÉÄ„É™„É≥„Ç∞„Åó„Åæ„Åô„ÄÇ</li>
<li>„Çµ„Éº„Éê„Éº„Çµ„Ç§„Éâ„ÅßHTML„ÇíÁîüÊàê„Åô„ÇãÂ†¥ÂêàÔºàJinja2„Å™„Å©Ôºâ„ÄÅ„ÉÜ„É≥„Éó„É¨„Éº„Éà„Ç®„É≥„Ç∏„É≥„ÅåÊèê‰æõ„Åô„ÇãËá™Âãï„Ç®„Çπ„Ç±„Éº„ÉóÊ©üËÉΩ„ÇíÂøÖ„ÅöÊúâÂäπ„Å´„Åó„Åæ„Åô„ÄÇ</li>
</ul>
</li>
<li><strong>„Åù„ÅÆ‰ªñ</strong>: „Éï„Ç°„Ç§„É´„Ç¢„ÉÉ„Éó„É≠„Éº„ÉâÊôÇ„ÅÆ„Éï„Ç°„Ç§„É´Âêç„ÇÑÁ®ÆÈ°û„ÄÅÂ§ñÈÉ®„Ç≥„Éû„É≥„ÉâÂÆüË°åÊôÇ„ÅÆÂºïÊï∞„Å™„Å©„ÄÅ„É¶„Éº„Ç∂„ÉºÂÖ•Âäõ„ÇíÂÖÉ„Å´„Åô„ÇãÂ†¥Âêà„ÅØÂ∏∏„Å´Ê§úË®º„Å®ÁÑ°ÂÆ≥Âåñ„ÇíË°å„ÅÑ„Åæ„Åô„ÄÇ</li>
</ul>
</li>
</ul>
<h3 id="_12">üî∞ Áî®Ë™ûËß£Ë™¨ („Éë„Çπ„ÉØ„Éº„Éâ„Çª„Ç≠„É•„É™„ÉÜ„Ç£)</h3>
<ul>
<li><strong>„Éë„Çπ„ÉØ„Éº„Éâ„Éù„É™„Ç∑„Éº</strong>: ÂÆâÂÖ®„Å™„Éë„Çπ„ÉØ„Éº„ÉâË®≠ÂÆö„Çí„É¶„Éº„Ç∂„Éº„Å´Âº∑Âà∂„Åô„Çã„Åü„ÇÅ„ÅÆË¶èÂâáÁæ§ÔºàÈï∑„Åï„ÄÅÊñáÂ≠óÁ®Æ„Å™„Å©Ôºâ„ÄÇ</li>
<li><strong>„Éè„ÉÉ„Ç∑„É•Âåñ</strong>: „Éë„Çπ„ÉØ„Éº„Éâ„ÇíÂÖÉ„ÅÆÂÄ§„Å´Êàª„Åõ„Å™„ÅÑÔºà„Åæ„Åü„ÅØÊ•µ„ÇÅ„Å¶Âõ∞Èõ£„Å™Ôºâ‰∏ÄÊñπÂêëÈñ¢Êï∞„ÅßÂ§âÊèõ„Åô„Çã„Åì„Å®„ÄÇ‰øùÂ≠òÊôÇ„ÅØÂøÖ„Åö„Éè„ÉÉ„Ç∑„É•Âåñ„Åï„Çå„Åü„Éë„Çπ„ÉØ„Éº„Éâ„ÇíÊ†ºÁ¥ç„Åó„Åæ„Åô„ÄÇ</li>
<li><strong>„ÇΩ„É´„Éà</strong>: „Éè„ÉÉ„Ç∑„É•Âåñ„ÅÆÈöõ„Å´„Éë„Çπ„ÉØ„Éº„ÉâÊØé„Å´‰ªòÂä†„Åï„Çå„Çã„É©„É≥„ÉÄ„É†„Å™„Éá„Éº„Çø„ÄÇÂêå„Åò„Éë„Çπ„ÉØ„Éº„Éâ„Åß„ÇÇÁï∞„Å™„Çã„Éè„ÉÉ„Ç∑„É•ÂÄ§„ÅåÁîüÊàê„Åï„Çå„ÄÅ„É¨„Ç§„É≥„Éú„Éº„ÉÜ„Éº„Éñ„É´ÊîªÊíÉ„ÇíÈò≤„Åé„Åæ„Åô„ÄÇ</li>
</ul>
<h3 id="134">13.4 „Éë„Çπ„ÉØ„Éº„Éâ„Éù„É™„Ç∑„Éº</h3>
<p>ÂÆâÂÖ®„Å™„Éë„Çπ„ÉØ„Éº„ÉâË®≠ÂÆö„ÇíÂº∑Âà∂„Åó„Åæ„Åô„ÄÇ</p>
<ul>
<li><strong>ÂÆüË£Ö</strong>: „Éë„Çπ„ÉØ„Éº„ÉâË®≠ÂÆö„ÉªÂ§âÊõ¥API„ÇíÂèó„Åë‰ªò„Åë„Çã„Çµ„Éº„Éì„ÇπÂ±§ (<code>UserService</code>) „Åß„Éù„É™„Ç∑„Éº„Çí„ÉÅ„Çß„ÉÉ„ÇØ„Åó„Åæ„Åô„ÄÇ</li>
<li><strong>„Éò„É´„Éë„ÉºÈñ¢Êï∞</strong>: <code>libkoiki/core/security.py</code> „ÅÆ <code>check_password_complexity</code> „ÅßÂü∫Êú¨ÁöÑ„Å™Ë§áÈõëÊÄßÔºàÈï∑„Åï„ÄÅÊñáÂ≠óÁ®ÆÔºâ„Çí„ÉÅ„Çß„ÉÉ„ÇØ„ÄÇ</li>
<li><strong>„Éù„É™„Ç∑„Éº‰æã</strong>:<ul>
<li>ÊúÄÂ∞èÊñáÂ≠óÊï∞Ôºà‰æã: 12ÊñáÂ≠ó‰ª•‰∏ä„ÇíÊé®Â•®Ôºâ</li>
<li>ÊñáÂ≠óÁ®ÆÔºàÂ§ßÊñáÂ≠ó„ÄÅÂ∞èÊñáÂ≠ó„ÄÅÊï∞Â≠ó„ÄÅË®òÂè∑„Çí„Åù„Çå„Åû„Çå1„Å§‰ª•‰∏äÂê´„ÇÄÔºâ</li>
<li>„Çà„Åè‰Ωø„Çè„Çå„Çã„Éë„Çπ„ÉØ„Éº„Éâ„ÅÆÁ¶ÅÊ≠¢ÔºàËæûÊõ∏ÊîªÊíÉÂØæÁ≠ñ„ÄÅHave I Been Pwned APIÈÄ£Êê∫„Å™„Å©Ôºâ</li>
<li>„Éë„Çπ„ÉØ„Éº„ÉâÂ±•Ê≠¥ÔºàÈÅéÂéªNÂõû„ÅÆ„Éë„Çπ„ÉØ„Éº„Éâ„ÅÆÂÜçÂà©Áî®Á¶ÅÊ≠¢Ôºâ</li>
<li>„Ç¢„Ç´„Ç¶„É≥„Éà„É≠„ÉÉ„ÇØ„Ç¢„Ç¶„ÉàÔºà„É≠„Ç∞„Ç§„É≥Ë©¶Ë°åÂõûÊï∞Âà∂Èôê„ÇíË∂Ö„Åà„ÅüÂ†¥Âêà„Å´‰∏ÄÊôÇÁöÑ„Å´„Ç¢„Ç´„Ç¶„É≥„Éà„Çí„É≠„ÉÉ„ÇØÔºâ</li>
</ul>
</li>
</ul>
<p><strong><code>libkoiki/core/security.py</code> „ÅÆ„Éë„Çπ„ÉØ„Éº„Éâ„Éù„É™„Ç∑„Éº„ÉÅ„Çß„ÉÉ„ÇØ (ÂÜçÊé≤):</strong></p>
<pre><code class="language-python"># libkoiki/core/security.py „ÅÆ check_password_complexity Èñ¢Êï∞
import re
def check_password_complexity(password: str) -&gt; bool:
    &quot;&quot;&quot;„Éë„Çπ„ÉØ„Éº„Éâ„ÅåË§áÈõëÊÄßË¶Å‰ª∂„ÇíÊ∫Ä„Åü„Åó„Å¶„ÅÑ„Çã„ÅãÊ§úË®º„Åó„Åæ„Åô&quot;&quot;&quot;
    if len(password) &lt; 8: return False
    if not re.search(r&quot;[a-z]&quot;, password): return False
    if not re.search(r&quot;[A-Z]&quot;, password): return False
    if not re.search(r&quot;\d&quot;, password): return False
    if not re.search(r&quot;[!@#$%^&amp;*(),.?\&quot;:{}|&lt;&gt;]&quot;, password): return False
    return True
</code></pre>
<hr />
<h2 id="14">14. „ÉÜ„Çπ„ÉàÊà¶Áï•„Å®„ÉÜ„Çπ„ÉàÂÆüË£Ö</h2>
<p>ÂìÅË≥™Á¢∫‰øù„Å®ÂÆâÂÖ®„Å™ÈñãÁô∫„ÅÆ„Åü„ÇÅ„Å´„ÉÜ„Çπ„Éà„ÅØ‰∏çÂèØÊ¨†„Åß„Åô„ÄÇ<code>pytest</code> „Å® <code>httpx.AsyncClient</code> „Çí‰ΩøÁî®„Åó„Åæ„Åô„ÄÇ</p>
<h3 id="_13">üî∞ Áî®Ë™ûËß£Ë™¨ („ÉÜ„Çπ„Éà„ÅÆÁ®ÆÈ°û)</h3>
<ul>
<li><strong>Âçò‰Ωì„ÉÜ„Çπ„Éà (Unit Test)</strong>: ÂÄã„ÄÖ„ÅÆÈñ¢Êï∞„ÇÑ„ÇØ„É©„Çπ„Å™„Å©„ÄÅÊúÄÂ∞èÂçò‰Ωç„ÅÆÊ©üËÉΩ„ÇíÈöîÈõ¢„Åó„Å¶Ê§úË®º„ÄÇ‰æùÂ≠òÊÄß„ÅØ„É¢„ÉÉ„ÇØÂåñ„ÄÇ</li>
<li><strong>Áµ±Âêà„ÉÜ„Çπ„Éà (Integration Test)</strong>: Ë§áÊï∞„ÅÆ„Ç≥„É≥„Éù„Éº„Éç„É≥„ÉàÔºàAPI„ÄÅ„Çµ„Éº„Éì„Çπ„ÄÅDB„Å™„Å©Ôºâ„ÇíÈÄ£Êê∫„Åï„Åõ„Å¶Ê§úË®º„ÄÇ</li>
<li><strong>E2E„ÉÜ„Çπ„Éà (End-to-End Test)</strong>: ÂÆüÈöõ„ÅÆ„É¶„Éº„Ç∂„ÉºÊìç‰Ωú„ÇíÊ®°ÂÄ£„Åó„ÄÅ„Ç∑„Çπ„ÉÜ„É†ÂÖ®‰Ωì„ÇíÊ§úË®º„ÄÇ</li>
</ul>
<h3 id="141-conftestpy">14.1 „ÉÜ„Çπ„ÉàË®≠ÂÆö (conftest.py)</h3>
<p><code>pytest</code> „ÅÆË®≠ÂÆö„Å®ÂÖ±ÈÄö„Éï„Ç£„ÇØ„Çπ„ÉÅ„É£„Çí <code>tests/conftest.py</code> „ÅßÂÆöÁæ©„ÄÇ</p>
<p><strong><code>tests/conftest.py</code> „ÅÆÂÆüË£Ö‰æã:</strong></p>
<pre><code class="language-python"># tests/conftest.py
import asyncio
import os
from typing import AsyncGenerator, Generator
import pytest
import pytest_asyncio
from httpx import AsyncClient
from sqlalchemy.ext.asyncio import create_async_engine, AsyncSession
from sqlalchemy.orm import sessionmaker
from sqlalchemy.pool import NullPool # „ÉÜ„Çπ„Éà„Åß„ÅØNullPool„Çí‰Ωø„ÅÜ„Åì„Å®„ÅåÂ§ö„ÅÑ

from libkoiki.db.base import Base as CombinedBase # libkoiki„Å®app„ÅßÂÖ±Êúâ„Åï„Çå„ÇãBase
from app.main import app # FastAPI„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Ç§„É≥„Çπ„Çø„É≥„Çπ
from libkoiki.db.session import get_db # DIÁî®„ÅÆDB„Çª„ÉÉ„Ç∑„Éß„É≥ÂèñÂæóÈñ¢Êï∞

# „ÉÜ„Çπ„ÉàÁî®„ÅÆDB URL (Áí∞Â¢ÉÂ§âÊï∞„ÇÑ„ÉÜ„Çπ„ÉàÂ∞ÇÁî®Ë®≠ÂÆö„Éï„Ç°„Ç§„É´„Åã„ÇâÂèñÂæóÊé®Â•®)
DEFAULT_TEST_DATABASE_URL = &quot;postgresql+asyncpg://test_user:test_password@localhost:5432/koiki_test_db&quot;

# --- Database Fixtures ---
@pytest_asyncio.fixture(scope=&quot;session&quot;)
async def db_engine():
    &quot;&quot;&quot;„Çª„ÉÉ„Ç∑„Éß„É≥„Çπ„Ç≥„Éº„Éó„ÅÆ„ÉÜ„Çπ„ÉàDB„Ç®„É≥„Ç∏„É≥„ÄÇ„ÉÜ„Çπ„ÉàÂÆüË°åÂâç„Å´„ÉÜ„Éº„Éñ„É´„Çí‰ΩúÊàê„Åó„ÄÅÁµÇ‰∫ÜÂæå„Å´Á†¥Ê£Ñ„ÄÇ&quot;&quot;&quot;
    # Áí∞Â¢ÉÂ§âÊï∞„Åã„Çâ„ÉÜ„Çπ„ÉàDB URL„ÇíÂèñÂæó„ÄÅ„Å™„Åë„Çå„Å∞„Éá„Éï„Ç©„É´„ÉàÂÄ§
    test_db_url = os.getenv(&quot;TEST_DATABASE_URL&quot;, DEFAULT_TEST_DATABASE_URL)

    # „ÉÜ„Çπ„Éà„Åß„ÅØ„Ç≥„Éç„ÇØ„Ç∑„Éß„É≥„Éó„Éº„É´„ÇíÁÑ°ÂäπÂåñ„Åô„Çã„Åì„Å®„ÅåÊé®Â•®„Åï„Çå„ÇãÂ†¥Âêà„Åå„ÅÇ„Çã
    engine = create_async_engine(test_db_url, echo=False, poolclass=NullPool)

    async with engine.begin() as conn:
        # Êó¢Â≠ò„ÅÆ„ÉÜ„Éº„Éñ„É´„ÇíÂÖ®„Å¶ÂâäÈô§ (ÂÆâÂÖ®„ÅÆ„Åü„ÇÅ)
        await conn.run_sync(CombinedBase.metadata.drop_all)
        # „Çπ„Ç≠„Éº„Éû„Å´Âü∫„Å•„ÅÑ„Å¶„ÉÜ„Éº„Éñ„É´„ÇíÂÜç‰ΩúÊàê
        await conn.run_sync(CombinedBase.metadata.create_all)

    yield engine # „ÉÜ„Çπ„ÉàÂÆüË°å‰∏≠„ÅØ„Ç®„É≥„Ç∏„É≥„ÇíÊèê‰æõ

    # „ÉÜ„Çπ„ÉàÁµÇ‰∫ÜÂæå„Å´„Ç®„É≥„Ç∏„É≥„ÇíÁ†¥Ê£Ñ
    await engine.dispose()

@pytest_asyncio.fixture(scope=&quot;function&quot;)
async def db_session(db_engine) -&gt; AsyncGenerator[AsyncSession, None]:
    &quot;&quot;&quot;Èñ¢Êï∞„Çπ„Ç≥„Éº„Éó„ÅÆ„ÉÜ„Çπ„ÉàDB„Çª„ÉÉ„Ç∑„Éß„É≥„ÄÇÂêÑ„ÉÜ„Çπ„ÉàÂæå„Å´„É≠„Éº„É´„Éê„ÉÉ„ÇØ„Åô„Çã„ÄÇ&quot;&quot;&quot;
    # „ÉÜ„Çπ„ÉàÁî®„ÅÆ„Çª„ÉÉ„Ç∑„Éß„É≥„Éï„Ç°„ÇØ„Éà„É™„Çí‰ΩúÊàê
    AsyncTestingSessionLocal = sessionmaker(
        bind=db_engine,
        class_=AsyncSession,
        autocommit=False,
        autoflush=False,
        expire_on_commit=False # „ÉÜ„Çπ„Éà„Åß„ÅØFalseÊé®Â•®
    )
    async with AsyncTestingSessionLocal() as session:
        # ÂêÑ„ÉÜ„Çπ„Éà„Çí„Éç„Çπ„Éà„Åï„Çå„Åü„Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥ÂÜÖ„ÅßÂÆüË°å
        # „Åì„Çå„Å´„Çà„Çä„ÄÅ„ÉÜ„Çπ„ÉàÁµÇ‰∫ÜÊôÇ„Å´„É≠„Éº„É´„Éê„ÉÉ„ÇØ„Åó„Å¶DBÁä∂ÊÖã„ÇíÂÖÉ„Å´Êàª„Åõ„Çã
        await session.begin_nested() 
        yield session
        # „ÉÜ„Çπ„Éà„Åß„Ç≥„Éü„ÉÉ„Éà„Åï„Çå„Å¶„ÇÇ„ÄÅ„Åì„ÅÆ„É≠„Éº„É´„Éê„ÉÉ„ÇØ„ÅßÂÖÉ„Å´Êàª„Çã
        await session.rollback() 
        await session.close()


# --- HTTP Client Fixture ---
@pytest_asyncio.fixture(scope=&quot;function&quot;)
async def client(db_session: AsyncSession) -&gt; AsyncGenerator[AsyncClient, None]:
    &quot;&quot;&quot;ÈùûÂêåÊúüHTTP„ÉÜ„Çπ„Éà„ÇØ„É©„Ç§„Ç¢„É≥„Éà„ÄÇDB„Çª„ÉÉ„Ç∑„Éß„É≥„Çí„ÉÜ„Çπ„ÉàÁî®„Å´„Ç™„Éº„Éê„Éº„É©„Ç§„Éâ„ÄÇ&quot;&quot;&quot;

    # get_db ‰æùÂ≠òÊÄß„Çí„ÉÜ„Çπ„ÉàÁî®„Çª„ÉÉ„Ç∑„Éß„É≥„Åß„Ç™„Éº„Éê„Éº„É©„Ç§„Éâ„Åô„ÇãÈñ¢Êï∞
    async def override_get_db() -&gt; AsyncGenerator[AsyncSession, None]:
        yield db_session

    # FastAPI„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅÆ‰æùÂ≠òÊÄß„Çí„Ç™„Éº„Éê„Éº„É©„Ç§„Éâ
    app.dependency_overrides[get_db] = override_get_db

    # httpx.AsyncClient „Çí„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Ç§„É≥„Çπ„Çø„É≥„Çπ„Å®ÂÖ±„Å´ÂàùÊúüÂåñ
    async with AsyncClient(app=app, base_url=&quot;http://testserver&quot;) as async_client: # base_url„ÅØ‰ªªÊÑè
        yield async_client

    # „ÉÜ„Çπ„ÉàÁµÇ‰∫ÜÂæå„Å´„Ç™„Éº„Éê„Éº„É©„Ç§„Éâ„ÇíÂÖÉ„Å´Êàª„Åô („ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó)
    del app.dependency_overrides[get_db]

# --- Ë™çË®ºÊ∏à„Åø„ÇØ„É©„Ç§„Ç¢„É≥„Éà„ÅÆ„Éï„Ç£„ÇØ„Çπ„ÉÅ„É£ („Ç™„Éó„Ç∑„Éß„É≥) ---
from libkoiki.services.user_service import UserService
from libkoiki.repositories.user_repository import UserRepository
from libkoiki.schemas.user import UserCreate
from libkoiki.models.user import UserModel
from libkoiki.core.security import create_access_token

@pytest_asyncio.fixture(scope=&quot;function&quot;)
async def authenticated_user(db_session: AsyncSession) -&gt; UserModel:
    &quot;&quot;&quot;„ÉÜ„Çπ„ÉàÁî®„ÅÆË™çË®ºÊ∏à„Åø„É¶„Éº„Ç∂„Éº„Çí‰ΩúÊàê„Åó„ÄÅËøî„Åô„Éï„Ç£„ÇØ„Çπ„ÉÅ„É£„ÄÇ&quot;&quot;&quot;
    user_repo = UserRepository() # „É™„Éù„Ç∏„Éà„É™„Çí„Ç§„É≥„Çπ„Çø„É≥„ÇπÂåñ
    user_service = UserService(repository=user_repo) # „Çµ„Éº„Éì„Çπ„Çí„Ç§„É≥„Çπ„Çø„É≥„ÇπÂåñ

    test_user_email = &quot;authtest@example.com&quot;
    test_user_password = &quot;AuthTestP@sswOrd1!&quot;
    # Êó¢Â≠ò„É¶„Éº„Ç∂„Éº„Åå„ÅÑ„Çå„Å∞ÂâäÈô§„Åæ„Åü„ÅØÂèñÂæó (ÂÜ™Á≠âÊÄß„ÅÆ„Åü„ÇÅ)
    user_repo.set_session(db_session)
    existing_user = await user_repo.get_by_email(test_user_email)
    if existing_user:
        # Êó¢Â≠ò„É¶„Éº„Ç∂„Éº„Çí‰ΩøÁî®
        return existing_user

    user_data = UserCreate(email=test_user_email, password=test_user_password, full_name=&quot;Auth Test User&quot;)
    user = await user_service.create_user(user_in=user_data, db=db_session)
    return user

@pytest_asyncio.fixture(scope=&quot;function&quot;)
async def authenticated_client(client: AsyncClient, authenticated_user: UserModel):
    &quot;&quot;&quot;Ë™çË®ºÊ∏à„Åø„É¶„Éº„Ç∂„Éº„ÅÆ„Éà„Éº„ÇØ„É≥„Çí„Éò„ÉÉ„ÉÄ„Éº„Å´Ë®≠ÂÆö„Åó„ÅüHTTP„ÇØ„É©„Ç§„Ç¢„É≥„Éà„ÇíËøî„Åô„ÄÇ&quot;&quot;&quot;
    token = create_access_token(subject=authenticated_user.id)
    client.headers[&quot;Authorization&quot;] = f&quot;Bearer {token}&quot;
    yield client
    # ÂæåÂá¶ÁêÜ („Éò„ÉÉ„ÉÄ„ÉºÂâäÈô§„Å™„Å©)
    del client.headers[&quot;Authorization&quot;]
</code></pre>
<h3 id="142">14.2 Âçò‰Ωì„ÉÜ„Çπ„Éà‰æã</h3>
<p>„Çµ„Éº„Éì„ÇπÂ±§„ÅÆ„É≠„Ç∏„ÉÉ„ÇØ„Å™„Å©„Çí„ÄÅ‰æùÂ≠òÊÄß„Çí„É¢„ÉÉ„ÇØÂåñ (<code>unittest.mock.AsyncMock</code>) „Åó„Å¶„ÉÜ„Çπ„Éà„Åó„Åæ„Åô„ÄÇ</p>
<p><strong><code>tests/unit/services/test_app_todo_service.py</code> „ÅÆÂÆüË£Ö‰æã:</strong></p>
<pre><code class="language-python"># tests/unit/services/test_app_todo_service.py
import pytest
from unittest.mock import AsyncMock, MagicMock, patch
from sqlalchemy.ext.asyncio import AsyncSession
import structlog

from app.services.todo_service import TodoService
from app.repositories.todo_repository import TodoRepository # „É¢„ÉÉ„ÇØÂØæË±°
from app.models.todo_model import TodoModel # Ëøî„ÇäÂÄ§„ÅÆÂûã„Å®„Åó„Å¶‰ΩøÁî®
from app.schemas.todo_schema import TodoCreateSchema, TodoUpdateSchema
from libkoiki.core.exceptions import ResourceNotFoundException, AuthorizationException # ‰æãÂ§ñ„ÅÆ„ÉÜ„Çπ„ÉàÁî®

# „ÉÜ„Çπ„ÉàÁî®„Å´„É≠„Ç¨„Éº„Çí„É¢„ÉÉ„ÇØ
@pytest.fixture(autouse=True)
def mock_structlog():
    with patch('structlog.get_logger'):
        yield

@pytest.fixture
def mock_todo_repo() -&gt; MagicMock:
    repo = MagicMock(spec=TodoRepository) # spec„Åß„É°„ÇΩ„ÉÉ„ÉâÂ≠òÂú®„ÉÅ„Çß„ÉÉ„ÇØ
    repo.set_session = MagicMock() # set_session„ÇÇ„É¢„ÉÉ„ÇØÂåñ
    repo.create = AsyncMock()      # DBÊìç‰Ωú„É°„ÇΩ„ÉÉ„Éâ„ÅØAsyncMock
    repo.get = AsyncMock()
    repo.get_multi_by_owner = AsyncMock()
    repo.update = AsyncMock()
    repo.delete = AsyncMock()
    return repo

@pytest.fixture
def mock_db_session() -&gt; AsyncMock:
    session = AsyncMock(spec=AsyncSession)
    # „Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥„Éá„Ç≥„É¨„Éº„Çø„Åå `session.begin()` „ÇíÂëº„Å≥Âá∫„Åô„Åü„ÇÅ„ÄÅ„Åù„ÅÆ„É¢„ÉÉ„ÇØ„ÇÇÁî®ÊÑè
    # __aenter__ „Å® __aexit__ „ÇíÊåÅ„Å§„Ç≥„É≥„ÉÜ„Ç≠„Çπ„Éà„Éû„Éç„Éº„Ç∏„É£„ÇíËøî„Åô„Çà„ÅÜ„Å´„Åô„Çã
    mock_transaction_context = AsyncMock()
    mock_transaction_context.__aenter__ = AsyncMock(return_value=None) # begin() „ÅÆ‰∏≠Ë∫´
    mock_transaction_context.__aexit__ = AsyncMock(return_value=None)  # commit/rollback
    session.begin = MagicMock(return_value=mock_transaction_context) # begin()„Åå„Ç≥„É≥„ÉÜ„Ç≠„Çπ„Éà„Éû„Éç„Éº„Ç∏„É£„ÇíËøî„Åô
    session.in_transaction = MagicMock(return_value=False) # ÈÄöÂ∏∏„ÅØ„Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥Â§ñ„Åã„ÇâÈñãÂßã
    return session

@pytest.fixture
def todo_service(mock_todo_repo: TodoRepository) -&gt; TodoService:
    return TodoService(repository=mock_todo_repo)

@pytest.mark.asyncio
async def test_create_todo_success(
    todo_service: TodoService, 
    mock_todo_repo: MagicMock,
    mock_db_session: AsyncMock
):
    &quot;&quot;&quot;ToDo‰ΩúÊàê„ÅåÊàêÂäü„Åô„Çã„Ç±„Éº„Çπ„ÅÆÂçò‰Ωì„ÉÜ„Çπ„Éà&quot;&quot;&quot;
    todo_data = TodoCreateSchema(title=&quot;Unit Test Todo&quot;, description=&quot;Test description&quot;)
    owner_id = 1

    # „É™„Éù„Ç∏„Éà„É™„ÅÆcreate„É°„ÇΩ„ÉÉ„Éâ„ÅåËøî„Åô„ÉÄ„Éü„Éº„ÅÆTodoModel„Ç§„É≥„Çπ„Çø„É≥„Çπ
    expected_created_todo = TodoModel(id=1, title=todo_data.title, description=todo_data.description, owner_id=owner_id, completed=False)
    mock_todo_repo.create.return_value = expected_created_todo

    # @transactional „Éá„Ç≥„É¨„Éº„Çø„ÇíËÄÉÊÖÆ„Åó„ÄÅdb„Çª„ÉÉ„Ç∑„Éß„É≥„ÇíÊ∏°„Åô
    # „Éá„Ç≥„É¨„Éº„ÇøÂÜÖ„ÅÆ„É≠„Ç¨„Éº„Çí„É¢„ÉÉ„ÇØÂåñ („Ç™„Éó„Ç∑„Éß„É≥)
    with patch('libkoiki.core.transaction.logger'):
        created_todo = await todo_service.create_todo(todo_data=todo_data, db=mock_db_session, owner_id=owner_id)

    assert created_todo is not None
    assert created_todo.id == 1
    assert created_todo.title == &quot;Unit Test Todo&quot;
    assert created_todo.owner_id == owner_id

    # „É™„Éù„Ç∏„Éà„É™„É°„ÇΩ„ÉÉ„Éâ„ÅÆÂëº„Å≥Âá∫„ÅóÁ¢∫Ë™ç
    mock_todo_repo.set_session.assert_called_once_with(mock_db_session)
    mock_todo_repo.create.assert_called_once()

@pytest.mark.asyncio
async def test_get_todo_by_id_and_owner_found(
    todo_service: TodoService, mock_todo_repo: MagicMock, mock_db_session: AsyncMock
):
    &quot;&quot;&quot;ID„Å®„Ç™„Éº„Éä„ÉºID„ÅßToDo„ÇíÂèñÂæó„Åó„ÄÅË¶ã„Å§„Åã„Çã„Ç±„Éº„Çπ&quot;&quot;&quot;
    todo_id = 1
    owner_id = 1
    expected_todo = TodoModel(id=todo_id, title=&quot;Test Todo&quot;, owner_id=owner_id)
    mock_todo_repo.get.return_value = expected_todo # get„É°„ÇΩ„ÉÉ„Éâ„ÅÆÊàª„ÇäÂÄ§„ÇíË®≠ÂÆö

    todo = await todo_service.get_todo_by_id_and_owner(todo_id=todo_id, owner_id=owner_id, db=mock_db_session)

    assert todo is not None
    assert todo.id == todo_id
    assert todo.owner_id == owner_id
    mock_todo_repo.set_session.assert_called_once_with(mock_db_session)
    mock_todo_repo.get.assert_called_once_with(todo_id)

@pytest.mark.asyncio
async def test_get_todo_by_id_and_owner_not_found(
    todo_service: TodoService, mock_todo_repo: MagicMock, mock_db_session: AsyncMock
):
    &quot;&quot;&quot;ToDo„ÅåË¶ã„Å§„Åã„Çâ„Å™„ÅÑ„Ç±„Éº„Çπ&quot;&quot;&quot;
    todo_id = 99
    owner_id = 1
    mock_todo_repo.get.return_value = None # get„É°„ÇΩ„ÉÉ„Éâ„ÅåNone„ÇíËøî„Åô„Çà„ÅÜ„Å´Ë®≠ÂÆö

    todo = await todo_service.get_todo_by_id_and_owner(todo_id=todo_id, owner_id=owner_id, db=mock_db_session)

    assert todo is None # „Çµ„Éº„Éì„Çπ„ÅØNone„ÇíËøî„Åó„ÄÅ„É´„Éº„Çø„Éº„Åå404„Çí„Éè„É≥„Éâ„É™„É≥„Ç∞„Åô„ÇãÊÉ≥ÂÆö

@pytest.mark.asyncio
async def test_get_todo_by_id_and_owner_unauthorized(
    todo_service: TodoService, mock_todo_repo: MagicMock, mock_db_session: AsyncMock
):
    &quot;&quot;&quot;„Ç™„Éº„Éä„Éº„ÅåÁï∞„Å™„Çã„Åü„ÇÅÊ®©Èôê„Åå„Å™„ÅÑ„Ç±„Éº„Çπ&quot;&quot;&quot;
    todo_id = 1
    correct_owner_id = 2
    requesting_owner_id = 1 # Âà•„ÅÆ„É¶„Éº„Ç∂„Éº

    # DB„Å´„ÅØToDo„ÅåÂ≠òÂú®„Åô„Çã„Åå„ÄÅ„Ç™„Éº„Éä„Éº„ÅåÁï∞„Å™„Çã
    todo_in_db = TodoModel(id=todo_id, title=&quot;Someone else's Todo&quot;, owner_id=correct_owner_id)
    mock_todo_repo.get.return_value = todo_in_db

    todo = await todo_service.get_todo_by_id_and_owner(todo_id=todo_id, owner_id=requesting_owner_id, db=mock_db_session)

    assert todo is None # „Çµ„Éº„Éì„Çπ„ÅØNone„ÇíËøî„Åó„ÄÅ„É´„Éº„Çø„Éº„Åå404/403„Çí„Éè„É≥„Éâ„É™„É≥„Ç∞
</code></pre>
<h3 id="_14">üî∞ Áî®Ë™ûËß£Ë™¨ („É¢„ÉÉ„ÇØ)</h3>
<ul>
<li><strong>„É¢„ÉÉ„ÇØ (Mock)</strong>: „ÉÜ„Çπ„ÉàÂØæË±°„ÅÆ„Ç≥„Éº„Éâ„Åå‰æùÂ≠ò„Åó„Å¶„ÅÑ„ÇãÂ§ñÈÉ®„Ç≥„É≥„Éù„Éº„Éç„É≥„ÉàÔºàDB„ÄÅÂ§ñÈÉ®API„Å™„Å©Ôºâ„ÅÆÊåØ„ÇãËàû„ÅÑ„ÇíÊ®°ÂÄ£„Åô„ÇãÂÅΩ„ÅÆ„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÄÇ„Åì„Çå„Å´„Çà„Çä„ÄÅ„ÉÜ„Çπ„Éà„ÅåÂ§ñÈÉ®Áí∞Â¢É„Å´‰æùÂ≠ò„Åõ„Åö„ÄÅÂÆüË°åÈÄüÂ∫¶„ÅåÂêë‰∏ä„Åó„ÄÅ„Ç®„É©„Éº„Ç±„Éº„Çπ„Å™„Å©ÁâπÂÆö„ÅÆ„Ç∑„Éä„É™„Ç™„ÇíÂÜçÁèæ„Åó„ÇÑ„Åô„Åè„Å™„Çä„Åæ„Åô„ÄÇ</li>
</ul>
<h3 id="143">14.3 Áµ±Âêà„ÉÜ„Çπ„Éà‰æã</h3>
<p>API„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà„Åã„ÇâDB„Åæ„Åß„ÇíÈÄ£Êê∫„Åï„Åõ„Å¶„ÉÜ„Çπ„Éà„Åó„Åæ„Åô„ÄÇ<code>client</code> „Éï„Ç£„ÇØ„Çπ„ÉÅ„É£„Çí‰ΩøÁî®„Åó„Åæ„Åô„ÄÇ</p>
<p><strong><code>tests/integration/api/test_app_todos_api.py</code> „ÅÆÂÆüË£Ö‰æã:</strong></p>
<pre><code class="language-python"># tests/integration/api/test_app_todos_api.py
import pytest
from httpx import AsyncClient
from fastapi import status
import structlog

from libkoiki.core.config import settings
from libkoiki.models.user import UserModel

# API Prefix „ÇíÂèñÂæó
API_PREFIX = settings.API_PREFIX
TODO_API_BASE_URL = f&quot;{API_PREFIX}/todos&quot; # /api/v1/todos „Å™„Å©

# „ÉÜ„Çπ„ÉàÁî®„Å´„É≠„Ç¨„Éº„Çí„É¢„ÉÉ„ÇØ
@pytest.fixture(autouse=True)
def mock_structlog():
    with pytest.MonkeyPatch.context() as mp:
        mp.setattr(structlog, &quot;get_logger&quot;, lambda *args, **kwargs: MagicMock())
        yield

@pytest.mark.asyncio
async def test_create_todo_api_success(authenticated_client: AsyncClient, authenticated_user: UserModel):
    &quot;&quot;&quot;ToDo‰ΩúÊàêAPI„ÅåÊ≠£Â∏∏„Å´Âãï‰Ωú„Åô„Çã„Ç±„Éº„Çπ (201 Created)&quot;&quot;&quot;
    todo_payload = {&quot;title&quot;: &quot;Integration Test My Todo&quot;, &quot;description&quot;: &quot;This is an integration test.&quot;}
    response = await authenticated_client.post(TODO_API_BASE_URL + &quot;/&quot;, json=todo_payload)

    assert response.status_code == status.HTTP_201_CREATED
    data = response.json()
    assert data[&quot;title&quot;] == todo_payload[&quot;title&quot;]
    assert data[&quot;description&quot;] == todo_payload[&quot;description&quot;]
    assert &quot;id&quot; in data
    assert data[&quot;completed&quot;] is False # „Éá„Éï„Ç©„É´„ÉàÂÄ§„ÅÆÁ¢∫Ë™ç
    assert data[&quot;owner_id&quot;] == authenticated_user.id # ‰ΩúÊàêËÄÖ„ÅåÊ≠£„Åó„ÅÑ„ÅãÁ¢∫Ë™ç

@pytest.mark.asyncio
async def test_create_todo_api_unauthenticated(client: AsyncClient):
    &quot;&quot;&quot;Êú™Ë™çË®º„ÅßToDo‰ΩúÊàêAPI„ÇíÂëº„Å∂„Å®„Ç®„É©„Éº (401 Unauthorized)&quot;&quot;&quot;
    todo_payload = {&quot;title&quot;: &quot;Unauthorized Todo&quot;}
    response = await client.post(TODO_API_BASE_URL + &quot;/&quot;, json=todo_payload) # auth_headers„Å™„Åó
    assert response.status_code == status.HTTP_401_UNAUTHORIZED

@pytest.mark.asyncio
async def test_get_my_todos_api_success(authenticated_client: AsyncClient, authenticated_user: UserModel):
    &quot;&quot;&quot;Ëá™ÂàÜ„ÅÆToDo‰∏ÄË¶ß„ÇíÂèñÂæó„Åô„ÇãAPI„ÅåÊ≠£Â∏∏„Å´Âãï‰Ωú„Åô„Çã„Ç±„Éº„Çπ&quot;&quot;&quot;
    # ‰∫ãÂâç„Å´„ÉÜ„Çπ„Éà„É¶„Éº„Ç∂„Éº„ÅÆToDo„Çí„ÅÑ„Åè„Å§„Åã‰ΩúÊàê („Åì„ÅÆ„ÉÜ„Çπ„ÉàÂ∞ÇÁî®)
    await authenticated_client.post(TODO_API_BASE_URL + &quot;/&quot;, json={&quot;title&quot;: &quot;My Todo Item 1&quot;})
    await authenticated_client.post(TODO_API_BASE_URL + &quot;/&quot;, json={&quot;title&quot;: &quot;My Todo Item 2&quot;})

    response = await authenticated_client.get(TODO_API_BASE_URL + &quot;/&quot;)
    assert response.status_code == status.HTTP_200_OK
    todos = response.json()
    assert isinstance(todos, list)
    assert len(todos) &gt;= 2 # Â∞ë„Å™„Åè„Å®„ÇÇ2„Å§„ÅØ„ÅÇ„Çã„ÅØ„Åö
    for todo in todos:
        assert todo[&quot;owner_id&quot;] == authenticated_user.id # Ëá™ÂàÜ„ÅÆToDo„ÅÆ„Åø„ÅåËøî„Åï„Çå„Å¶„ÅÑ„Çã„Åì„Å®„ÇíÁ¢∫Ë™ç

@pytest.mark.asyncio
async def test_get_todo_by_id_api_success(authenticated_client: AsyncClient, authenticated_user: UserModel):
    &quot;&quot;&quot;ÁâπÂÆö„ÅÆToDo„ÇíÂèñÂæó„Åô„ÇãAPI„ÅåÊ≠£Â∏∏„Å´Âãï‰Ωú„Åô„Çã„Ç±„Éº„Çπ&quot;&quot;&quot;
    # 1. „ÉÜ„Çπ„ÉàÁî®ToDo„Çí‰ΩúÊàê
    create_response = await authenticated_client.post(
        TODO_API_BASE_URL + &quot;/&quot;, 
        json={&quot;title&quot;: &quot;Todo for Get Test&quot;, &quot;description&quot;: &quot;This todo will be retrieved by ID&quot;}
    )
    assert create_response.status_code == status.HTTP_201_CREATED
    todo_id = create_response.json()[&quot;id&quot;]

    # 2. ‰ΩúÊàê„Åó„ÅüToDo„ÇíID„ÅßÂèñÂæó
    get_response = await authenticated_client.get(f&quot;{TODO_API_BASE_URL}/{todo_id}&quot;)
    assert get_response.status_code == status.HTTP_200_OK
    todo = get_response.json()
    assert todo[&quot;id&quot;] == todo_id
    assert todo[&quot;title&quot;] == &quot;Todo for Get Test&quot;
    assert todo[&quot;owner_id&quot;] == authenticated_user.id

@pytest.mark.asyncio
async def test_update_my_todo_api_success(authenticated_client: AsyncClient):
    &quot;&quot;&quot;Ëá™ÂàÜ„ÅÆToDo„ÇíÊõ¥Êñ∞„Åô„ÇãAPI„ÅåÊ≠£Â∏∏„Å´Âãï‰Ωú„Åô„Çã„Ç±„Éº„Çπ&quot;&quot;&quot;
    # 1. Êõ¥Êñ∞ÂØæË±°„ÅÆToDo„Çí‰ΩúÊàê
    create_response = await authenticated_client.post(TODO_API_BASE_URL + &quot;/&quot;, json={&quot;title&quot;: &quot;Todo Before Update&quot;})
    assert create_response.status_code == status.HTTP_201_CREATED
    todo_id_to_update = create_response.json()[&quot;id&quot;]

    # 2. ToDo„ÇíÊõ¥Êñ∞
    update_payload = {&quot;title&quot;: &quot;Todo After Update&quot;, &quot;completed&quot;: True}
    update_response = await authenticated_client.put(f&quot;{TODO_API_BASE_URL}/{todo_id_to_update}&quot;, json=update_payload)
    assert update_response.status_code == status.HTTP_200_OK
    updated_data = update_response.json()
    assert updated_data[&quot;title&quot;] == update_payload[&quot;title&quot;]
    assert updated_data[&quot;completed&quot;] == update_payload[&quot;completed&quot;]

@pytest.mark.asyncio
async def test_delete_my_todo_api_success(authenticated_client: AsyncClient):
    &quot;&quot;&quot;Ëá™ÂàÜ„ÅÆToDo„ÇíÂâäÈô§„Åô„ÇãAPI„ÅåÊ≠£Â∏∏„Å´Âãï‰Ωú„Åô„Çã„Ç±„Éº„Çπ&quot;&quot;&quot;
    # 1. ÂâäÈô§ÂØæË±°„ÅÆToDo„Çí‰ΩúÊàê
    create_response = await authenticated_client.post(TODO_API_BASE_URL + &quot;/&quot;, json={&quot;title&quot;: &quot;Todo To Be Deleted&quot;})
    assert create_response.status_code == status.HTTP_201_CREATED
    todo_id_to_delete = create_response.json()[&quot;id&quot;]

    # 2. ToDo„ÇíÂâäÈô§
    delete_response = await authenticated_client.delete(f&quot;{TODO_API_BASE_URL}/{todo_id_to_delete}&quot;)
    assert delete_response.status_code == status.HTTP_204_NO_CONTENT # ÊàêÂäüÊôÇ„ÅØNo Content

    # 3. ÂâäÈô§„Åï„Çå„Åü„Åì„Å®„ÇíÁ¢∫Ë™ç (GET„Åß404„Å´„Å™„Çã„ÅØ„Åö)
    get_response_after_delete = await authenticated_client.get(f&quot;{TODO_API_BASE_URL}/{todo_id_to_delete}&quot;)
    assert get_response_after_delete.status_code == status.HTTP_404_NOT_FOUND
</code></pre>
<hr />
<h2 id="15">15. „É≠„Éº„É´„Å®Ê®©Èôê</h2>
<p>RBAC („É≠„Éº„É´„Éô„Éº„Çπ„Ç¢„ÇØ„Çª„ÇπÂà∂Âæ°) „ÅÆ„Åü„ÇÅ„ÅÆ„É¢„Éá„É´„Å®‰ªïÁµÑ„Åø„ÄÇ</p>
<h3 id="151">15.1 „É≠„Éº„É´„ÉªÊ®©Èôê„É¢„Éá„É´</h3>
<p><code>libkoiki/models/</code> „Å´ <code>RoleModel</code>, <code>PermissionModel</code>, „Åä„Çà„Å≥„Åù„Çå„Çâ„ÇíUser„Å®Á¥ê‰ªò„Åë„Çã‰∏≠Èñì„ÉÜ„Éº„Éñ„É´ (<code>user_roles_association</code>, <code>role_permissions_association</code> in <code>libkoiki/models/associations.py</code>) „ÇíÂÆöÁæ©„Åó„Åæ„Åô„ÄÇ</p>
<p><strong><code>libkoiki/models/role.py</code>:</strong></p>
<pre><code class="language-python"># libkoiki/models/role.py
from sqlalchemy import Column, String, Integer
from sqlalchemy.orm import relationship
from libkoiki.db.base import Base
from libkoiki.models.associations import user_roles_association, role_permissions_association # ‰∏≠Èñì„ÉÜ„Éº„Éñ„É´„Çí„Ç§„É≥„Éù„Éº„Éà

class RoleModel(Base):
    # __tablename__ = &quot;roles&quot; # CustomBase„ÅßËá™ÂãïË®≠ÂÆö

    name = Column(String, unique=True, index=True, nullable=False)
    description = Column(String, nullable=True)

    users = relationship(
        &quot;UserModel&quot;, 
        secondary=user_roles_association, 
        back_populates=&quot;roles&quot;
    )
    permissions = relationship(
        &quot;PermissionModel&quot;, 
        secondary=role_permissions_association, 
        back_populates=&quot;roles&quot;
    )
</code></pre>
<p><strong><code>libkoiki/models/permission.py</code>:</strong></p>
<pre><code class="language-python"># libkoiki/models/permission.py
from sqlalchemy import Column, String, Integer
from sqlalchemy.orm import relationship
from libkoiki.db.base import Base
from libkoiki.models.associations import role_permissions_association # ‰∏≠Èñì„ÉÜ„Éº„Éñ„É´„Çí„Ç§„É≥„Éù„Éº„Éà

class PermissionModel(Base):
    # __tablename__ = &quot;permissions&quot; # CustomBase„ÅßËá™ÂãïË®≠ÂÆö

    name = Column(String, unique=True, index=True, nullable=False) # ‰æã: &quot;todos:create&quot;, &quot;users:read&quot;
    description = Column(String, nullable=True)

    roles = relationship(
        &quot;RoleModel&quot;, 
        secondary=role_permissions_association, 
        back_populates=&quot;permissions&quot;
    )
</code></pre>
<p><strong><code>libkoiki/models/associations.py</code> (‰∏≠Èñì„ÉÜ„Éº„Éñ„É´):</strong></p>
<pre><code class="language-python"># libkoiki/models/associations.py
from sqlalchemy import Table, Column, Integer, ForeignKey
from libkoiki.db.base import Base # Base.metadata „Çí‰ΩøÁî®„Åô„Çã„Åü„ÇÅ

# „É¶„Éº„Ç∂„Éº„Å®„É≠„Éº„É´„ÅÆÂ§öÂØæÂ§öÈñ¢ÈÄ£„ÉÜ„Éº„Éñ„É´
user_roles_association = Table(
    &quot;user_roles_association&quot;, # „ÉÜ„Éº„Éñ„É´Âêç„ÇíÊòéÁ§∫ÁöÑ„Å´ÊåáÂÆö
    Base.metadata, # „Åì„ÅÆBase„ÅØ„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÂÖ®‰Ωì„ÅßÂÖ±Êúâ„Åï„Çå„Çã„Ç§„É≥„Çπ„Çø„É≥„Çπ„Åß„ÅÇ„Çã„Åì„Å®
    Column(&quot;user_id&quot;, Integer, ForeignKey(&quot;usermodel.id&quot;, ondelete=&quot;CASCADE&quot;), primary_key=True), # „ÉÜ„Éº„Éñ„É´Âêç„ÅØÂ∞èÊñáÂ≠ó
    Column(&quot;role_id&quot;, Integer, ForeignKey(&quot;rolemodel.id&quot;, ondelete=&quot;CASCADE&quot;), primary_key=True)  # „ÉÜ„Éº„Éñ„É´Âêç„ÅØÂ∞èÊñáÂ≠ó
)

# „É≠„Éº„É´„Å®Ê®©Èôê„ÅÆÂ§öÂØæÂ§öÈñ¢ÈÄ£„ÉÜ„Éº„Éñ„É´
role_permissions_association = Table(
    &quot;role_permissions_association&quot;,
    Base.metadata,
    Column(&quot;role_id&quot;, Integer, ForeignKey(&quot;rolemodel.id&quot;, ondelete=&quot;CASCADE&quot;), primary_key=True),
    Column(&quot;permission_id&quot;, Integer, ForeignKey(&quot;permissionmodel.id&quot;, ondelete=&quot;CASCADE&quot;), primary_key=True)
)
</code></pre>
<p><code>libkoiki/models/user.py</code> „ÅÆ <code>UserModel</code> „Å´„ÇÇ <code>roles</code> „É™„É¨„Éº„Ç∑„Éß„É≥„ÇíËøΩÂä†„Åó„Åæ„Åô„ÄÇ</p>
<pre><code class="language-python"># libkoiki/models/user.py (ËøΩË®ò)
from libkoiki.models.associations import user_roles_association # ‰∏≠Èñì„ÉÜ„Éº„Éñ„É´„Çí„Ç§„É≥„Éù„Éº„Éà
# ... UserModel„ÇØ„É©„ÇπÂÜÖ ...
roles = relationship(
    &quot;RoleModel&quot;,
    secondary=user_roles_association,
    back_populates=&quot;users&quot;,
    lazy=&quot;selectin&quot; # Eager loading strategy (optional, for performance)
)
</code></pre>
<p><code>lazy="selectin"</code> „Å™„Å©„ÅÆEager LoadingÊà¶Áï•„ÅØ„ÄÅÁâπ„Å´Ë™çË®ºÊôÇ„Å´„É¶„Éº„Ç∂„Éº„ÅÆ„É≠„Éº„É´„ÇÑÊ®©Èôê„ÇíÈ†ªÁπÅ„Å´ÂèÇÁÖß„Åô„ÇãÂ†¥Âêà„Å´„Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÊîπÂñÑ„Å´Áπã„Åå„Çã„Åì„Å®„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ</p>
<h3 id="152">15.2 Ê®©Èôê„ÉÅ„Çß„ÉÉ„ÇØ„ÅÆÂÆüË£Ö</h3>
<p><code>libkoiki/core/security.py</code> („Åæ„Åü„ÅØ <code>libkoiki/auth/rbac.py</code>) „ÅßÊ®©Èôê„ÉÅ„Çß„ÉÉ„ÇØÁî®„ÅÆ‰æùÂ≠òÊÄß„Éò„É´„Éë„Éº„ÇíÂÆöÁæ©„Åó„Åæ„Åô„ÄÇ</p>
<pre><code class="language-python"># libkoiki/core/security.py („Åæ„Åü„ÅØ libkoiki/auth/rbac.py „Å´ÂàÜÈõ¢Êé®Â•®)
# ... Êó¢Â≠ò„ÅÆ„Ç§„É≥„Éù„Éº„Éà„Å´Âä†„Åà„Å¶ ...
from fastapi import Security
import structlog

logger = structlog.get_logger(__name__)

# Ê®©Èôê„ÉÅ„Çß„ÉÉ„ÇØ„ÅÆ„Åü„ÇÅ„ÅÆ‰æùÂ≠òÊÄßÈñ¢Êï∞
def require_permission(required_permission: str):
    &quot;&quot;&quot;
    ÊåáÂÆö„Åï„Çå„ÅüÊ®©Èôê„Çí„É¶„Éº„Ç∂„Éº„ÅåÊåÅ„Å£„Å¶„ÅÑ„Çã„ÅãÁ¢∫Ë™ç„Åô„Çã‰æùÂ≠òÊÄß„ÄÇ
    ÊåÅ„Å£„Å¶„ÅÑ„Å™„ÅÑÂ†¥Âêà„ÅØHTTP 403 Forbidden„ÇíËøî„Åô„ÄÇ

    Args:
        required_permission: ÂøÖË¶Å„Å™Ê®©ÈôêÂêç (‰æã: &quot;todos:create&quot;)

    Returns:
        Depends „Ç™„Éñ„Ç∏„Çß„ÇØ„Éà
    &quot;&quot;&quot;
    async def permission_checker(
        current_user: Annotated[UserModel, Security(get_current_active_user)] # Security„ÅßActiveUserDep„Çí‰ΩøÁî®
    ) -&gt; UserModel:
        if not hasattr(current_user, 'roles') or not current_user.roles:
            logger.warning(
                &quot;Permission check failed: user has no roles&quot;, 
                user_id=current_user.id, 
                required_permission=required_permission
            )
            raise HTTPException(
                status_code=status.HTTP_403_FORBIDDEN, 
                detail=&quot;User has no roles assigned or roles not loaded.&quot;
            )

        user_permissions = set()
        for role in current_user.roles:
            if hasattr(role, 'permissions') and role.permissions:
                for perm_obj in role.permissions: # perm_obj „ÅØ PermissionModel „Ç§„É≥„Çπ„Çø„É≥„Çπ
                    user_permissions.add(perm_obj.name) # PermissionModel„ÅÆnameÂ±ûÊÄß (Ê®©ÈôêÂêç) „Çí„Çª„ÉÉ„Éà„Å´ËøΩÂä†

        if required_permission not in user_permissions:
            logger.warning(
                &quot;Permission check failed: insufficient permissions&quot;, 
                user_id=current_user.id,
                user_permissions=list(user_permissions),
                required_permission=required_permission
            )
            raise HTTPException(
                status_code=status.HTTP_403_FORBIDDEN,
                detail=f&quot;Insufficient permissions. Required: '{required_permission}'&quot;
            )

        logger.debug(
            &quot;Permission check passed&quot;, 
            user_id=current_user.id, 
            required_permission=required_permission
        )
        return current_user # Ê®©Èôê„Åå„ÅÇ„Çå„Å∞„É¶„Éº„Ç∂„Éº„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÇíËøî„Åô (‰ªñ„ÅÆÂá¶ÁêÜ„Åß‰Ωø„Åà„Çã„Çà„ÅÜ„Å´)

    return Depends(permission_checker) # Depends„Åß„É©„ÉÉ„Éó„Åó„Å¶Ëøî„Åô

# ‰ΩøÁî®‰æã („É´„Éº„Çø„Éº„ÅÆ„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà„Åß):
# @router.post(&quot;/&quot;, dependencies=[Depends(require_permission(&quot;todos:create&quot;))])
# async def create_item(...):
#     ...
</code></pre>
<p><strong>ÈáçË¶Å:</strong>
<code>get_current_user_from_token</code> Èñ¢Êï∞ÂÜÖ„Åß„ÄÅ„É¶„Éº„Ç∂„ÉºÂèñÂæóÊôÇ„Å´ <code>selectinload</code> „Çí‰Ωø„Å£„Å¶ <code>roles</code> „Åä„Çà„Å≥ <code>roles.permissions</code> „É™„É¨„Éº„Ç∑„Éß„É≥„ÇíEager Loading„Åô„Çã„Åì„Å®„ÇíÂøò„Çå„Å™„ÅÑ„Åß„Åè„Å†„Åï„ÅÑ„ÄÇ„Åì„Çå„ÅØ„ÄÅ<code>UserRepository</code> „ÅÆ <code>get_user_with_roles_permissions</code> „É°„ÇΩ„ÉÉ„Éâ„Çí‰ΩøÁî®„Åó„Å¶ÂÆüÁèæ„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>
<hr />
<h2 id="16-uiux">16. UI/UXÂÆüË£Ö„ÅÆÈÅ∏ÊäûËÇ¢</h2>
<p>„Åì„ÅÆ„Éê„ÉÉ„ÇØ„Ç®„É≥„Éâ„Éï„É¨„Éº„É†„ÉØ„Éº„ÇØ„ÅØ„ÄÅÊßò„ÄÖ„Å™„Éï„É≠„É≥„Éà„Ç®„É≥„ÉâÂÆüË£Ö„Å®ÁµÑ„ÅøÂêà„Çè„Åõ„Çã„Åì„Å®„ÅåÂèØËÉΩ„Åß„Åô„ÄÇ</p>
<h3 id="uiux">üî∞ Áî®Ë™ûËß£Ë™¨ (UI/UX)</h3>
<ul>
<li><strong>UI (User Interface)</strong>: „É¶„Éº„Ç∂„Éº„Åå„Ç∑„Çπ„ÉÜ„É†„Å®„ÇÑ„ÇäÂèñ„Çä„Åô„ÇãÊé•ÁÇπÔºàÁîªÈù¢„Éá„Ç∂„Ç§„É≥„ÄÅ„Éú„Çø„É≥„Å™„Å©Ôºâ„ÄÇ</li>
<li><strong>UX (User Experience)</strong>: „É¶„Éº„Ç∂„Éº„Åå„Ç∑„Çπ„ÉÜ„É†„ÇíÂà©Áî®„Åô„ÇãÈöõ„ÅÆÂÖ®‰ΩìÁöÑ„Å™‰ΩìÈ®ìÔºà‰Ωø„ÅÑ„ÇÑ„Åô„Åï„ÄÅÊ∫ÄË∂≥Â∫¶„Å™„Å©Ôºâ„ÄÇ</li>
<li><strong>SPA (Single Page Application)</strong>: Âçò‰∏Ä„ÅÆHTML„Éö„Éº„Ç∏„ÅßÂãï‰Ωú„Åó„ÄÅJavaScript„ÅßÂãïÁöÑ„Å´„Ç≥„É≥„ÉÜ„É≥„ÉÑ„ÇíÊõ∏„ÅçÊèõ„Åà„ÇãWeb„Ç¢„Éó„É™„ÄÇReact, Vue, Angular„Å™„Å©„ÄÇ</li>
<li><strong>SSR (Server-Side Rendering)</strong>: „Çµ„Éº„Éê„ÉºÂÅ¥„ÅßHTML„ÇíÁîüÊàê„Åó„Å¶„ÇØ„É©„Ç§„Ç¢„É≥„Éà„Å´Ëøî„ÅôÊñπÂºè„ÄÇJinja2„Å™„Å©„ÄÇ</li>
<li><strong>SSG (Static Site Generation)</strong>: „Éì„É´„ÉâÊôÇ„Å´ÈùôÁöÑ„Å™HTML„Éï„Ç°„Ç§„É´„ÇíÁîüÊàê„Åô„ÇãÊñπÂºè„ÄÇNext.js, Gatsby„Å™„Å©„ÄÇ</li>
<li><strong>Hybrid</strong>: SPA„Å®SSR/SSG„ÇíÁµÑ„ÅøÂêà„Çè„Åõ„Åü„Ç¢„Éó„É≠„Éº„ÉÅ„ÄÇNext.js„Å™„Å©„ÄÇ</li>
</ul>
<h3 id="161-spa-react-nextjs-vuejs">16.1 SPA (React, Next.js, Vue.js „Å™„Å©)</h3>
<ul>
<li><strong>ÁâπÂæ¥</strong>: „É¢„ÉÄ„É≥„Å™ UI/UX„ÄÅÈ´ò„ÅÑ„Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„ÉñÊÄß„ÄÅ„Éê„ÉÉ„ÇØ„Ç®„É≥„Éâ„Å®„ÅÆÂÆåÂÖ®ÂàÜÈõ¢„ÄÇÁä∂ÊÖãÁÆ°ÁêÜ„ÅåË§áÈõë„Å´„Å™„Çã„Åì„Å®„Åå„ÅÇ„Çã„ÄÇ</li>
<li><strong>ÈÄ£Êê∫</strong>: „Éê„ÉÉ„ÇØ„Ç®„É≥„Éâ„ÅÆ REST API („Åì„ÅÆ„Éï„É¨„Éº„É†„ÉØ„Éº„ÇØ„ÅåÊèê‰æõ) „Å® HTTP ÈÄö‰ø°„ÄÇ</li>
<li><strong>ÊßãÊàê</strong>: „Éï„É≠„É≥„Éà„Ç®„É≥„Éâ„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Çí„Éê„ÉÉ„ÇØ„Ç®„É≥„Éâ„Å®„ÅØÂà•„ÅÆ„É™„Éù„Ç∏„Éà„É™/„Éá„Ç£„É¨„ÇØ„Éà„É™„ÅßÁÆ°ÁêÜ„Åô„Çã„Åì„Å®„Åå‰∏ÄËà¨ÁöÑ„ÄÇDocker Compose „ÅßÁµ±Âêà„Åó„Å¶ÈñãÁô∫„Éª„Éá„Éó„É≠„Ç§„Åß„Åç„Çã„ÄÇ</li>
<li><strong>Ë™çË®º</strong>: API „Åã„ÇâÂèñÂæó„Åó„Åü JWT „Çí„Éï„É≠„É≥„Éà„Ç®„É≥„Éâ„ÅßÂÆâÂÖ®„Å´ÁÆ°ÁêÜ (‰æã: HttpOnly Cookie (SameSiteÂ±ûÊÄß„Å´Ê≥®ÊÑè), localStorage + CSRFÂØæÁ≠ñ, „Çª„Ç≠„É•„Ç¢„Å™Áä∂ÊÖãÁÆ°ÁêÜ„É©„Ç§„Éñ„É©„É™)„ÄÇ</li>
<li><strong>ÈÅ©„Åó„ÅüÁî®ÈÄî</strong>: ÂãïÁöÑ„Åß„É™„ÉÉ„ÉÅ„Å™„É¶„Éº„Ç∂„Éº„Ç§„É≥„Çø„Éº„Éï„Çß„Éº„Çπ„ÄÅ„É¢„Éê„Ç§„É´„Ç¢„Éó„É™„Å®„ÅÆ API ÂÖ±ÈÄöÂåñ„ÄÅË§áÈõë„Å™Áä∂ÊÖãÁÆ°ÁêÜ„ÅåÂøÖË¶Å„Å™„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÄÇ</li>
</ul>
<h3 id="162-jinja2">16.2 „Çµ„Éº„Éê„Éº„Çµ„Ç§„Éâ„ÉÜ„É≥„Éó„É¨„Éº„Éà„Ç®„É≥„Ç∏„É≥ (Jinja2„Å™„Å©)</h3>
<ul>
<li><strong>ÁâπÂæ¥</strong>: „Ç∑„É≥„Éó„É´„Å™ÊßãÊàê„ÄÅ„Éê„ÉÉ„ÇØ„Ç®„É≥„Éâ„Å®„ÅÆÈÄ£Êê∫„ÅåÂÆπÊòìÔºàÁâπ„Å´Python„Ç®„Ç≥„Ç∑„Çπ„ÉÜ„É†ÂÜÖÔºâ„ÄÅÂàùÊúüË°®Á§∫ÈÄüÂ∫¶„ÅåÈÄü„ÅÑÂÇæÂêë„ÄÅSEO „Å´ÊúâÂà©„Å™Â†¥Âêà„ÇÇ„ÄÇ„Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„ÉñÊÄß„ÅØ SPA „Çà„ÇäÂà∂Èôê„Åï„Çå„Çã„ÄÇ</li>
<li><strong>ÈÄ£Êê∫</strong>: FastAPI ÂÜÖ„Åß Jinja2 „Å™„Å©„ÅÆ„ÉÜ„É≥„Éó„É¨„Éº„Éà„Ç®„É≥„Ç∏„É≥„Çí‰ΩøÁî®„Åó„ÄÅ„Çµ„Éº„Éê„ÉºÂÅ¥„ÅßHTML „Çí„É¨„É≥„ÉÄ„É™„É≥„Ç∞„ÄÇAPI „Å®Âêå„Åò„Éó„É≠„Çª„Çπ„ÅßÂãï‰ΩúÂèØËÉΩ„ÄÇ</li>
<li><strong>ÊßãÊàê</strong>: <code>app/templates/</code> (HTML„ÉÜ„É≥„Éó„É¨„Éº„Éà), <code>app/static/</code> (CSS, JS, ÁîªÂÉè) „Éá„Ç£„É¨„ÇØ„Éà„É™„ÇíËøΩÂä†„ÄÇFastAPI „É´„Éº„Çø„Éº„Åå <code>HTMLResponse</code> „ÇíËøî„Åô„ÄÇ</li>
<li><strong>Ë™çË®º</strong>: „Çµ„Éº„Éê„Éº„Çµ„Ç§„Éâ„Çª„ÉÉ„Ç∑„Éß„É≥Ôºà‰æã: <code>starlette-sessions</code>Ôºâ„Åæ„Åü„ÅØ API „Å®ÂêåÊßò„ÅÆ JWT „Éï„É≠„ÉºÔºàCookie„Å´JWT„ÇíÊ†ºÁ¥ç„Å™„Å©Ôºâ„ÄÇ</li>
<li><strong>ÈÅ©„Åó„ÅüÁî®ÈÄî</strong>: ÁÆ°ÁêÜÁîªÈù¢„ÄÅÊØîËºÉÁöÑÈùôÁöÑ„Å™„Ç≥„É≥„ÉÜ„É≥„ÉÑ„ÅåÂ§ö„ÅÑ„Ç¶„Çß„Éñ„Çµ„Ç§„Éà„ÄÅ„Éó„É≠„Éà„Çø„Ç§„Éî„É≥„Ç∞„ÄÅSEO„ÅåÈáçË¶Å„Å™ÂÖ¨Èñã„Çµ„Ç§„Éà„ÅÆ‰∏ÄÈÉ®„ÄÇ</li>
</ul>
<h3 id="163-streamlit">16.3 Streamlit</h3>
<ul>
<li><strong>ÁâπÂæ¥</strong>: Python „ÅÆ„Åø„Åß„Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„Éñ„Å™„Éá„Éº„Çø„Ç¢„Éó„É™„ÇÑ„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„ÇíËøÖÈÄü„Å´ÊßãÁØâ„ÄÇ„Éá„Éº„Çø„Çµ„Ç§„Ç®„É≥„ÉÜ„Ç£„Çπ„Éà„ÇÑÂàÜÊûêËÄÖÂêë„Åë„ÄÇ</li>
<li><strong>ÈÄ£Êê∫</strong>: Streamlit „Ç¢„Éó„É™„Åã„Çâ„Éê„ÉÉ„ÇØ„Ç®„É≥„Éâ API „ÇíÂëº„Å≥Âá∫„Åô„Åã„ÄÅ„Éê„ÉÉ„ÇØ„Ç®„É≥„Éâ„ÅÆ„Çµ„Éº„Éì„Çπ/„É™„Éù„Ç∏„Éà„É™Â±§„ÅÆ„Ç≥„Éº„Éâ„ÇíÁõ¥Êé• („Åæ„Åü„ÅØË™øÊï¥„Åó„Å¶) Âà©Áî®„ÄÇ</li>
<li><strong>ÊßãÊàê</strong>: <code>streamlit_app/</code> „Éá„Ç£„É¨„ÇØ„Éà„É™„Å™„Å©„Åß Streamlit „Ç¢„Éó„É™„ÇíÁÆ°ÁêÜ„ÄÇ„Éê„ÉÉ„ÇØ„Ç®„É≥„Éâ„Å®„ÅØÂà•„Éó„É≠„Çª„Çπ„ÅßÂÆüË°å„Åô„Çã„Åì„Å®„ÅåÂ§ö„ÅÑ„ÄÇ</li>
<li><strong>Ë™çË®º</strong>: Streamlit „Ç¢„Éó„É™Ëá™‰Ωì„Å´Ë™çË®ºÊ©üÊßã„ÇíËøΩÂä†Ôºà<code>streamlit-authenticator</code>„Å™„Å©Ôºâ„Åô„Çã„Åã„ÄÅ„Éê„ÉÉ„ÇØ„Ç®„É≥„Éâ API „Å∏„ÅÆ„É™„ÇØ„Ç®„Çπ„ÉàÊôÇ„Å´Ë™çË®ºÊÉÖÂ†±„Çí‰ªò‰∏é„ÄÇ</li>
<li><strong>ÈÅ©„Åó„ÅüÁî®ÈÄî</strong>: „Éá„Éº„ÇøÂàÜÊûê„ÉªÂèØË¶ñÂåñ„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„ÄÅÁ§æÂÜÖ„ÉÑ„Éº„É´„ÄÅÊ©üÊ¢∞Â≠¶Áøí„É¢„Éá„É´„ÅÆ„Éá„É¢„ÄÅ„Éó„É≠„Éà„Çø„Ç§„Éî„É≥„Ç∞„ÄÇ</li>
</ul>
<h3 id="164">16.4 „Éó„É≠„Ç∏„Çß„ÇØ„ÉàÊ®™Êñ≠„ÅÆÂÆüË£Ö„ÉªÈÅãÁî®‰∏ä„ÅÆÁïôÊÑèÁÇπ</h3>
<ul>
<li><strong>API First Design</strong>: „Å©„ÅÆUI„ÇíÈÅ∏Êäû„Åô„ÇãÂ†¥Âêà„Åß„ÇÇ„ÄÅ„Åæ„Åö„ÅØAPI„ÅÆË®≠Ë®à„Å®ÂÆüË£Ö„ÇíÂõ∫„ÇÅ„Çã„Åì„Å®„ÅåÈáçË¶Å„ÄÇAPI„ÅåÂÆâÂÆö„Åó„Å¶„ÅÑ„Çå„Å∞„ÄÅUI„ÅÆÂ§âÊõ¥„ÇÑËøΩÂä†„ÅåÂÆπÊòì„Å´„Å™„Çã„ÄÇ</li>
<li><strong>Ë™çË®º„ÉªË™çÂèØ„ÅÆ‰∏ÄË≤´ÊÄß</strong>: UI„ÅåÁï∞„Å™„Å£„Å¶„ÇÇ„ÄÅ„Éê„ÉÉ„ÇØ„Ç®„É≥„ÉâAPI„ÅÆË™çË®º„ÉªË™çÂèØ„É≠„Ç∏„ÉÉ„ÇØ„ÅØÂÖ±ÈÄö„Åó„Å¶ÈÅ©Áî®„Åï„Çå„Çã„Åπ„Åç„ÄÇUIÂÅ¥„Åß„ÅÆË°®Á§∫Âà∂Âæ°„Å®„ÄÅAPIÂÅ¥„Åß„ÅÆÂº∑Âà∂ÁöÑ„Å™Ê®©Èôê„ÉÅ„Çß„ÉÉ„ÇØ„ÅÆ‰∏°Êñπ„ÇíÂÆüË£Ö„Åô„Çã„ÄÇ</li>
<li><strong>CORSË®≠ÂÆö</strong>: SPA„Å™„Å©Áï∞„Å™„Çã„Ç™„É™„Ç∏„É≥„Åã„ÇâAPI„Å´„Ç¢„ÇØ„Çª„Çπ„Åô„ÇãÂ†¥Âêà„ÅØ„ÄÅ<code>app/main.py</code> „ÅßCORSMiddleware„ÇíÈÅ©Âàá„Å´Ë®≠ÂÆö„Åô„ÇãÂøÖË¶Å„Åå„ÅÇ„Çã„ÄÇ</li>
<li><strong>Ë®≠ÂÆö„ÅÆÂÖ±ÈÄöÂåñ„Å®ÂàÜÈõ¢</strong>: „Éá„Éº„Çø„Éô„Éº„ÇπÊé•Á∂öÊÉÖÂ†±„Å™„Å©„ÄÅUIÂ±§„Å®APIÂ±§„ÅßÂÖ±ÈÄö„ÅÆË®≠ÂÆö„ÅåÂøÖË¶Å„Å™Â†¥Âêà„Åß„ÇÇ„ÄÅÊ©üÂØÜÊÉÖÂ†±„ÅØUIÂ±§„Å´Áõ¥Êé•Âüã„ÇÅËæº„Åæ„Å™„ÅÑ„ÄÇUIÂ±§„ÅØAPI„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà„ÅÆURL„Å†„Åë„ÇíÁü•„Å£„Å¶„ÅÑ„Çå„Å∞„Çà„ÅÑ„ÄÇ</li>
<li><strong>ÈñãÁô∫„Éª„Éá„Éó„É≠„Ç§</strong>: ÂêÑÂ±§Ôºà„Éê„ÉÉ„ÇØ„Ç®„É≥„ÉâAPI„ÄÅ„Éï„É≠„É≥„Éà„Ç®„É≥„ÉâSPA„ÄÅStreamlit„Ç¢„Éó„É™„Å™„Å©Ôºâ„ÇíÁã¨Á´ã„Åó„Å¶ÈñãÁô∫„Éª„ÉÜ„Çπ„Éà„Éª„Éá„Éó„É≠„Ç§„Åß„Åç„ÇãÊßãÊàê„ÇíÁõÆÊåá„ÅôÔºàDocker Compose„Å™„Å©„ÇíÊ¥ªÁî®Ôºâ„ÄÇ</li>
<li><strong>Áä∂ÊÖãÁÆ°ÁêÜ</strong>: Áâπ„Å´SPA„Åß„ÅØ„ÄÅ„ÇØ„É©„Ç§„Ç¢„É≥„ÉàÂÅ¥„ÅÆÁä∂ÊÖãÁÆ°ÁêÜÔºà„É¶„Éº„Ç∂„ÉºÊÉÖÂ†±„ÄÅUI„ÅÆÁä∂ÊÖã„Å™„Å©Ôºâ„ÅÆÊà¶Áï•„ÇíÊó©Êúü„Å´Ê±∫ÂÆö„Åô„Çã„ÄÇ</li>
<li><strong>„Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞</strong>: API„Åã„Çâ„ÅÆ„Ç®„É©„Éº„É¨„Çπ„Éù„É≥„Çπ„ÇíUIÂÅ¥„ÅßÈÅ©Âàá„Å´„Éè„É≥„Éâ„É™„É≥„Ç∞„Åó„ÄÅ„É¶„Éº„Ç∂„Éº„Éï„É¨„É≥„Éâ„É™„Éº„Å™ÂΩ¢„ÅßË°®Á§∫„Åô„Çã„ÄÇ</li>
</ul>
<hr />
<h2 id="17-ci">17. Á∂ôÁ∂öÁöÑ„Ç§„É≥„ÉÜ„Ç∞„É¨„Éº„Ç∑„Éß„É≥ (CI)</h2>
<p>KOIKI-FW„Åß„ÅØ„ÄÅGitHub Actions„ÇíÊ¥ªÁî®„Åó„ÅüÁ∂ôÁ∂öÁöÑ„Ç§„É≥„ÉÜ„Ç∞„É¨„Éº„Ç∑„Éß„É≥ÔºàCIÔºâ„Éë„Ç§„Éó„É©„Ç§„É≥„ÇíÂÆüË£Ö„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Åì„ÅÆCI„Éó„É≠„Çª„Çπ„Å´„Çà„Çä„ÄÅ„Ç≥„Éº„Éâ„ÅÆÂìÅË≥™‰øùË®º„ÇíËá™ÂãïÂåñ„Åó„ÄÅÂïèÈ°å„ÇíÊó©Êúü„Å´Áô∫Ë¶ã„Åß„Åç„Åæ„Åô„ÄÇ</p>
<h3 id="cicd">üî∞ Áî®Ë™ûËß£Ë™¨ (CI/CD)</h3>
<table>
<thead>
<tr>
<th>Áî®Ë™û</th>
<th>Ë™¨Êòé</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>CI (Continuous Integration)</strong></td>
<td>ÈñãÁô∫ËÄÖ„Åå„Ç≥„Éº„Éâ„ÇíÈ†ªÁπÅ„Å´ÂÖ±Êúâ„É™„Éù„Ç∏„Éà„É™„Å´Áµ±Âêà„Åô„ÇãÈñãÁô∫ÊâãÊ≥ï„ÄÇÂêÑÁµ±Âêà„ÅØËá™Âãï„ÉÜ„Çπ„Éà„ÇÑ„Éì„É´„Éâ„ÅßÊ§úË®º„Åï„Çå„ÄÅÂïèÈ°å„ÇíÊó©ÊúüÁô∫Ë¶ã„Åô„Çã„ÄÇ</td>
</tr>
<tr>
<td><strong>CD (Continuous Delivery/Deployment)</strong></td>
<td>CI„ÅÆÂª∂Èï∑Á∑ö‰∏ä„Å´„ÅÇ„ÇãÊ¶ÇÂøµ„Åß„ÄÅ„ÇΩ„Éï„Éà„Ç¶„Çß„Ç¢„Çí„ÅÑ„Å§„Åß„ÇÇ„É™„É™„Éº„ÇπÂèØËÉΩ„Å™Áä∂ÊÖã„Å´‰øù„Å°ÔºàDeliveryÔºâ„ÄÅËá™ÂãïÁöÑ„Å´Êú¨Áï™Áí∞Â¢É„Å´„Éá„Éó„É≠„Ç§ÔºàDeploymentÔºâ„Åô„ÇãÊâãÊ≥ï„ÄÇ</td>
</tr>
<tr>
<td><strong>GitHub Actions</strong></td>
<td>GitHub„ÅåÊèê‰æõ„Åô„ÇãCI/CD„Éó„É©„ÉÉ„Éà„Éï„Ç©„Éº„É†„ÄÇ„É™„Éù„Ç∏„Éà„É™ÂÜÖ„ÅÆ„Ç§„Éô„É≥„ÉàÔºà„Éó„ÉÉ„Ç∑„É•„ÄÅ„Éó„É´„É™„ÇØ„Ç®„Çπ„Éà„Å™„Å©Ôºâ„Çí„Éà„É™„Ç¨„Éº„Å´„ÉØ„Éº„ÇØ„Éï„É≠„Éº„ÇíÂÆüË°å„Åß„Åç„Çã„ÄÇ</td>
</tr>
<tr>
<td><strong>„ÉØ„Éº„ÇØ„Éï„É≠„Éº</strong></td>
<td>GitHub Actions„ÅßÂÆöÁæ©„Åï„Çå„ÇãËá™ÂãïÂåñ„Éó„É≠„Çª„Çπ„ÄÇYAMLÂΩ¢Âºè„ÅßË®òËø∞„Åï„Çå„ÄÅÁâπÂÆö„ÅÆ„Ç§„Éô„É≥„Éà„ÅßÂÆüË°å„Åï„Çå„Çã‰∏ÄÈÄ£„ÅÆ„Ç∏„Éß„Éñ„ÇÑ„Çπ„ÉÜ„ÉÉ„Éó„ÇíÂÆöÁæ©„ÄÇ</td>
</tr>
<tr>
<td><strong>„É©„É≥„Éä„Éº</strong></td>
<td>„ÉØ„Éº„ÇØ„Éï„É≠„Éº„ÅÆ„Ç∏„Éß„Éñ„ÇíÂÆüË°å„Åô„Çã„Çµ„Éº„Éê„ÉºÁí∞Â¢É„ÄÇGitHubÊèê‰æõ„ÅÆ„Éõ„Çπ„Éà„É©„É≥„Éä„Éº„ÇÑËá™Â∑±„Éõ„Çπ„Éà„É©„É≥„Éä„Éº„Åå„ÅÇ„Çã„ÄÇ</td>
</tr>
<tr>
<td><strong>„Ç´„Éê„É¨„ÉÉ„Ç∏</strong></td>
<td>„ÉÜ„Çπ„Éà„Åå„Ç≥„Éº„Éâ„ÅÆ„Å©„Çå„Å†„Åë„ÅÆÈÉ®ÂàÜ„ÇíÂÆüË°å„Åó„Åü„Åã„ÇíÁ§∫„ÅôÊåáÊ®ô„ÄÇÈ´ò„ÅÑ„Ç´„Éê„É¨„ÉÉ„Ç∏„ÅØÊΩúÂú®ÁöÑ„Å™„Éê„Ç∞„ÅÆÁô∫Ë¶ãÁ¢∫Áéá„ÇíÈ´ò„ÇÅ„Çã„ÄÇ</td>
</tr>
</tbody>
</table>
<h3 id="171-github-actions-ci">17.1 GitHub Actions „Å´„Çà„ÇãCI</h3>
<p>KOIKI-FW„ÅÆCI„Éë„Ç§„Éó„É©„Ç§„É≥„ÅØ„ÄÅGitHub Actions„Çí‰ΩøÁî®„Åó„Å¶ÂÆüË£Ö„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Åì„ÅÆÈÅ∏Êäû„Å´„ÅØ‰ª•‰∏ã„ÅÆÂà©ÁÇπ„Åå„ÅÇ„Çä„Åæ„ÅôÔºö</p>
<ol>
<li><strong>GitHub„Å®„ÅÆÁµ±Âêà</strong>: „Ç≥„Éº„Éâ„É™„Éù„Ç∏„Éà„É™„Å®Âêå„Åò„Éó„É©„ÉÉ„Éà„Éï„Ç©„Éº„É†‰∏ä„ÅßCI/CD„ÇíÂÆüË°å„Åß„Åç„ÄÅ„Ç∑„Éº„É†„É¨„Çπ„Å™ÈñãÁô∫‰ΩìÈ®ì„ÇíÊèê‰æõ</li>
<li><strong>Ë®≠ÂÆö„ÅÆÁ∞°Êòì„Åï</strong>: YAML„Éô„Éº„Çπ„ÅÆÁ∞°Âçò„Å™Ë®≠ÂÆö„Éï„Ç°„Ç§„É´„ÅßË§áÈõë„Å™„ÉØ„Éº„ÇØ„Éï„É≠„Éº„ÇíÂÆöÁæ©ÂèØËÉΩ</li>
<li><strong>Ë±äÂØå„Å™„Ç¢„ÇØ„Ç∑„Éß„É≥</strong>: ÂÜçÂà©Áî®ÂèØËÉΩ„Å™„Ç¢„ÇØ„Ç∑„Éß„É≥„ÅÆÂ§ßË¶èÊ®°„Å™„Ç®„Ç≥„Ç∑„Çπ„ÉÜ„É†„Å´„Ç¢„ÇØ„Çª„ÇπÂèØËÉΩ</li>
<li><strong>‰∏¶ÂàóÂÆüË°å</strong>: Ë§áÊï∞„ÅÆ„ÉÜ„Çπ„Éà„ÇÑ„Éì„É´„Éâ„Çí‰∏¶Ë°å„Åó„Å¶ÂÆüË°å„Åß„Åç„Çã„Çπ„Ç±„Éº„É©„Éì„É™„ÉÜ„Ç£</li>
</ol>
<h3 id="172-ci">17.2 CI„Éë„Ç§„Éó„É©„Ç§„É≥„ÅÆÊßãÊàê</h3>
<p>CI„Éë„Ç§„Éó„É©„Ç§„É≥„ÅØ <code>.github/workflows/ci.yml</code> „Éï„Ç°„Ç§„É´„ÅßÂÆöÁæ©„Åï„Çå„Å¶„Åä„Çä„ÄÅ‰ª•‰∏ã„ÅÆ„Çø„Ç§„Éü„É≥„Ç∞„ÅßÂÆüË°å„Åï„Çå„Åæ„ÅôÔºö</p>
<pre><code class="language-yaml">on:
  push:
    branches: [master, develop, dev/*, feature/*, bugfix/*]
  pull_request:
    branches: [master, develop]
</code></pre>
<p>„Åì„Çå„Å´„Çà„Çä„ÄÅÊ¨°„ÅÆ„Ç§„Éô„É≥„Éà„ÅßCI„ÅåÂÆüË°å„Åï„Çå„Åæ„ÅôÔºö
- <strong>„Éó„ÉÉ„Ç∑„É•„Ç§„Éô„É≥„Éà</strong>: <code>master</code>„ÄÅ<code>develop</code>„ÄÅ<code>dev/</code>„ÄÅ<code>feature/</code>„ÄÅ<code>bugfix/</code> „ÅßÂßã„Åæ„Çã„Éñ„É©„É≥„ÉÅ„Å∏„ÅÆ„Éó„ÉÉ„Ç∑„É•
- <strong>„Éó„É´„É™„ÇØ„Ç®„Çπ„Éà</strong>: <code>master</code>„Åæ„Åü„ÅØ<code>develop</code>„Éñ„É©„É≥„ÉÅ„Å∏„ÅÆ„Éó„É´„É™„ÇØ„Ç®„Çπ„Éà</p>
<h3 id="173">17.3 „ÉÜ„Çπ„ÉàËá™ÂãïÂåñ„Å®„Ç´„Éê„É¨„ÉÉ„Ç∏</h3>
<p>CI„Éë„Ç§„Éó„É©„Ç§„É≥„ÅÆ‰∏ªË¶Å„Å™Ê©üËÉΩ„ÅÆ‰∏Ä„Å§„ÅåËá™Âãï„ÉÜ„Çπ„Éà„Å®„Ç≥„Éº„Éâ„Ç´„Éê„É¨„ÉÉ„Ç∏„ÅÆË®àÊ∏¨„Åß„ÅôÔºö</p>
<pre><code class="language-yaml">- name: Run tests with coverage
  run: |
    poetry run pytest --cov=app --cov=libkoiki --cov-report=term-missing --cov-report=html tests/

- name: Upload HTML coverage report (optional)
  if: ${{ env.ACT != 'true' }}
  uses: actions/upload-artifact@v4
  with:
    name: html-coverage-report
    path: htmlcov
</code></pre>
<p>„Åì„ÅÆ„Çπ„ÉÜ„ÉÉ„Éó„Å´„Çà„ÇäÔºö</p>
<ol>
<li><strong>„ÉÜ„Çπ„Éà„ÅÆËá™ÂãïÂÆüË°å</strong>: <code>app</code>„Åä„Çà„Å≥<code>libkoiki</code>„Éá„Ç£„É¨„ÇØ„Éà„É™„ÅÆ„Ç≥„Éº„Éâ„Å´ÂØæ„Åô„Çã„ÉÜ„Çπ„Éà„ÇíÂÆüË°å</li>
<li><strong>„Ç´„Éê„É¨„ÉÉ„Ç∏„É¨„Éù„Éº„Éà„ÅÆÁîüÊàê</strong>: „ÉÜ„Çπ„Éà„ÅÆ„Ç´„Éê„É¨„ÉÉ„Ç∏ÊÉÖÂ†±„Çí„Çø„Éº„Éü„Éä„É´Âá∫Âäõ„Å®HTMLÂΩ¢Âºè„ÅßÁîüÊàê</li>
<li><strong>„É¨„Éù„Éº„Éà„ÅÆ„Ç¢„Éº„ÉÜ„Ç£„Éï„Ç°„ÇØ„Éà‰øùÂ≠ò</strong>: HTMLÂΩ¢Âºè„ÅÆ„Ç´„Éê„É¨„ÉÉ„Ç∏„É¨„Éù„Éº„Éà„Çí„ÉØ„Éº„ÇØ„Éï„É≠„ÉºÊàêÊûúÁâ©„Å®„Åó„Å¶‰øùÂ≠ò„Åó„ÄÅÂæå„Åã„ÇâÁ¢∫Ë™çÂèØËÉΩ</li>
</ol>
<p>„Ç´„Éê„É¨„ÉÉ„Ç∏„É¨„Éù„Éº„Éà„ÅØ„ÄÅ„Ç≥„Éº„Éâ„Éô„Éº„Çπ„ÅÆ„Å©„ÅÆÈÉ®ÂàÜ„Åå„ÉÜ„Çπ„Éà„Åï„Çå„Å¶„ÅÑ„Çã„Åã„ÄÅ„Åæ„Åü„ÅØ„ÉÜ„Çπ„Éà„Åï„Çå„Å¶„ÅÑ„Å™„ÅÑ„Åã„ÇíË¶ñË¶öÁöÑ„Å´Á§∫„Åó„ÄÅÈñãÁô∫„ÉÅ„Éº„É†„Åå„ÉÜ„Çπ„Éà„ÇíÊîπÂñÑ„Åô„Çã„Åü„ÇÅ„ÅÆÊåáÈáù„Å®„Å™„Çä„Åæ„Åô„ÄÇ</p>
<h3 id="174-ci">17.4 CIÁí∞Â¢É„ÅÆË®≠ÂÆö</h3>
<p>CI„ÉØ„Éº„ÇØ„Éï„É≠„Éº„Åß„ÅØ„ÄÅ„ÉÜ„Çπ„ÉàÁî®„ÅÆ‰∏ÄÊôÇÁöÑ„Å™Áí∞Â¢É„ÅåÊßãÁØâ„Åï„Çå„Åæ„ÅôÔºö</p>
<pre><code class="language-yaml">services:
  postgres:
    image: postgres:15
    ports:
      - 5432:5432
    env:
      POSTGRES_DB: test_db
      POSTGRES_USER: test_user
      POSTGRES_PASSWORD: test_pass
    options: &gt;-
      --health-cmd pg_isready
      --health-interval 10s
      --health-timeout 5s
      --health-retries 5

env:
  DATABASE_URL: postgresql+asyncpg://test_user:test_pass@localhost:5432/test_db
  ENV_FILE: .env.ci
</code></pre>
<p>„Åì„ÅÆË®≠ÂÆö„Å´„Çà„ÇäÔºö</p>
<ol>
<li><strong>PostgreSQL„Çµ„Éº„Éì„Çπ</strong>: „ÉÜ„Çπ„ÉàÁî®„ÅÆPostgreSQL„Éá„Éº„Çø„Éô„Éº„Çπ„ÇíDocker„Ç≥„É≥„ÉÜ„Éä„Å®„Åó„Å¶Ëµ∑Âãï</li>
<li><strong>„Éò„É´„Çπ„ÉÅ„Çß„ÉÉ„ÇØ</strong>: „Éá„Éº„Çø„Éô„Éº„Çπ„ÅåÁ¢∫ÂÆü„Å´Á®ºÂÉç„Åô„Çã„Åæ„ÅßÂæÖÊ©ü„Åô„Çã„Éò„É´„Çπ„ÉÅ„Çß„ÉÉ„ÇØ„ÇíË®≠ÂÆö</li>
<li><strong>Áí∞Â¢ÉÂ§âÊï∞</strong>: „ÉÜ„Çπ„ÉàÂÆüË°å„Å´ÂøÖË¶Å„Å™Áí∞Â¢ÉÂ§âÊï∞„ÇíË®≠ÂÆö</li>
<li><strong>PoetryÁí∞Â¢É</strong>: Poetry„Çí‰ΩøÁî®„Åó„Åü‰æùÂ≠òÈñ¢‰øÇÁÆ°ÁêÜ„Å®‰ªÆÊÉ≥Áí∞Â¢É„ÅÆÊßãÁØâ</li>
</ol>
<p>„Åì„ÅÆ‰∏ÄË≤´„Åó„ÅüÁí∞Â¢ÉÊßãÁØâ„Å´„Çà„Çä„ÄÅÈñãÁô∫ËÄÖ„ÅÆ„É≠„Éº„Ç´„É´Áí∞Â¢É„Å´Èñ¢‰øÇ„Å™„Åè„ÄÅ„Åô„Åπ„Å¶„ÅÆ„ÉÜ„Çπ„Éà„ÅåÂêå‰∏Ä„ÅÆÊù°‰ª∂„ÅßÂÆüË°å„Åï„Çå„Åæ„Åô„ÄÇ</p>
<h2 id="18">18. „Åæ„Å®„ÇÅ</h2>
<p>KOIKI-FW v0.5.0„ÅØ„ÄÅÂ†ÖÁâ¢„Å™„Ç®„É≥„Çø„Éº„Éó„É©„Ç§„Ç∫Web„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥ÈñãÁô∫„ÅÆ„Åü„ÇÅ„ÅÆÂåÖÊã¨ÁöÑ„Å™„Éï„É¨„Éº„É†„ÉØ„Éº„ÇØ„Å®„Åó„Å¶ÈÄ≤Âåñ„Åó„Åæ„Åó„Åü„ÄÇ„É¢„Ç∏„É•„Éº„É´ÊßãÈÄ†„ÅÆÊòéÁ¢∫„Å™ÂàÜÈõ¢„Å´„Çà„Çä„ÄÅ<code>libkoiki</code>„Çí„Ç≥„Ç¢„É©„Ç§„Éñ„É©„É™„Å®„Åó„Å¶„ÄÅ<code>app</code>„Çí„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Âõ∫Êúâ„ÅÆÂÆüË£Ö„Å®„Åó„Å¶ÂàÜ„Åë„Çã„Åì„Å®„Åß„ÄÅÈ´ò„ÅÑ‰øùÂÆàÊÄß„Å®ÂÜçÂà©Áî®ÊÄß„ÇíÂÆüÁèæ„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>
<p>v0.5.0„Åß„ÅØ„ÄÅÈáçË¶Å„Å™„Çª„Ç≠„É•„É™„ÉÜ„Ç£ËÑÜÂº±ÊÄß„ÅÆ‰øÆÊ≠£„Å®ÂåÖÊã¨ÁöÑ„Å™‰æùÂ≠òÈñ¢‰øÇ„ÅÆÊúÄÊñ∞Âåñ„Å´„Çà„Çä„ÄÅ„Ç®„É≥„Çø„Éº„Éó„É©„Ç§„Ç∫Áí∞Â¢É„Åß„ÅÆÈÅãÁî®ÂÆâÂÖ®ÊÄß„ÅåÂ§ßÂπÖ„Å´Âêë‰∏ä„Åó„Åæ„Åó„Åü„ÄÇ„Åæ„Åü„ÄÅv0.3.1„ÅßÂ∞éÂÖ•„Åï„Çå„ÅüÁ∂ôÁ∂öÁöÑ„Ç§„É≥„ÉÜ„Ç∞„É¨„Éº„Ç∑„Éß„É≥ÔºàCIÔºâ„Å´„Çà„Çä„ÄÅÈñãÁô∫„Éó„É≠„Çª„Çπ„ÅÆËá™ÂãïÂåñ„Å®ÂìÅË≥™‰øùË®º„ÅåÂº∑Âåñ„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Åì„Çå„Å´„Çà„Çä„ÄÅÈñãÁô∫ËÄÖ„ÅØ„Ç≥„Éº„Éâ„ÅÆÂìÅË≥™„Å´Ëá™‰ø°„ÇíÊåÅ„Å°„Å™„Åå„Çâ„ÄÅ„Çà„ÇäÈÄü„ÅÑ„Éö„Éº„Çπ„ÅßÊ©üËÉΩ„ÇíÊèê‰æõ„Åß„Åç„Çã„Çà„ÅÜ„Å´„Å™„Çä„Åæ„Åó„Åü„ÄÇ</p>
<p>„Åì„ÅÆ„Éï„É¨„Éº„É†„ÉØ„Éº„ÇØ„ÅØ„ÄÅ„Ç∑„É≥„Éó„É´„Å™CRUD„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Åã„ÇâË§áÈõë„Å™„Ç®„É≥„Çø„Éº„Éó„É©„Ç§„Ç∫„Ç∑„Çπ„ÉÜ„É†„Åæ„Åß„ÄÅÊßò„ÄÖ„Å™Ë¶èÊ®°„Å®Ë§áÈõë„Åï„ÅÆ„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Å´ÈÅ©Áî®„Åß„Åç„Åæ„Åô„ÄÇÁâπ„Å´„ÄÅÂÆüÂãô„ÅßÊ±Ç„ÇÅ„Çâ„Çå„Çã„Åì„Å®„ÅÆÂ§ö„ÅÑÊ©üËÉΩ - Ë™çË®º„ÉªË™çÂèØ„ÄÅÈùûÂêåÊúüÂá¶ÁêÜ„ÄÅ„Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥ÁÆ°ÁêÜ„ÄÅ„É≠„ÇÆ„É≥„Ç∞„ÄÅ„É¢„Éã„Çø„É™„É≥„Ç∞ - „ÇíÊ®ôÊ∫ñ„ÅßÊèê‰æõ„Åô„Çã„Åì„Å®„Åß„ÄÅÈñãÁô∫ËÄÖ„ÅåÊú¨Ë≥™ÁöÑ„Å™„Éì„Ç∏„Éç„Çπ„É≠„Ç∏„ÉÉ„ÇØ„Å´ÈõÜ‰∏≠„Åß„Åç„ÇãÁí∞Â¢É„ÇíÊï¥„Åà„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>
<h2 id="19-ddd">19. ‰ªäÂæå„ÅÆÊã°Âºµ„ÉªDDD„Å∏„ÅÆÂ∏ÉÁü≥</h2>
<table>
<thead>
<tr>
<th style="text-align: left;">È†òÂüü</th>
<th style="text-align: left;">ÁèæÊßãÊàê (<code>libkoiki</code>/<code>app</code>)</th>
<th style="text-align: left;">Êã°ÂºµÊñπÂêë (DDDË¶ÅÁ¥†„ÅÆÂ∞éÂÖ•)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>„Éâ„É°„Ç§„É≥„É¢„Éá„É´</strong></td>
<td style="text-align: left;"><code>models/</code> (‰∏ª„Å´ORM„É¢„Éá„É´„Å®„Åó„Å¶„Éá„Éº„ÇøÊßãÈÄ†„ÇíÂÆöÁæ©)</td>
<td style="text-align: left;"><code>app/domain/models/</code> „Å´„Éâ„É°„Ç§„É≥„Ç®„É≥„ÉÜ„Ç£„ÉÜ„Ç£„Å®ÂÄ§„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÇíÈÖçÁΩÆ„ÄÇDB„É¢„Éá„É´„Å®ÂàÜÈõ¢„ÄÇ</td>
</tr>
<tr>
<td style="text-align: left;"><strong>„É™„Éù„Ç∏„Éà„É™</strong></td>
<td style="text-align: left;"><code>repositories/</code> (ÂÖ∑Ë±°„ÇØ„É©„Çπ„ÄÅ„Éá„Éº„Çø„Ç¢„ÇØ„Çª„Çπ„É≠„Ç∏„ÉÉ„ÇØ)</td>
<td style="text-align: left;"><code>app/domain/repositories/</code> „Å´„É™„Éù„Ç∏„Éà„É™„Ç§„É≥„Çø„Éº„Éï„Çß„Éº„ÇπÔºàÊäΩË±°Ôºâ„ÇíÂÆöÁæ©„ÄÇÂÆüË£Ö„ÅØ <code>app/infrastructure/repositories/</code> „Å∏„ÄÇ</td>
</tr>
<tr>
<td style="text-align: left;"><strong>„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Çµ„Éº„Éì„Çπ</strong></td>
<td style="text-align: left;"><code>services/</code> („Éì„Ç∏„Éç„Çπ„É≠„Ç∏„ÉÉ„ÇØ„ÄÅ„É¶„Éº„Çπ„Ç±„Éº„Çπ„ÅåÊ∑∑Âú®)</td>
<td style="text-align: left;"><code>app/application/services/</code> „Åæ„Åü„ÅØ <code>app/application/use_cases/</code> „Å®„Åó„Å¶ÊòéÁ¢∫„Å´„É¶„Éº„Çπ„Ç±„Éº„ÇπÂçò‰Ωç„ÅßÊï¥ÁêÜ„ÄÇ</td>
</tr>
<tr>
<td style="text-align: left;"><strong>„Éâ„É°„Ç§„É≥„Çµ„Éº„Éì„Çπ</strong></td>
<td style="text-align: left;">(„Çµ„Éº„Éì„ÇπÂ±§„Å´ÊöóÈªôÁöÑ„Å´Âê´„Åæ„Çå„ÇãÂèØËÉΩÊÄß„ÅÇ„Çä)</td>
<td style="text-align: left;"><code>app/domain/services/</code> „Å´„ÄÅÁâπÂÆö„ÅÆ„Ç®„É≥„ÉÜ„Ç£„ÉÜ„Ç£„Å´Â±û„Åï„Å™„ÅÑ„Éâ„É°„Ç§„É≥„É≠„Ç∏„ÉÉ„ÇØ„ÇíÂàÜÈõ¢„ÄÇ</td>
</tr>
<tr>
<td style="text-align: left;"><strong>„Éâ„É°„Ç§„É≥„Ç§„Éô„É≥„Éà</strong></td>
<td style="text-align: left;"><code>tasks/</code> (Celery„Çø„Çπ„ÇØ„Åå„Ç§„Éô„É≥„Éà„Éè„É≥„Éâ„É©ÁöÑ„Å´‰Ωø„Çè„Çå„Çã„Åì„Å®„ÇÇ)</td>
<td style="text-align: left;"><code>app/domain/events/</code> „Å´„Éâ„É°„Ç§„É≥„Ç§„Éô„É≥„Éà„ÇíÂÆöÁæ©„ÄÇ„Ç§„Éô„É≥„ÉàÁô∫Ë°å„ÉªË≥ºË™≠„ÅÆ‰ªïÁµÑ„Åø„ÇíÊï¥ÂÇô„ÄÇ</td>
</tr>
<tr>
<td style="text-align: left;"><strong>APIÂ±§ („Ç≥„É≥„Éà„É≠„Éº„É©)</strong></td>
<td style="text-align: left;"><code>routers/</code> („É™„ÇØ„Ç®„Çπ„ÉàÂá¶ÁêÜ„ÄÅ„Çµ„Éº„Éì„ÇπÂëº„Å≥Âá∫„Åó)</td>
<td style="text-align: left;"><code>app/interfaces/api/</code> („Åæ„Åü„ÅØ <code>app/presentation/api/</code>) „Å´ÈÖçÁΩÆ„ÄÇ„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Â±§„Å∏„ÅÆ„Éá„Éº„ÇøÂ§âÊèõË≤¨Âãô„ÇíÊòéÁ¢∫Âåñ„ÄÇ</td>
</tr>
<tr>
<td style="text-align: left;"><strong>„Çπ„Ç≠„Éº„Éû (DTO)</strong></td>
<td style="text-align: left;"><code>schemas/</code> (Pydantic„É¢„Éá„É´„ÄÅAPI„ÅÆÂÖ•Âá∫Âäõ„Å®ÂÜÖÈÉ®Âà©Áî®„ÅåÊ∑∑Âú®)</td>
<td style="text-align: left;">APIÂ±§„Å®„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Çµ„Éº„Éì„ÇπÈñì„ÅÆ„Éá„Éº„ÇøËª¢ÈÄÅ„Å´ÁâπÂåñ„Åó„ÅüDTO„Çí <code>app/application/dtos/</code> „Å´ÂàÜÈõ¢„ÄÇ</td>
</tr>
</tbody>
</table>
<p>DDDÔºà„Éâ„É°„Ç§„É≥ÈßÜÂãïË®≠Ë®àÔºâ„ÇíÊú¨Ê†ºÁöÑ„Å´ÂøóÂêë„Åô„ÇãÂ†¥Âêà„ÄÅ<br />
- <strong>„Ç®„É≥„ÉÜ„Ç£„ÉÜ„Ç£„ÇÑÂÄ§„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆ„Éâ„É°„Ç§„É≥„É¢„Éá„É´ÂàÜÈõ¢„Å®ÂëΩÂêç„ÅÆÂé≥Ê†ºÂåñ</strong><br />
- <strong>„É¶„Éº„Çπ„Ç±„Éº„ÇπÔºà„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Çµ„Éº„Éì„ÇπÔºâ„Å®„Éâ„É°„Ç§„É≥„Çµ„Éº„Éì„Çπ„ÅÆÂàÜÈõ¢</strong><br />
- <strong>„Ç§„É≥„Éï„É©Â±§„Éª„Ç¢„Éó„É™Â±§„Éª„Éâ„É°„Ç§„É≥Â±§„ÅÆÊòéÁ¢∫„Å™ÂΩπÂâ≤ÂàÜÊãÖ</strong><br />
- <strong>„Ç§„Éô„É≥„ÉàÈßÜÂãïË®≠Ë®à„ÇÑCQRS„Éë„Çø„Éº„É≥„ÅÆÊÆµÈöéÁöÑÂ∞éÂÖ•</strong><br />
- <strong>ÊäΩË±°„É™„Éù„Ç∏„Éà„É™„Å®„Ç§„É≥„Éï„É©ÂÆüË£Ö„ÅÆÂàÜÈõ¢</strong><br />
„Å™„Å©„ÅåÁô∫Â±ïÁöÑ„Å™Êã°Âºµ„Éù„Ç§„É≥„Éà„Å®„Å™„Çä„Åæ„Åô„ÄÇ</p>
<p>ÁèæÁä∂„ÅÆKOIKI-FWÊßãÈÄ†„ÅØ„Åì„ÅÜ„Åó„ÅüÊã°Âºµ„Å´ÂÇô„Åà„Åü„ÄåË∂≥Â†¥„Äç„Å®„Åó„Å¶Ë®≠Ë®à„Åï„Çå„Å¶„Åä„Çä„ÄÅ‰ªäÂæå„ÇÇ„Ç≥„Éü„É•„Éã„ÉÜ„Ç£„ÇÑÂÆüÂãôÁèæÂ†¥„ÅÆÂ£∞„ÇíÂèçÊò†„Åó„Å™„Åå„ÇâÈÄ≤Âåñ„ÇíÁ∂ö„Åë„Åæ„Åô„ÄÇ</p>
<hr />
<h2 id="20">20. „Éê„Éº„Ç∏„Éß„É≥Â±•Ê≠¥</h2>
<table>
<thead>
<tr>
<th>„Éê„Éº„Ç∏„Éß„É≥</th>
<th>Êó•‰ªò</th>
<th>‰∏ª„Å™Â§âÊõ¥ÂÜÖÂÆπ</th>
</tr>
</thead>
<tbody>
<tr>
<td>0.5.0</td>
<td>2025-06-21</td>
<td>- ÈáçË¶Å„Çª„Ç≠„É•„É™„ÉÜ„Ç£ËÑÜÂº±ÊÄß„ÅÆ‰øÆÊ≠£ (fastapi, python-jose, starlette)<br>- ÂåÖÊã¨ÁöÑ‰æùÂ≠òÈñ¢‰øÇ„É¢„ÉÄ„Éä„Ç§„Çº„Éº„Ç∑„Éß„É≥<br>- Python 3.13 ÂØæÂøú<br>- „Ç®„É≥„Çø„Éº„Éó„É©„Ç§„Ç∫Âêë„Åë‰æùÂ≠òÊÄßÁÆ°ÁêÜÊà¶Áï•„ÅÆÂ∞éÂÖ•</td>
</tr>
<tr>
<td>0.3.1</td>
<td>2024-06-XX</td>
<td>- CI„Éë„Ç§„Éó„É©„Ç§„É≥Â∞éÂÖ•„ÉªË®≠Ë®à„Éâ„Ç≠„É•„É°„É≥„ÉàÂà∑Êñ∞<br>- Ë™çË®º„Éª‰æùÂ≠òÊÄß„ÅÆÊúÄÊñ∞ÂÆüË£ÖÂèçÊò†</td>
</tr>
<tr>
<td>0.3.0</td>
<td>2024-05-XX</td>
<td>- <code>libkoiki/</code> „Å® <code>app/</code> „ÅÆÊòéÁ¢∫„Å™ÂàÜÈõ¢<br>- „Çµ„Éº„Éì„Çπ/„É™„Éù„Ç∏„Éà„É™/„É¢„Éá„É´/„Çπ„Ç≠„Éº„ÉûÂàÜÂâ≤</td>
</tr>
<tr>
<td>0.2.x</td>
<td>2024-04-XX</td>
<td>- ÈùûÂêåÊúüÂá¶ÁêÜCelery„ÉªRBAC„ÉªÁõ£Êüª„É≠„Ç∞„ÅÆÂ∞éÂÖ•</td>
</tr>
<tr>
<td>0.1.x</td>
<td>2024-03-XX</td>
<td>- FastAPI„Éô„Éº„Çπ„ÅÆÂàùÊúü„Éê„Éº„Ç∏„Éß„É≥</td>
</tr>
</tbody>
</table>
<h2 id="_15">„Åä„Çè„Çä„Å´</h2>
<p>Êú¨„Éâ„Ç≠„É•„É°„É≥„Éà„ÅØ KOIKI-FW „ÅÆË®≠Ë®àÊÄùÊÉ≥„ÄÅ„Éá„Ç£„É¨„ÇØ„Éà„É™ÊßãÊàê„ÄÅ‰∏ªË¶ÅÊ©üËÉΩ„ÄÅCI/CD„ÇÑ„ÉÜ„Çπ„ÉàÊà¶Áï•„Åæ„Åß„ÄÅÂÆüÂãô„Å´Âç≥„Åó„ÅüÂΩ¢„ÅßÂåÖÊã¨ÁöÑ„Å´„Åæ„Å®„ÇÅ„Åæ„Åó„Åü„ÄÇ</p>
<h3 id="_16">„Éâ„Ç≠„É•„É°„É≥„Éà„Å®ÂÆüË£Ö„ÅÆÊï¥ÂêàÊÄß„ÅÆÈáçË¶ÅÊÄß</h3>
<p>KOIKI-FW v0.5.0 „Åß„ÅØ„ÄÅ<br />
- <strong>ÂÆüË£Ö„Éë„Çπ„ÅÆÊòéÁ¢∫ÂåñÔºà‰æãÔºö<code>libkoiki/core/security.py</code> „Å∏„ÅÆÁµ±‰∏ÄÔºâ</strong><br />
- <strong>‰æùÂ≠òÊÄßÊ≥®ÂÖ•„ÇÑË®≠ÂÆöÂèñÂæó„ÅÆÁµ±‰∏Ä</strong><br />
- <strong>CI/CDË®≠Ë®à„ÅÆÊòéÊñáÂåñ</strong><br />
- <strong>„Çµ„É≥„Éó„É´„Ç≥„Éº„Éâ„ÅÆÊúÄÊñ∞Áâà„Å∏„ÅÆ„Ç¢„ÉÉ„Éó„Éá„Éº„Éà</strong>  </p>
<p>„ÇíÂæπÂ∫ï„Åó„ÄÅ„ÄåË®≠Ë®àÊõ∏„Å®ÂÆüË£Ö„Å´ÈΩüÈΩ¨„Åå„Å™„ÅÑ„Åì„Å®„Äç„ÇíÈáçË¶ñ„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ<br />
Ë®≠Ë®à„Éâ„Ç≠„É•„É°„É≥„Éà„ÅåÂ∏∏„Å´ÂÆüË£Ö„Å®ÂêåÊúü„Åó„ÄÅÁèæÂ†¥„ÅÆÈñãÁô∫ËÄÖ„ÅåËø∑„Çè„ÅöÂèÇÁÖß„Åß„Åç„ÇãÁä∂ÊÖã„ÇíÁ∂≠ÊåÅ„Åô„Çã„Åì„Å®„Åß„ÄÅÈñãÁô∫ÂäπÁéá„Å®ÂìÅË≥™„ÅÆÂèåÊñπ„ÅåÂêë‰∏ä„Åó„Åæ„Åô„ÄÇ</p>
<hr />
<h3 id="ddd">DDD„Éª„Éû„É´„ÉÅ„É¨„Ç§„É§Âåñ„Å∏„ÅÆ‰ªäÂæå„ÅÆÂ±ïÊúõ</h3>
<ul>
<li>‰ªäÂæå„ÅØÊú¨Ë®≠Ë®à„ÇíÂúüÂè∞„Å´„ÄÅ„Äå„Éâ„É°„Ç§„É≥Â±§„Äç„Äå„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Â±§„Äç„Äå„Ç§„É≥„Éï„É©Â±§„Äç„Äå„Ç§„É≥„Çø„Éº„Éï„Çß„Éº„ÇπÂ±§„Äç„ÅÆ„Åï„Çâ„Å™„ÇãÂàÜÂâ≤ÔºàDDD„Éë„Çø„Éº„É≥Ôºâ„Å´Êã°Âºµ„Åó„ÇÑ„Åô„ÅÑÊßãÊàê„Å∏ÈÄ≤Âåñ„Åï„Åõ„Å¶„ÅÑ„Åè‰∫àÂÆö„Åß„Åô„ÄÇ</li>
<li>„Éâ„É°„Ç§„É≥„É¢„Éá„É´„ÇÑ„Éâ„É°„Ç§„É≥„Ç§„Éô„É≥„Éà„ÄÅDTO„Å™„Å©„ÄÅÊú¨Ê†ºÁöÑ„Å™Ê•≠ÂãôÈñãÁô∫„Å´ÂøÖË¶Å„Å™Ë¶ÅÁ¥†„ÇÇÊÆµÈöéÁöÑ„Å´Âèñ„ÇäÂÖ•„Çå„Å¶„ÅÑ„Åç„Åæ„Åô„ÄÇ</li>
</ul>
<hr />
<h3 id="_17">ÂèÇËÄÉ„É™„É≥„ÇØ</h3>
<ul>
<li><a href="https://fastapi.tiangolo.com/">FastAPIÂÖ¨Âºè„Éâ„Ç≠„É•„É°„É≥„Éà</a></li>
<li><a href="https://docs.sqlalchemy.org/">SQLAlchemyÂÖ¨Âºè„Éâ„Ç≠„É•„É°„É≥„Éà</a></li>
<li><a href="https://pydantic-docs.helpmanual.io/">PydanticÂÖ¨Âºè„Éâ„Ç≠„É•„É°„É≥„Éà</a></li>
<li><a href="https://docs.celeryproject.org/">CeleryÂÖ¨Âºè„Éâ„Ç≠„É•„É°„É≥„Éà</a></li>
<li><a href="https://www.structlog.org/">structlogÂÖ¨Âºè„Éâ„Ç≠„É•„É°„É≥„Éà</a></li>
<li><a href="https://docs.github.com/ja/actions">GitHub ActionsÂÖ¨Âºè„Éâ„Ç≠„É•„É°„É≥„Éà</a></li>
<li><a href="https://docs.pytest.org/">pytestÂÖ¨Âºè„Éâ„Ç≠„É•„É°„É≥„Éà</a></li>
</ul>
<hr />
<h2 id="appendix-faq">Appendix: „Ç≥„É≥„Éà„É™„Éì„É•„Éº„Ç∑„Éß„É≥„Å®FAQ</h2>
<h3 id="_18">„Ç≥„É≥„Éà„É™„Éì„É•„Éº„Ç∑„Éß„É≥„Ç¨„Ç§„Éâ</h3>
<ol>
<li><strong>Issue„ÅÆÂ†±Âëä</strong><br />
   „Éê„Ç∞„ÉªÊîπÂñÑÊèêÊ°à„ÉªË≥™Âïè„Å™„Å©„ÅØGitHub Issues„Å∏„ÅîÁôªÈå≤„Åè„Å†„Åï„ÅÑ„ÄÇ  </li>
<li><strong>Pull Request„ÅÆ‰ΩúÊàê</strong><br />
   Êñ∞Ê©üËÉΩËøΩÂä†„ÇÑ„Éê„Ç∞‰øÆÊ≠£„ÅØ„ÄÅÊòéÁ¢∫„Å™Ë™¨Êòé„Éª„ÉÜ„Çπ„Éà„Ç±„Éº„Çπ„ÇíÊ∑ª„Åà„Å¶„Éó„É´„É™„ÇØ„Ç®„Çπ„Éà„Çí‰ΩúÊàê„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</li>
<li><strong>„Éâ„Ç≠„É•„É°„É≥„Éà„ÅÆÊîπÂñÑ</strong><br />
   Ë®≠Ë®à„ÉªÂ∞éÂÖ•„ÉªÂÆüË£Ö‰æã„Å™„Å©„ÅÆÊîπÂñÑÊèêÊ°à„ÇÇÊ≠ìËøé„Åß„Åô„ÄÇ</li>
</ol>
<h3 id="faq">FAQ</h3>
<p><strong>Q: „Çµ„É≥„Éó„É´„ÇÑË®≠Ë®à„Éâ„Ç≠„É•„É°„É≥„Éà„ÅÆÂÜÖÂÆπ„Å®ÂÆüÈöõ„ÅÆÂÆüË£Ö„ÅßÈ£ü„ÅÑÈÅï„ÅÑ„Åå„ÅÇ„ÇãÂ†¥Âêà„ÅØÔºü</strong><br />
A: Êú¨„Éâ„Ç≠„É•„É°„É≥„Éà v0.5.0 „Åß„ÅØ„ÄÅ„Éë„Çπ„ÉªË®≠ÂÆö„Éª‰æùÂ≠òÊÄß„ÉªCI/CD„ÅÆÂÆüË£ÖÂ∑ÆÁï∞„ÇíÂæπÂ∫ïÁöÑ„Å´Á≤æÊüª„Åó„ÄÅË®òËø∞„ÅÆË™§„Çä„Çí‰øÆÊ≠£„Åó„Åæ„Åó„Åü„ÄÇ„Åæ„Åü„ÄÅÈáçË¶Å„Å™„Çª„Ç≠„É•„É™„ÉÜ„Ç£ËÑÜÂº±ÊÄß„ÅÆ‰øÆÊ≠£„Å®ÂåÖÊã¨ÁöÑ„Å™‰æùÂ≠òÈñ¢‰øÇ„ÅÆÊúÄÊñ∞Âåñ„Å´„Å§„ÅÑ„Å¶„ÇÇÂèçÊò†„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ<br />
„ÇÇ„Åó‰ªäÂæå„ÇÇÂ∑ÆÁï∞„ÇíÁô∫Ë¶ã„Åó„ÅüÂ†¥Âêà„ÅØ„ÄÅIssue„Åß„ÅîÂ†±Âëä„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
<p><strong>Q: „Çµ„É≥„Éó„É´„Ç≥„Éº„Éâ„Å®ÂÆüÈöõ„ÅÆ„É™„Éù„Ç∏„Éà„É™ÊßãÊàê„ÅåÁï∞„Å™„ÇãÂ†¥Âêà„ÅÆÂØæÂøú„ÅØÔºü</strong><br />
A: ÂøÖ„Åö„ÄåÊúÄÊñ∞Áâà„ÅÆ„É™„Éù„Ç∏„Éà„É™ÂÆüË£Ö„Äç„Å´Âêà„Çè„Åõ„Å¶Êú¨„Éâ„Ç≠„É•„É°„É≥„Éà„ÅÆ„Çµ„É≥„Éó„É´„ÇÑË™¨Êòé„ÇÇËøΩÂæì„Åô„ÇãÈÅãÁî®„Å®„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇË®≠Ë®à„Éâ„Ç≠„É•„É°„É≥„Éà„Çí‰ø°È†º„Åß„Åç„ÇãÂîØ‰∏Ä„ÅÆ‰ªïÊßòÊõ∏„Å®„Åô„Çã„Åü„ÇÅ„Åß„Åô„ÄÇ</p>
<p><strong>Q: DDDÔºà„Éâ„É°„Ç§„É≥ÈßÜÂãïË®≠Ë®àÔºâ„Å∏„ÅÆÁßªË°å„ÅØ„Å©„ÅÆ„Çà„ÅÜ„Å´ÈÄ≤„ÇÅ„Å¶„ÅÑ„ÅèÔºü</strong><br />
A: „Åæ„Åö„ÅØ„Çµ„Éº„Éì„Çπ„Éª„É™„Éù„Ç∏„Éà„É™„Éª„É¢„Éá„É´„ÅÆË≤¨ÂãôÂàÜÂâ≤„ÇíÂæπÂ∫ï„Åó„ÄÅ„É¶„Éº„Çπ„Ç±„Éº„ÇπÂçò‰Ωç„Åß„ÅÆ„Çµ„Éº„Éì„ÇπÂåñ„ÉªDTOÂ∞éÂÖ•„Éª„É™„Éù„Ç∏„Éà„É™„Ç§„É≥„Çø„Éº„Éï„Çß„Éº„ÇπÂåñ„Å™„Å©„ÄÅÊÆµÈöéÁöÑ„Å™ÁßªË°å„ÇíÂõ≥„Çä„Åæ„Åô„ÄÇ</p>
<hr />
<p><strong>Êú¨„Éâ„Ç≠„É•„É°„É≥„Éà„ÅØ„ÄÅÂÆüË£Ö„Å®Ë®≠Ë®à„ÅÆÂÆåÂÖ®„Å™ÂêåÊúü„ÇíÁõÆÊåá„Åó„ÄÅÁèæÂ†¥ÈñãÁô∫ËÄÖ„ÅÆ„ÄåËø∑„ÅÑ„Çº„É≠„Äç„ÇíÂÆüÁèæ„Åô„Çã„Åì„Å®„ÇíÁõÆÊ®ô„Å®„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ</strong></p>
<hr />












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>